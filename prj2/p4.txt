–î–∞–≤–∞–π —Ä–æ–∑–∫–ª–∞–¥–µ–º–æ –ø–æ –ø–æ–ª–∏—á–∫–∞—Ö üëá

---

## üîé –ß–æ–º—É —É —Ç–µ–±–µ –π—à–ª–æ –≤ `error:` —ñ –≤—Å–µ –æ–¥–Ω–æ –≤—ñ–¥–∫—Ä–∏–≤–∞–ª–æ—Å—è –≤—ñ–∫–Ω–æ –∑ –∫–∞—Ä—Ç–∫–æ—é

1. **JS-–∫–æ–¥ (submitCheck):**

   * –Ø–∫—â–æ PL/SQL –ø—Ä–æ—Ü–µ—Å –ø–æ–≤–µ—Ä—Ç–∞—î –∫–æ—Ä–µ–∫—Ç–Ω–∏–π JSON ‚Üí —Å–ø—Ä–∞—Ü—å–æ–≤—É—î `success: handleResp`.
   * –Ø–∫—â–æ –ø—Ä–æ—Ü–µ—Å –≤–ø–∞–≤ –∑ –ø–æ–º–∏–ª–∫–æ—é (ORA-xxxx, —Å–∏–Ω—Ç–∞–∫—Å–∏—Å, NOT NULL —ñ —Ç.–¥.) ‚Üí –≤—ñ–¥–¥–∞—î—Ç—å—Å—è HTML-error ‚Üí jQuery –Ω–µ –º–æ–∂–µ –π–æ–≥–æ —Ä–æ–∑–ø–∞—Ä—Å–∏—Ç–∏ —è–∫ JSON ‚Üí –æ–¥—Ä–∞–∑—É –π–¥–µ —É `error:`.

2. **handleResp()** —É —Ç–µ–±–µ —è–∫—Ä–∞–∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –¥—ñ–∞–ª–æ–≥—É:

   ```js
   if (res && res.ok){
       fillSuccessCard(res);
       openInfoDialog("–í—Ö—ñ–¥ –≤–∏–∫–æ–Ω–∞–Ω–æ", true);
   } else {
       // –ø–æ–∫–∞–∑–∞—Ç–∏ –ø–æ–º–∏–ª–∫—É
       toggleDialogSection(false);
   }
   ```

   –¢–æ–±—Ç–æ –¥—ñ–∞–ª–æ–≥ –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è –ª–∏—à–µ –∑ `success` –∫–æ–ª–±–µ–∫—É.

3. **–ß–æ–º—É –ø—ñ—Å–ª—è `error:` –≤—Å–µ –æ–¥–Ω–æ –ø–æ–∫–∞–∑—É–≤–∞–ª–∞—Å—å –∫–∞—Ä—Ç–∫–∞?**

   * –£ `error:` –∫–æ–ª–±–µ–∫—É —Ç–∏ –≤–∏–∫–ª–∏–∫–∞–≤ `toggleDialogSection(false);`.
   * `toggleDialogSection(false)` —É –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –≤–µ—Ä—Å—ñ—è—Ö –≤—ñ–¥–∫—Ä–∏–≤–∞–≤ **—Ç–æ–π —Å–∞–º–∏–π –¥—ñ–∞–ª–æ–≥ `userDialog`**, —Ç—ñ–ª—å–∫–∏ –∑ —á–µ—Ä–≤–æ–Ω–∏–º –±–ª–æ–∫–æ–º "error".
   * –ê —É –≤–µ—Ä—Å—Ç—Ü—ñ –≤ —Å–µ–∫—Ü—ñ—ó error (`dlg-error`) —Ç–∏ —â–µ –Ω–µ –æ–Ω–æ–≤–ª—é–≤–∞–≤/—á–∏—Å—Ç–∏–≤ –∫–∞—Ä—Ç–∫—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (`dlg-fn`, `dlg-ln`, ...). –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –ª—ñ–≤—ñ –¥–∞–Ω—ñ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ —É—Å–ø—ñ—à–Ω–æ–≥–æ –≤—Ö–æ–¥—É –∑–∞–ª–∏—à–∞–ª–∏—Å—è –≤ DOM ‚Üí –∑–¥–∞–≤–∞–ª–æ—Å—è, –Ω—ñ–±–∏ –∑–Ω–æ–≤ –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è –∫–∞—Ä—Ç–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

**üëâ –í–∏—Å–Ω–æ–≤–æ–∫:**
‚Äì –£ –≤–∏–ø–∞–¥–∫—É `error:` —Ç—Ä–µ–±–∞ —á–∏—Å—Ç–∏—Ç–∏ –≤–º—ñ—Å—Ç success-–±–ª–æ–∫—É (`dlg-fn`, `dlg-ln` —ñ —Ç.–¥.), –∞–±–æ –≤–∑–∞–≥–∞–ª—ñ –Ω–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ `toggleDialogSection`, –∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ inline (–±–µ–∑ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –¥—ñ–∞–ª–æ–≥—É).
‚Äì –Ø–∫—â–æ —Ö–æ—á–µ—à –∑–∞–ª–∏—à–∞—Ç–∏ –¥—ñ–∞–ª–æ–≥ ‚Äî –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ –≤ `error:` —á–∏—Å—Ç–∏ –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

---

## üõ† –Ø–∫ –ø–æ–∫–∞–∑–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è "–ü—Ä–æ–±–ª–µ–º–∏ –∑ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è–º" –ª–∏—à–µ –Ω–∞ 3 —Å–µ–∫—É–Ω–¥–∏

–ó–∞–º—ñ—Å—Ç—å –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –¥—ñ–∞–ª–æ–≥—É –º–æ–∂–Ω–∞ –∑–∞–ª–∏—à–∏—Ç–∏ –ª–∏—à–µ inline-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —è–∫–µ –∑–Ω–∏–∫–Ω–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:

```js
error: function(){
  var msg = "–ü—Ä–æ–±–ª–µ–º–∏ –∑ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è–º";

  // inline error –ø—ñ–¥ –ø–æ–ª–µ–º
  apex.message.showErrors([{
    type: "error",
    location: "inline",
    pageItem: "P2_NUMBER",
    message: msg,
    unsafe: false
  }]);

  // —Ç–∞–∫–æ–∂ –≤–∏–≤–µ—Å—Ç–∏ –≤ div
  var el = document.getElementById('dlg-errmsg');
  if (el){
    el.textContent = msg;
    el.style.display = 'block';
    // —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥–∏ –æ—á–∏—Å—Ç–∏—Ç–∏
    setTimeout(function(){
      el.textContent = '';
      el.style.display = 'none';
    }, 3000);
  }

  // —è–∫—â–æ –Ω–µ —Ö–æ—á–µ—à, —â–æ–± —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –≤—ñ–¥–∫—Ä–∏–≤–∞–≤—Å—è modal
  // –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–±–µ—Ä–∏ toggleDialogSection(false);
}
```

---

## ‚úÖ –©–æ –∑—Ä–æ–±–∏—Ç–∏, —â–æ–± "user not found" –ø—Ä–∞—Ü—é–≤–∞–≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

1. –£ PL/SQL –ø—Ä–æ—Ü–µ—Å—ñ (`VALIDATE_AND_RECORD_USER_REQ`) —É –≤–∏–ø–∞–¥–∫—É `NO_DATA_FOUND` –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ —Ñ–æ—Ä–º—É–π **–∫–æ—Ä–µ–∫—Ç–Ω–∏–π JSON**:

   ```plsql
   apex_json.open_object;
   apex_json.write('ok', false);
   apex_json.write('message', '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.');
   apex_json.close_object;
   RETURN;
   ```

   –¶–µ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç—å, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –ø—ñ–¥–µ —É `success:` ‚Üí `handleResp()` —ñ —Ç–∏ –∑–º–æ–∂–µ—à –≤—ñ–¥–∫—Ä–∏—Ç–∏ **error-—Å–µ–∫—Ü—ñ—é –¥—ñ–∞–ª–æ–≥—É**.

2. –£ `EXCEPTION OTHERS` ‚Äî —Ç–µ–∂ —Ñ–æ—Ä–º—É–π JSON –∑ `ok=false`. –¢–æ–¥—ñ –Ω–∞–≤—ñ—Ç—å –ø—Ä–∏ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –ø–æ–º–∏–ª—Ü—ñ —Ç–∏ –Ω–µ –ø–æ–ø–∞–¥–µ—à —É JS `error:`, –∞ –∑–∞–≤–∂–¥–∏ –≤ `success:` –∑ `ok=false`.

3. –Ø–∫—â–æ –≤—Å–µ –∂ —Ç–∞–∫–∏ –ø—Ä–æ—Ü–µ—Å —Ä–µ–∞–ª—å–Ω–æ –ø–∞–¥–∞—î (ORA-xxxx), —Ç–æ–¥—ñ —É `error:` –ø–æ–∫–∞–∑—É–π —Ç—ñ–ª—å–∫–∏ –∫–æ—Ä–æ—Ç–∫–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (3 —Å–µ–∫—É–Ω–¥–∏), –±–µ–∑ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –¥—ñ–∞–ª–æ–≥—É.

---

### üîß –ü—ñ–¥—Å—É–º–æ–∫

* **–ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∏:** —É `error:` –≤–∏–∫–ª–∏–∫–∞–≤—Å—è `toggleDialogSection(false)`, —è–∫–∏–π –≤—ñ–¥–∫—Ä–∏–≤–∞–≤ –¥—ñ–∞–ª–æ–≥ —ñ –Ω–µ –æ—á–∏—â–∞–≤ –∫–∞—Ä—Ç–∫—É ‚Üí –≤ –Ω—ñ–π –∑–∞–ª–∏—à–∞–ª–∏—Å—è —Å—Ç–∞—Ä—ñ –¥–∞–Ω—ñ.
* **–í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:** —É `error:` –∞–±–æ –Ω–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ –¥—ñ–∞–ª–æ–≥, –∞–±–æ —á–∏—Å—Ç–∏—Ç–∏ success-–ø–æ–ª—è –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º.
* **"–ü—Ä–æ–±–ª–µ–º–∏ –∑ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è–º"** ‚Üí –ø–æ–∫–∞–∑–∞—Ç–∏ inline + —É div –Ω–∞ 3 —Å–µ–∫—É–Ω–¥–∏ —á–µ—Ä–µ–∑ `setTimeout`.

---

–•–æ—á–µ—à, —è –ø—ñ–¥–∫–∏–Ω—É –ø—Ä–∏–∫–ª–∞–¥ —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ `handleResp`, –¥–µ –≤—Ä–∞—Ö–æ–≤–∞–Ω—ñ **ok=true / ok=false / error** –∑ —á—ñ—Ç–∫–∏–º —Ä–æ–∑–º–µ–∂—É–≤–∞–Ω–Ω—è–º:
‚Äì success+ok=true ‚Üí –ø–æ–∫–∞–∑–∞—Ç–∏ –∫–∞—Ä—Ç–∫—É;
‚Äì success+ok=false ‚Üí –ø–æ–∫–∞–∑–∞—Ç–∏ –¥—ñ–∞–ª–æ–≥ –∑ —á–µ—Ä–≤–æ–Ω–∏–º –±–ª–æ–∫–æ–º;
‚Äì error (–º–µ—Ä–µ–∂–∞/ORA) ‚Üí –ø–æ–∫–∞–∑–∞—Ç–∏ –ª–∏—à–µ inline –Ω–∞ 3—Å, –±–µ–∑ –¥—ñ–∞–ª–æ–≥—É?
