–°—É–ø–µ—Ä, —Ç–æ–¥—ñ –ª–æ–≥—ñ–∫–∞ –±—É–¥–µ —Ç–∞–∫–∞:

* –£ `PP_LIST` –∫–ª—é—á–æ–≤–µ –ø–æ–ª–µ ‚Üí `pp_id` (–∑–∞–ª–∏—à–∞—î—à —è–∫ —î –∑ DEVICES).
* –£ `PP_POINTS` –∫–ª—é—á–æ–≤–µ –ø–æ–ª–µ ‚Üí `point_id` (—Ç–∞–∫–æ–∂ –±–µ—Ä–µ—à —ñ–∑ DEVICES).
* `id` –≤ –æ–±–æ—Ö –Ω–æ–≤–∏—Ö —Ç–∞–±–ª–∏—Ü—è—Ö ‚Äî —Ü–µ —Ç–µ—Ö–Ω—ñ—á–Ω–µ PK, –π–æ–≥–æ –º–æ–∂–Ω–∞ –ø—Ä–æ—Å—Ç–∞–≤–ª—è—Ç–∏ —á–µ—Ä–µ–∑ `sequence`.

---

### –ü—Ä–∏–∫–ª–∞–¥

```sql
-- –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ PP –≤ PP_LIST
INSERT INTO pp_list (id, pp_id, name, short_name, pp_type)
SELECT pp_list_seq.NEXTVAL,   -- –Ω–æ–≤–∏–π PK
       d.pp_id,               -- —ñ—Å–Ω—É—é—á–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä
       d.name,                -- —É–∑–∞–≥–∞–ª—å–Ω–µ–Ω–∞ –Ω–∞–∑–≤–∞
       d.device_name,         -- —Å–∫–æ—Ä–æ—á–µ–Ω–∞ –Ω–∞–∑–≤–∞
       d.pp_type
FROM (
    SELECT DISTINCT pp_id, name, device_name, pp_type
    FROM devices
) d;


-- –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –≤—Å—ñ —Ç–æ—á–∫–∏ —É PP_POINTS
INSERT INTO pp_points (id, point_id, pp_id, point_name, inout)
SELECT pp_points_seq.NEXTVAL, -- –Ω–æ–≤–∏–π PK
       d.point_id,            -- —ñ—Å–Ω—É—é—á–∏–π point_id
       d.pp_id,               -- –∑–≤‚Äô—è–∑–æ–∫ –Ω–∞ PP_LIST
       d.device_name,         -- –Ω–∞–∑–≤–∞ —Ç–æ—á–∫–∏
       d.inout
FROM devices d;
```

---

üîé –í–∞–∂–ª–∏–≤—ñ –º–æ–º–µ–Ω—Ç–∏:

1. `DISTINCT` —É `PP_LIST` –ø–æ—Ç—Ä—ñ–±–µ–Ω, —â–æ–± –æ–¥–Ω–∞–∫–æ–≤—ñ `pp_id` –Ω–µ —Å—Ç–≤–æ—Ä–∏–ª–∏ –¥—É–±–ª—å.
2. –Ø–∫—â–æ –≤ –º–∞–π–±—É—Ç–Ω—å–æ–º—É –≤ `DEVICES` –º–æ–∂—É—Ç—å –±—É—Ç–∏ —Ä—ñ–∑–Ω—ñ `device_name` –¥–ª—è –æ–¥–Ω–æ–≥–æ `pp_id` ‚Äî —Ç–æ–¥—ñ —Ç—Ä–µ–±–∞ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –ø—Ä–∞–≤–∏–ª–æ (—è–∫–∏–π —Å–∞–º–µ `device_name` –ø—ñ–¥–µ –≤ `short_name`).
3. `id` —É –Ω–æ–≤–∏—Ö —Ç–∞–±–ª–∏—Ü—è—Ö —ñ–¥–µ –≤—ñ–¥ `sequence`, –∞ –∑–≤‚Äô—è–∑–∫–∏ –ø—Ä–∞—Ü—é—é—Ç—å —á–µ—Ä–µ–∑ **pp\_id** —ñ **point\_id**.

---

–•–æ—á–µ—à, —è –∑—Ä–æ–±–ª—é –ø—Ä–∏–∫–ª–∞–¥ —ñ–∑ **—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è–º sequence —Ç–∞ PK** –¥–ª—è –æ–±–æ—Ö —Ç–∞–±–ª–∏—Ü—å, —â–æ–± –±—É–ª–æ –ø—ñ–¥ –∫–ª—é—á?
