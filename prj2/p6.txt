–î–æ–±—Ä–µ üëç –¥–∞–≤–∞–π –∑—Ä–æ–±–∏–º–æ –ø–æ –∫—Ä–æ–∫–∞—Ö.

–£ —Ç–µ–±–µ –∑–∞—Ä–∞–∑ **—Å—Ç–∞—Ä–∞ —Ç–∞–±–ª–∏—Ü—è** `DEVICES` –∑ —É—Å—ñ–º–∞ –¥–∞–Ω–∏–º–∏, —ñ —Ç–∏ —Ö–æ—á–µ—à —Ä–æ–∑–Ω–µ—Å—Ç–∏ —ó—Ö —É –¥–≤—ñ **–Ω–æ–≤—ñ —Ç–∞–±–ª–∏—Ü—ñ**:

* `PP_LIST` ‚Äì —É–∑–∞–≥–∞–ª—å–Ω–µ–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ "pp" (id, name, short\_name, type)
* `PP_POINTS` ‚Äì –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ "points" (id, point\_id, pp\_id, name, inout).

---

### 1. –ù–∞–ø–æ–≤–Ω–µ–Ω–Ω—è **PP\_LIST**

–¢—É—Ç –±–µ—Ä–µ–º–æ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ `pp_id` —ñ–∑ DEVICES, –∞ —Ç–∞–∫–æ–∂ –ø–æ–ª—è `NAME`, `DEVICE_NAME`, `pp_type`.

```sql
INSERT INTO pp_list (id, pp_id, name, short_name, pp_type)
SELECT DISTINCT
       pp_id AS id,         -- –∞–±–æ –º–æ–∂–Ω–∞ –≤–∑—è—Ç–∏ SEQUENCE
       pp_id,
       name,                -- —É–∑–∞–≥–∞–ª—å–Ω–µ–Ω–µ —ñ–º'—è
       device_name,         -- –∫–æ—Ä–æ—Ç–∫–∞ –Ω–∞–∑–≤–∞
       pp_type
FROM devices;
```

> ‚ö†Ô∏è –Ø–∫—â–æ `pp_id` —É `DEVICES` –ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—è ‚Äì `DISTINCT` –ø–æ—Ç—Ä—ñ–±–µ–Ω, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤.
> –Ø–∫—â–æ –≤ —Ç–µ–±–µ —î `sequence`, —Ç–æ –∫—Ä–∞—â–µ `id` –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –≤—ñ–¥ –Ω–µ—ó, –∞ `pp_id` –±—Ä–∞—Ç–∏ –∑ DEVICES.

---

### 2. –ù–∞–ø–æ–≤–Ω–µ–Ω–Ω—è **PP\_POINTS**

–¢—É—Ç –∫–æ–∂–µ–Ω –∑–∞–ø–∏—Å —ñ–∑ DEVICES –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î point.

```sql
INSERT INTO pp_points (id, point_id, pp_id, point_name, inout)
SELECT id,         -- –º–æ–∂–Ω–∞ –∞–±–æ –∑–∞–ª–∏—à–∏—Ç–∏ —Å—Ç–∞—Ä–∏–π, –∞–±–æ sequence
       point_id,
       pp_id,
       device_name AS point_name,
       inout
FROM devices;
```

---

### 3. –í–∞—Ä—ñ–∞–Ω—Ç —ñ–∑ **sequence** (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π)

–Ø–∫—â–æ `id` —É –Ω–æ–≤–∏—Ö —Ç–∞–±–ª–∏—Ü—è—Ö –º–∞—î –±—É—Ç–∏ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º —Ç–∞ –Ω–µ–∑–∞–ª–µ–∂–Ω–∏–º –≤—ñ–¥ —Å—Ç–∞—Ä–∏—Ö `id`, —Ç–æ–¥—ñ –∫—Ä–∞—â–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `sequence`:

```sql
-- –î–ª—è PP_LIST
INSERT INTO pp_list (id, pp_id, name, short_name, pp_type)
SELECT pp_list_seq.NEXTVAL,
       d.pp_id,
       d.name,
       d.device_name,
       d.pp_type
FROM (SELECT DISTINCT pp_id, name, device_name, pp_type FROM devices) d;

-- –î–ª—è PP_POINTS
INSERT INTO pp_points (id, point_id, pp_id, point_name, inout)
SELECT pp_points_seq.NEXTVAL,
       d.point_id,
       d.pp_id,
       d.device_name,
       d.inout
FROM devices d;
```

---

üëâ –ó–∞–ø–∏—Ç–∞–Ω–Ω—è:
–¢–∏ —Ö–æ—á–µ—à, —â–æ–± —É –Ω–æ–≤–∏—Ö —Ç–∞–±–ª–∏—Ü—è—Ö `id` **—Å–ø—ñ–≤–ø–∞–¥–∞–ª–∏** –∑ `DEVICES.id` (–ø—Ä–æ—Å—Ç—ñ—à–µ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç–∏), —á–∏ –∫—Ä–∞—â–µ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –Ω–æ–≤—ñ `id` —á–µ—Ä–µ–∑ `sequence`?
