–¢–∞–∫, –æ—Ü–µ —è–∫—Ä–∞–∑ –∫–ª–∞—Å–∏—á–Ω–∏–π APEX-–≤–∏–ø–∞–¥–æ–∫ üôÇ
–Ø–∫—â–æ –Ω–æ–≤–∏–π –µ–ª–µ–º–µ–Ω—Ç –¥–æ–¥–∞—î—Ç—å—Å—è **—á–µ—Ä–µ–∑ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ** —ñ –ø—ñ—Å–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–∏ –ø—Ä–æ—Å—Ç–æ —Ä–æ–±–∏—à **Refresh —Ä–µ–≥—ñ–æ–Ω—É** (–∞–±–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∏), —Ç–æ JS –¥–ª—è ¬´–¥–æ–¥–∞–≤–∞–Ω–Ω—è¬ª —Ç–æ–±—ñ –π –Ω–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω. –ü–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–≤—ñ—Å–∏—Ç–∏—Å—è –Ω–∞ **After Refresh**.

---

## 1. –ó–∞–≥–∞–ª—å–Ω–∞ —ñ–¥–µ—è

–¢–∏ –≤–∂–µ –º–∞—î—à:

* `renumberListItems()` ‚Äì –ø–µ—Ä–µ–Ω—É–º–µ—Ä–æ–≤—É—î `li` (1,2,3‚Ä¶ —ñ `data-cl-order`).
* `rebuildConfirmListInColl($ul)` ‚Äì –∑–±–∏—Ä–∞—î –ø–æ—Ä—è–¥–æ–∫ —ñ —à–ª–µ –π–æ–≥–æ –≤ APEX-–ø—Ä–æ—Ü–µ—Å `REORDER_NUMBER_LIST`.

üëâ –¢–µ–ø–µ—Ä –ø—Ä–æ—Å—Ç–æ —Ç—Ä–µ–±–∞:

1. **–ü—ñ—Å–ª—è Refresh —Å–ø–∏—Å–∫—É** (–∫–æ–ª–∏ –ø–æ–≤–µ—Ä—Ç–∞—î—à—Å—è –∑ –º–æ–¥–∞–ª–∫–∏)
   –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —Ü—ñ –¥–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó.
2. –¶–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ —ñ –¥–ª—è **–¥–æ–¥–∞–≤–∞–Ω–Ω—è**, —ñ –¥–ª—è **–≤–∏–¥–∞–ª–µ–Ω–Ω—è**, —ñ –¥–ª—è –±—É–¥—å-—è–∫–æ–≥–æ `Refresh`.

---

## 2. –î–µ –æ–≥–æ–ª–æ—Å–∏—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ `renumberListItems` —ñ `rebuildConfirmListInColl` –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤:

* **Page ‚Üí JavaScript ‚Üí Function and Global Variable Declaration**,
  **–∞–±–æ** –≤ –∑–∞–≥–∞–ª—å–Ω–æ–º—É `app.js`, —è–∫–∏–π –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏–π –¥–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∏.

–¢–æ–±—Ç–æ –≤–æ–Ω–∏ –º–∞—é—Ç—å –±—É—Ç–∏ ¬´–≥–ª–æ–±–∞–ª—å–Ω—ñ¬ª, –∞ –Ω–µ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ Dynamic Action.

---

## 3. Dynamic Action: After Refresh –Ω–∞ —Ä–µ–≥—ñ–æ–Ω—ñ –∑—ñ —Å–ø–∏—Å–∫–æ–º

1. –í—ñ–¥–∫—Ä–∏–π **Page Designer**.
2. –ó–Ω–∞–π–¥–∏ —Ä–µ–≥—ñ–æ–Ω, –¥–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è —Ç–≤—ñ–π UL —ñ–∑ –∫–ª–∞—Å–æ–º `.confirm-list_items`.

   * –ë–∞–∂–∞–Ω–æ –∑–∞–¥–∞—Ç–∏ –π–æ–º—É **Static ID**, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `conf_list_region`.
3. –°—Ç–≤–æ—Ä–∏ **Dynamic Action**:

* **Name:** `Renumber list after refresh`
* **Event:** `After Refresh`
* **Selection Type:** *Region*
* **Region:** `conf_list_region`

4. –î–æ–¥–∞–π **True Action ‚Üí Execute JavaScript Code** –∑ —Ç–∞–∫–∏–º –∫–æ–¥–æ–º (–≤–∞—Ä—ñ–∞–Ω—Ç —á–µ—Ä–µ–∑ `affectedElements`):

```js
// –ü–µ—Ä–µ–Ω—É–º–µ—Ä–æ–≤—É—î–º–æ –≤—Å—ñ —Å–ø–∏—Å–∫–∏ –≤ —Ä–µ–≥—ñ–æ–Ω—ñ
renumberListItems();

// –ó–Ω–∞—Ö–æ–¥–∏–º–æ –≤—Å—ñ ul.confirm-list_items –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ä–µ–≥—ñ–æ–Ω—É, –¥–µ –±—É–≤ refresh
var $uls = this.affectedElements.find(".confirm-list_items");

$uls.each(function () {
  // –î–ª—è –∫–æ–∂–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É –ø–µ—Ä–µ–±—É–¥–æ–≤—É—î–º–æ –ø–æ—Ä—è–¥–æ–∫ —É –∫–æ–ª–µ–∫—Ü—ñ—ó
  rebuildConfirmListInColl($(this), false); // false = —Ü–µ –≤–∂–µ –¥—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
});
```

> –Ø–∫—â–æ —Ö–æ—á–µ—à –ø—Ä–æ—Å—Ç—ñ—à–µ, –º–æ–∂–Ω–∞ –π —Ç–∞–∫ (—è–∫—â–æ —Å–ø–∏—Å–æ–∫ –æ–¥–∏–Ω):
>
> ```js
> renumberListItems();
> rebuildConfirmListInColl($(".confirm-list_items").first(), false);
> ```

---

## 4. –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ –∑ –º–æ–¥–∞–ª—å–Ω–∏–º –≤—ñ–∫–Ω–æ–º

–ó–∞–∑–≤–∏—á–∞–π —Å—Ö–µ–º–∞ —Ç–∞–∫–∞:

1. –ù–∞ –¥–æ—á—ñ—Ä–Ω—ñ–π (–º–æ–¥–∞–ª—å–Ω—ñ–π) —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ —î –ø—Ä–æ—Ü–µ—Å –≤—Å—Ç–∞–≤–∫–∏ –≤ –∫–æ–ª–µ–∫—Ü—ñ—é / —Ç–∞–±–ª–∏—Ü—é.
2. –ü—ñ—Å–ª—è `Submit` ‚Üí `Close Dialog` (Dialog Return = `OK`).
3. –ù–∞ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ:

   * DA `Dialog Closed` ‚Üí —É–º–æ–≤–∞ `Event Result = OK` ‚Üí **Refresh —Ä–µ–≥—ñ–æ–Ω—É** –∑—ñ —Å–ø–∏—Å–∫–æ–º.

–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–ø—Ä–∞—Ü—é—î** —Ç–≤—ñ–π DA `After Refresh`:

* —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ—Ä–µ–Ω—É–º–µ—Ä—É—î—Ç—å—Å—è,
* –ø–æ—Ä—è–¥–æ–∫ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç—å—Å—è –≤ `REORDER_NUMBER_LIST`,
* —Ç–∏ –∑–±–µ—Ä–µ–∂–µ—à —Ä–µ–∞–ª—å–Ω–∏–π –ø–æ—Ä—è–¥–æ–∫ –≤–∏–∫–æ–Ω–∞–≤—Ü—ñ–≤ **–±–µ–∑ –æ–∫—Ä–µ–º–æ–≥–æ JS –Ω–∞ –≤—Å—Ç–∞–≤–∫—É**.

–ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ –ø—Ä–∏ **–≤–∏–¥–∞–ª–µ–Ω–Ω—ñ** –µ–ª–µ–º–µ–Ω—Ç–∞, —è–∫—â–æ –ø—ñ—Å–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ç–∏ —Ä–æ–±–∏—à `Refresh` —Ü—å–æ–≥–æ –∂ —Ä–µ–≥—ñ–æ–Ω—É.

---

## 5. –©–æ–± –Ω–µ –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ ‚Äú–∑–±–µ—Ä–µ–∂–µ–Ω–æ‚Äù –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ

–Ø–∫—â–æ —Ç–∏ –Ω–µ —Ö–æ—á–µ—à –±–∞—á–∏—Ç–∏ `#notSaveMessage` –ø—Ä–∏ **–ø–µ—Ä—à–æ–º—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏**, –∞–ª–µ —Ö–æ—á–µ—à –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ –ø—ñ—Å–ª—è –º–æ–¥–∞–ª–∫–∏ ‚Äì –º–æ–∂–Ω–∞ –∑–∞–ª–∏—à–∏—Ç–∏ –Ω–µ–≤–µ–ª–∏—á–∫–∏–π –ø—Ä–∞–ø–æ—Ä–µ—Ü—å.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≥–ª–æ–±–∞–ª—å–Ω–∞ –∑–º—ñ–Ω–Ω–∞:

```js
var gInitialLoadDone = false;

$(function () {
  // –ü—Ä–∏ –ø–µ—Ä—à–æ–º—É —Ä–µ–Ω–¥–µ—Ä—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–Ω—É–º–µ—Ä–æ–≤—É—î–º–æ, –±–µ–∑ –∑–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞
  renumberListItems();
  gInitialLoadDone = true;
});
```

–ê –≤ `After Refresh`:

```js
renumberListItems();

var $uls = this.affectedElements.find(".confirm-list_items");

$uls.each(function () {
  // –Ø–∫—â–æ —Ü–µ –ø–µ—Ä—à–∏–π load (–¥–æ –º–æ–¥–∞–ª–æ–∫) ‚Äì –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–¥–∞—Ç–∏ isInitial = true
  rebuildConfirmListInColl($(this), !gInitialLoadDone ? true : false);
});
```

–Ü –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ `fn_get_ordernumb(isInitial)` –Ω–µ –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —è–∫—â–æ `isInitial === true`.

---

### –ü—ñ–¥—Å—É–º–æ–∫

–£ —Ç–≤–æ—î–º—É —Å—Ü–µ–Ω–∞—Ä—ñ—ó (–º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ ‚Üí refresh —Ä–µ–≥—ñ–æ–Ω—É):

* **–Ω—ñ—á–æ–≥–æ –¥–æ–¥–∞—Ç–∫–æ–≤–æ –≤—Å—Ç–∞–≤–ª—è—Ç–∏ –≤ DOM —Ä—É–∫–∞–º–∏ –Ω–µ —Ç—Ä–µ–±–∞**,
* –¥–æ—Å—Ç–∞—Ç–Ω—å–æ:

1. –í–∏–Ω–µ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó –≤ –≥–ª–æ–±–∞–ª—å–Ω–∏–π —Å–∫—Ä–∏–ø—Ç.
2. –ü–æ–≤—ñ—Å–∏—Ç–∏ **Dynamic Action ‚ÄúAfter Refresh‚Äù** –Ω–∞ —Ä–µ–≥—ñ–æ–Ω –∑—ñ —Å–ø–∏—Å–∫–æ–º.
3. –£ —Ü—å–æ–º—É DA –≤–∏–∫–ª–∏–∫–∞—Ç–∏ `renumberListItems()` + `rebuildConfirmListInColl(...)`.

–Ü –≤—Å–µ: –ø—ñ—Å–ª—è **–±—É–¥—å-—è–∫–æ–≥–æ** –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–µ–≥—ñ–æ–Ω—É (–¥–æ–¥–∞–≤–∞–Ω–Ω—è, –≤–∏–¥–∞–ª–µ–Ω–Ω—è, —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è) –ø–æ—Ä—è–¥–æ–∫ –±—É–¥–µ –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π, –±–µ–∑ ¬´2,3,5¬ª –∑–∞–º—ñ—Å—Ç—å ¬´1,2,3¬ª.
