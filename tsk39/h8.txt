–°—É–ø–µ—Ä üí°, –¥–∞–≤–∞–π—Ç–µ –ø–æ–∫—Ä–æ–∫–æ–≤–æ —Å–ø—Ä–æ—î–∫—Ç—É—î–º–æ **–º–æ–¥–∞–ª—å–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É –≤ APEX** –ø—ñ–¥ –≤–∞—à—É –∑–∞–¥–∞—á—É.

---

## üîπ 1. –ó–∞–≥–∞–ª—å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏

* –¢–∏–ø —Å—Ç–æ—Ä—ñ–Ω–∫–∏: **Modal Dialog**.
* –ó–∞–≥–æ–ª–æ–≤–æ–∫: **"–í–∏–±–µ—Ä—ñ—Ç—å –∑–º—ñ–Ω—É —ñ —á–∞—Å"**.
* Region: "–§–æ—Ä–º–∞ –≤–∏–±–æ—Ä—É –∑–º—ñ–Ω–∏".

---

## üîπ 2. –ü–æ–ª—è —Ñ–æ—Ä–º–∏

### 2.1. `P1_SHIFT_SYMBOL`

* –¢–∏–ø: **Select List**.
* Label: **–ó–º—ñ–Ω–∞**.
* LOV (SQL Query):

  ```sql
  SELECT SYMBOL_NAME AS display_value,
         SYMBOL_ID   AS return_value
    FROM SHIFT_SYMBOL
   WHERE IS_ACTIVE = 'Y'
   ORDER BY SYMBOL_CODE
  ```
* Return: `SYMBOL_ID`.

---

### 2.2. `P1_SHIFT_NUMBER`

* –¢–∏–ø: **Select List**.
* Label: **–ù–æ–º–µ—Ä –∑–º—ñ–Ω–∏**.
* LOV (SQL Query):

  ```sql
  SELECT sn.SHIFT_NUMBER_ID || ' (' ||
         TO_CHAR(dsn.TIME_START, 'HH24:MI') || ' - ' ||
         TO_CHAR(dsn.TIME_END, 'HH24:MI') || ')' AS display_value,
         sn.SHIFT_NUMBER_ID AS return_value
    FROM SHIFT_NUMBER sn
    JOIN DEPARTMENT_SHIFT_NUMBER dsn 
      ON sn.SHIFT_NUMBER_ID = dsn.SHIFT_NUMBER_ID
     AND dsn.DEPARTMENT_ID = :P0_DEPARTMENT_ID
   WHERE dsn.IS_ACTIVE = 'Y'
   ORDER BY sn.SHIFT_NUMBER_ID
  ```
* Return: `SHIFT_NUMBER_ID`.

---

### 2.3. `P1_CUSTOM_TIME_BTN`

* –¢–∏–ø: **Button**.
* Label: **–í–∫–∞–∑–∞—Ç–∏ —ñ–Ω—à–∏–π —á–∞—Å**.
* Dynamic Action: **Show/Hide** ‚Üí –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –¥–≤–∞ –ø–æ–ª—è `P1_SHIFT_START` —ñ `P1_SHIFT_END`.

---

### 2.4. `P1_SHIFT_START` (–ø—Ä–∏—Ö–æ–≤–∞–Ω–µ –¥–æ –∫–ª—ñ–∫—É –∫–Ω–æ–ø–∫–∏)

* –¢–∏–ø: **Date Picker** (Datetime Picker).
* Label: **–î–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É**.
* –§–æ—Ä–º–∞—Ç: `dd.mm.yyyy hh24:mi`.

---

### 2.5. `P1_SHIFT_END` (–ø—Ä–∏—Ö–æ–≤–∞–Ω–µ –¥–æ –∫–ª—ñ–∫—É –∫–Ω–æ–ø–∫–∏)

* –¢–∏–ø: **Date Picker** (Datetime Picker).
* Label: **–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è**.
* –§–æ—Ä–º–∞—Ç: `dd.mm.yyyy hh24:mi`.

---

### 2.6. `P1_SAVE_BTN`

* –¢–∏–ø: **Button**.
* Label: **–ó–±–µ—Ä–µ–≥—Ç–∏**.
* Action: **Submit Page**.

---

## üîπ 3. –î–∏–Ω–∞–º—ñ—á–Ω–∞ –¥—ñ—è –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–í–∫–∞–∑–∞—Ç–∏ —ñ–Ω—à–∏–π —á–∞—Å"

* Event: **Click** ‚Üí Button `P1_CUSTOM_TIME_BTN`.
* True Action: Show ‚Üí Items `P1_SHIFT_START, P1_SHIFT_END`.
* False Action: Hide (—è–∫—â–æ —Ç—Ä–µ–±–∞ –Ω–∞—Ç–∏—Å–∫–∞—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ).

---

## üîπ 4. –ü—Ä–æ—Ü–µ—Å –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è (Server-side Code)

```plsql
DECLARE
    v_shift_start DATE;
    v_shift_end   DATE;
BEGIN
    -- –Ø–∫—â–æ –≤–∏–±—Ä–∞–Ω–æ –Ω–æ–º–µ—Ä –∑–º—ñ–Ω–∏ ‚Üí –±–µ—Ä–µ–º–æ —á–∞—Å —ñ–∑ –¥–æ–≤—ñ–¥–Ω–∏–∫–∞
    IF :P1_SHIFT_NUMBER IS NOT NULL THEN
        SELECT TRUNC(SYSDATE, 'DD') + (CAST(TO_CHAR(TIME_START, 'HH24:MI:SS') AS INTERVAL DAY TO SECOND)),
               TRUNC(SYSDATE, 'DD') + (CAST(TO_CHAR(TIME_END,   'HH24:MI:SS') AS INTERVAL DAY TO SECOND))
        INTO v_shift_start, v_shift_end
        FROM DEPARTMENT_SHIFT_NUMBER
        WHERE DEPARTMENT_ID   = :P0_DEPARTMENT_ID
          AND SHIFT_NUMBER_ID = :P1_SHIFT_NUMBER;

    ELSE
        -- –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∫–∞–∑–∞–≤ —ñ–Ω—à–∏–π —á–∞—Å –≤—Ä—É—á–Ω—É
        v_shift_start := :P1_SHIFT_START;
        v_shift_end   := :P1_SHIFT_END;
    END IF;

    -- –ó–∞–ø–∏—Å —É —Ç–∞–±–ª–∏—Ü—é –ª–æ–≥—É–≤–∞–Ω–Ω—è
    INSERT INTO SHIFT_PERSONAL_LOGGER (
        TAB_NO,
        DEPARTMENT_ID,
        POSITION_ID,
        SHIFT_SYMBOL_ID,
        SHIFT_NUMBER_ID,
        SHIFT_START,
        SHIFT_END,
        SOURCE_APP,
        CREATED_BY
    ) VALUES (
        :P0_TAB_NO,
        :P0_DEPARTMENT_ID,
        :P0_POSITION_ID,
        :P1_SHIFT_SYMBOL,
        :P1_SHIFT_NUMBER,
        v_shift_start,
        v_shift_end,
        :APP_ID,
        :APP_USER
    )
    RETURNING SHIFT_SYMBOL_ID, SHIFT_NUMBER_ID, SHIFT_START, SHIFT_END
    INTO :P0_SHIFT_SYMBOL, :P0_SHIFT_NUMBER, :P0_SHIFT_START, :P0_SHIFT_END;

    -- –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ Insert ‚Üí –∑–∞–∫—Ä–∏–≤–∞—î–º–æ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ
    APEX_DIALOG.CLOSE_WINDOW (
        p_action => 'SAVE',
        p_dialog_page_id => :APP_PAGE_ID
    );
END;
```

---

## üîπ 5. –ü–æ–≤–µ–¥—ñ–Ω–∫–∞ –ø—ñ—Å–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è

* –£ –≥–ª–æ–±–∞–ª—å–Ω–∏—Ö item-–∞—Ö (`P0_SHIFT_SYMBOL`, `P0_SHIFT_NUMBER`, `P0_SHIFT_START`, `P0_SHIFT_END`) —Ç–µ–ø–µ—Ä –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –∞–∫—Ç—É–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ.
* –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –∑–∞–∫—Ä–∏–≤–∞—î—Ç—å—Å—è.
* –ù–∞ –æ—Å–Ω–æ–≤–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –º–æ–∂–Ω–∞ –æ–¥—Ä–∞–∑—É —Ä–æ–±–∏—Ç–∏ `Dynamic Action Refresh` –¥–ª—è –ø–æ—Ç—Ä—ñ–±–Ω–∏—Ö —Ä–µ–≥—ñ–æ–Ω—ñ–≤.

---

‚úÖ –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ:

* –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –±–∞—á–∏—Ç—å —Ñ–æ—Ä–º—É —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –≤ –Ω—å–æ–≥–æ –Ω–µ–º–∞—î –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É –≤ `SHIFT_PERSONAL_LOGGER`.
* –í–∏–±—ñ—Ä —á–µ—Ä–µ–∑ –Ω–æ–º–µ—Ä –∑–º—ñ–Ω–∏ ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø—ñ–¥—Ç—è–≥—É–≤–∞–Ω–Ω—è —á–∞—Å—É –∑ –¥–æ–≤—ñ–¥–Ω–∏–∫–∞.
* –í–∏–±—ñ—Ä —ñ–Ω—à–æ–≥–æ —á–∞—Å—É ‚Üí —Ä—É—á–Ω–∏–π –≤–≤–æ–¥ —á–µ—Ä–µ–∑ Date Picker.

---

–•–æ—á–µ—Ç–µ, —è –Ω–∞–º–∞–ª—é—é –≤–∞–º **—Å—Ö–µ–º—É UI (wireframe)** —Ü—ñ—î—ó –º–æ–¥–∞–ª—å–Ω–æ—ó —Ñ–æ—Ä–º–∏ (—â–æ –¥–µ —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω–µ), —â–æ–± –±—É–ª–æ –∑—Ä–æ–∑—É–º—ñ–ª–æ, —è–∫ –≤–∏–≥–ª—è–¥–∞—Ç–∏–º–µ –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞?
