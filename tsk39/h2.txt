–ß—É–¥–æ–≤–∞ —ñ–¥–µ—è üëç. –î–∞–≤–∞–π—Ç–µ —Å–ø—Ä–æ—î–∫—Ç—É—î–º–æ —Ç–∞–±–ª–∏—Ü—é `SHIFT_PERSONAL_LOGGER` —Ç–∞–∫, —â–æ–± –≤–æ–Ω–∞ –º–æ–≥–ª–∞ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ä–æ–ª—å **—î–¥–∏–Ω–æ–≥–æ –¥–∂–µ—Ä–µ–ª–∞ –ø—Ä–∞–≤–¥–∏** –ø—Ä–æ —Ç–µ, —á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —É–∂–µ "–∑–∞—Ñ—ñ–∫—Å—É–≤–∞–≤—Å—è" –Ω–∞ –∑–º—ñ–Ω—ñ —É –≤–∞—à–∏—Ö APEX-–¥–æ–¥–∞—Ç–∫–∞—Ö.

---

## üìå –ë–∞–∑–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```sql
CREATE TABLE SHIFT_PERSONAL_LOGGER (
    ID               NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    LOG_DATE         DATE DEFAULT SYSDATE NOT NULL,   -- –¥–∞—Ç–∞/—á–∞—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–ø–∏—Å—É
    TAB_NO           NUMBER NOT NULL,                -- —Ç–∞–±–µ–ª—å–Ω–∏–π –Ω–æ–º–µ—Ä –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
    DEPARTMENT_ID    NUMBER NOT NULL,
    POSITION_ID      NUMBER,
    SHIFT_SYMBOL_ID  NUMBER,                         -- FK –Ω–∞ SHIFT_SYMBOL
    SHIFT_NUMBER_ID  NUMBER,                         -- FK –Ω–∞ SHIFT_NUMBER
    TIME_START       DATE NOT NULL,                  -- —Ñ–∞–∫—Ç–∏—á–Ω–∏–π —á–∞—Å –ø–æ—á–∞—Ç–∫—É
    TIME_END         DATE NOT NULL,                  -- —Ñ–∞–∫—Ç–∏—á–Ω–∏–π —á–∞—Å –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è
    SOURCE_APP       VARCHAR2(50),                   -- –∑ —è–∫–æ–≥–æ APEX app_id –ø—Ä–∏–π—à–æ–≤
    CREATED_BY       VARCHAR2(100) DEFAULT USER,     -- —Ö—Ç–æ —Å—Ç–≤–æ—Ä–∏–≤ (–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á Oracle –∞–±–æ APP_USER)
    CREATED_AT       DATE DEFAULT SYSDATE,           -- –∫–æ–ª–∏ —Å—Ç–≤–æ—Ä–µ–Ω–æ
    UPDATED_BY       VARCHAR2(100),
    UPDATED_AT       DATE,
    IS_ACTIVE        CHAR(1) DEFAULT 'Y' CHECK (IS_ACTIVE IN ('Y','N')) -- –¥–ª—è –º‚Äô—è–∫–æ–≥–æ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
);
```

---

## üìå –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —â–æ–¥–æ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –ø–æ–ª—ñ–≤

1. **`SOURCE_APP`** ‚Äì —â–æ–± –∑–Ω–∞—Ç–∏, –≤ —è–∫–æ–º—É —Å–∞–º–µ APEX-–¥–æ–¥–∞—Ç–∫—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Ä–æ–±–∏–≤ –≤–∏–±—ñ—Ä (—è–∫—â–æ —É –≤–∞—Å –¥–µ–∫—ñ–ª—å–∫–∞).
2. **`CREATED_BY / UPDATED_BY` + `CREATED_AT / UPDATED_AT`** ‚Äì —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –∞—É–¥–∏—Ç.
3. **`IS_ACTIVE`** ‚Äì —â–æ–± —É –º–∞–π–±—É—Ç–Ω—å–æ–º—É –º–æ–∂–Ω–∞ –±—É–ª–æ "–¥–µ–∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏" –∑–∞–ø–∏—Å –±–µ–∑ —Ñ—ñ–∑–∏—á–Ω–æ–≥–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è.
4. **–£–Ω—ñ–∫–∞–ª—å–Ω—ñ—Å—Ç—å**: –≤–∞—Ä—Ç–æ –ø–æ–¥—É–º–∞—Ç–∏ –ø—Ä–æ `UNIQUE (TAB_NO, TIME_START)` ‚Äì —â–æ–± –æ–¥–∏–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –≤—ñ–¥–∫—Ä–∏–≤ –∫—ñ–ª—å–∫–∞ —Å–µ—Å—ñ–π –¥–ª—è –æ–¥–Ω—ñ—î—ó –∑–º—ñ–Ω–∏.
5. **–Ü–Ω–¥–µ–∫—Å–∏**:

   * `IDX_SHIFT_LOGGER_TABNO` –Ω–∞ `TAB_NO` (—à–≤–∏–¥–∫–∏–π –ø–æ—à—É–∫ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, —á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —É–∂–µ –Ω–∞ –∑–º—ñ–Ω—ñ).
   * `IDX_SHIFT_LOGGER_DEPARTMENT` –Ω–∞ `DEPARTMENT_ID` (—â–æ–± —à–≤–∏–¥–∫–æ —Ä–æ–±–∏—Ç–∏ –∑–≤—ñ—Ç–∏ –ø–æ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞–º).

---

## üìå –õ–æ–≥—ñ–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### 1. –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–±—Ä–∞–≤ `SHIFT_NUMBER_ID`

* –ë–µ—Ä–µ–º–æ `TIME_START` = `SYSDATE`.
* –ë–µ—Ä–µ–º–æ `TIME_END` –∑ –¥–æ–≤—ñ–¥–Ω–∏–∫–∞ `DEPARTMENT_SHIFT_NUMBER` –¥–ª—è —Ü—å–æ–≥–æ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—É + –Ω–æ–º–µ—Ä–∞ –∑–º—ñ–Ω–∏.
* –£—Å—ñ —ñ–Ω—à—ñ –¥–æ–¥–∞—Ç–∫–∏ –ø—Ä–∏ –≤—Ö–æ–¥—ñ –¥–∏–≤–ª—è—Ç—å—Å—è:

  ```sql
  SELECT 1
  FROM SHIFT_PERSONAL_LOGGER
  WHERE TAB_NO = :APP_USER_TABNO
    AND TIME_END > SYSDATE
    AND IS_ACTIVE = 'Y';
  ```

  ‚Üí —è–∫—â–æ —Ç–∞–∫–∏–π –∑–∞–ø–∏—Å —î, —Ñ–æ—Ä–º—É –Ω–µ –ø–æ–∫–∞–∑—É—î–º–æ.

---

### 2. –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∫–∞–∑–∞–≤ `TIME_START / TIME_END` –≤—Ä—É—á–Ω—É (–±–µ–∑ shift\_number\_id)

* –ü—Ä–æ—Å—Ç–æ –∑–∞–ø–∏—Å—É—î–º–æ –≤ —Ç–∞–±–ª–∏—Ü—é —Ü—ñ –∑–Ω–∞—á–µ–Ω–Ω—è.
* –Ü–Ω—à—ñ –¥–æ–¥–∞—Ç–∫–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å —Ç–∞–∫ —Å–∞–º–æ ‚Üí –¥–æ `TIME_END` —Ñ–æ—Ä–º—É –±—ñ–ª—å—à–µ –Ω–µ –ø–æ–∫–∞–∑—É—î–º–æ.

---

## üìå –ü—Ä–∏–∫–ª–∞–¥ –≤—Å—Ç–∞–≤–∫–∏

```plsql
INSERT INTO SHIFT_PERSONAL_LOGGER (
    TAB_NO, DEPARTMENT_ID, POSITION_ID, 
    SHIFT_SYMBOL_ID, SHIFT_NUMBER_ID,
    TIME_START, TIME_END, SOURCE_APP
) VALUES (
    :P0_TAB_NO,
    :P0_DEPARTMENT_ID,
    :P0_POSITION_ID,
    :P0_SHIFT_SYMBOL_ID,
    :P0_SHIFT_NUMBER_ID,
    :P0_TIME_START,
    :P0_TIME_END,
    :APP_ID
);
```

---

## üìå –ü–µ—Ä–µ–≤–∞–≥–∏ –ø—ñ–¥—Ö–æ–¥—É

* –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –±–∞—á–∏—Ç—å —Ñ–æ—Ä–º—É –ª–∏—à–µ 1 —Ä–∞–∑ –Ω–∞ –ø–æ—á–∞—Ç–∫—É –∑–º—ñ–Ω–∏ ‚Üí –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–æ–≥–æ, —É —è–∫–æ–º—É APEX-–¥–æ–¥–∞—Ç–∫—É –≤—ñ–Ω –ø—Ä–∞—Ü—é—î.
* –õ–æ–≥—ñ–∫–∞ —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∞: —è–∫—â–æ –∑–º—ñ–Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–∞ ‚Üí –±–µ—Ä–µ–º–æ —á–∞—Å —ñ–∑ –¥–æ–≤—ñ–¥–Ω–∏–∫–∞ `DEPARTMENT_SHIFT_NUMBER`; —è–∫—â–æ –∫–∞—Å—Ç–æ–º–Ω–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª ‚Üí –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –≤–ª–∞—Å–Ω–æ—Ä—É—á.
* –õ–µ–≥–∫–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è —É –º–∞–π–±—É—Ç–Ω—å–æ–º—É –¥–ª—è –∑–≤—ñ—Ç—ñ–≤ (—Ö—Ç–æ –ø—Ä–∞—Ü—é–≤–∞–≤ –Ω–∞ —è–∫—ñ–π –∑–º—ñ–Ω—ñ, –∫–æ–ª–∏ –∑–∞—Ö–æ–¥–∏–≤ —ñ –∑ —è–∫–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É).

---

üëâ –ü–∏—Ç–∞–Ω–Ω—è: –≤–∏ —Ö–æ—á–µ—Ç–µ, —â–æ–± –ª–æ–≥—ñ–∫–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –±—Ä–∞–ª–∞ `TIME_END` –∑ `DEPARTMENT_SHIFT_NUMBER`** –ø—ñ–¥ —á–∞—Å —ñ–Ω—Å–µ—Ä—Ç–∞ –≤ `SHIFT_PERSONAL_LOGGER` (—è–∫—â–æ –∑–∞–¥–∞–Ω–æ `SHIFT_NUMBER_ID`), —á–∏ –∫—Ä–∞—â–µ, —â–æ–± —Ü—è –ª–æ–≥—ñ–∫–∞ –≤–∏–∫–æ–Ω—É–≤–∞–ª–∞—Å—å —É PL/SQL-–ø—Ä–æ—Ü–µ—Å—ñ –≤ APEX –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ—é?
