–û–∫, —è –∑—Ä–æ–∑—É–º—ñ–≤ –∑–∞–¥–∞—á—É üëá

–•–æ—á–µ—à, —â–æ–± —É `start_consist` –≤—ñ–¥–º—ñ—á–∞–ª–∏—Å—è **—Ç—ñ–ª—å–∫–∏** —Ç—ñ –Ω–∞—Ä—è–¥–∏, —è–∫—ñ:

1. **–ú–∞—é—Ç—å —Å—Ç–∞—Ç—É—Å "–î–æ–∑–≤–æ–ª–µ–Ω–∞"** (`ORDER_STATUS_ID = 3`)
   **—ñ** –¥–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É –ø–æ–ø–∞–¥–∞—î –≤ –ø–æ—Ç–æ—á–Ω—É –∑–º—ñ–Ω—É (—è–∫ –∑–∞—Ä–∞–∑),

**–ê–ë–û**

2. **–ú–∞—é—Ç—å —Å—Ç–∞—Ç—É—Å "–î–æ–∑–≤–æ–ª–µ–Ω–∞"**
   **—ñ** –¥–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É **–º–µ–Ω—à–∞ –∑–∞ —Å—å–æ–≥–æ–¥–Ω—ñ** (–ø—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω—ñ, –∞–ª–µ —â–µ –Ω–µ –≤—ñ–¥–∫—Ä–∏—Ç—ñ) ‚Äì —Ç–æ–±—Ç–æ —ó—Ö —Ç–µ–∂ —Ç—Ä–µ–±–∞ "–ø—ñ–¥—Ç—è–≥—É–≤–∞—Ç–∏" –Ω–∞ –∑–º—ñ–Ω—ñ.

–Ü **—è–∫—â–æ —Å—Ç–∞—Ç—É—Å —É–∂–µ "–í—ñ–¥–∫—Ä–∏—Ç–∞" (4)** ‚Äî —Ç–æ **–Ω–µ —Å—Ç–∞–≤–∏–º–æ** `startshift`, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –ø–æ —á–∞—Å—É –ø–æ–ø–∞–¥–∞—î —É –∑–º—ñ–Ω—É.

---

### –©–æ —Å–∞–º–µ —Ç—Ä–µ–±–∞ –∑–º—ñ–Ω–∏—Ç–∏

–£ —Ç–≤–æ—î–º—É –∑–∞–ø–∏—Ç—ñ —Ç—Ä–µ–±–∞ –ø–µ—Ä–µ—Ä–æ–±–∏—Ç–∏ –±–ª–æ–∫ `CASE ... AS start_consist`.
–ó–∞—Ä–∞–∑ —É –Ω—å–æ–º—É –≤–∑–∞–≥–∞–ª—ñ –Ω–µ –≤—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è —Å—Ç–∞—Ç—É—Å.
–ü—Ä–æ–ø–æ–Ω—É—é —Ç–∞–∫–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç (–æ—Å–Ω–æ–≤–Ω—É —á–∞—Å—Ç–∏–Ω—É view –Ω–µ —á—ñ–ø–∞—é, —Ç—ñ–ª—å–∫–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç):

```sql
CASE
    WHEN tw.ORDER_STATUS_ID = 3 -- —Ç—ñ–ª—å–∫–∏ "–î–æ–∑–≤–æ–ª–µ–Ω–∞"
         AND (
               -- 1) –ø–ª–∞–Ω–æ–≤–∏–π —Å—Ç–∞—Ä—Ç —Å—å–æ–≥–æ–¥–Ω—ñ —ñ –ø–æ–ø–∞–¥–∞—î –≤ –ø–æ—Ç–æ—á–Ω—É –∑–º—ñ–Ω—É
               (
                   TRUNC(tw.ORDERSTART) = TRUNC(SYSDATE)
                   AND (
                       ( TO_NUMBER(TO_CHAR(SYSDATE,'HH24')) BETWEEN 7 AND 14
                         AND TO_CHAR(tw.ORDERSTART,'HH24:MI') BETWEEN '07:00' AND '14:59'
                       )
                       OR
                       ( TO_NUMBER(TO_CHAR(SYSDATE,'HH24')) BETWEEN 15 AND 22
                         AND TO_CHAR(tw.ORDERSTART,'HH24:MI') BETWEEN '15:00' AND '22:59'
                       )
                       OR
                       ( (TO_NUMBER(TO_CHAR(SYSDATE,'HH24')) BETWEEN 23 AND 23
                          OR TO_NUMBER(TO_CHAR(SYSDATE,'HH24')) BETWEEN 0 AND 6
                         )
                         AND ( TO_CHAR(tw.ORDERSTART,'HH24:MI') BETWEEN '23:00' AND '23:59'
                               OR TO_CHAR(tw.ORDERSTART,'HH24:MI') BETWEEN '00:00' AND '06:59'
                             )
                       )
                   )
               )
               -- 2) –∞–±–æ –¥–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É –≤–∂–µ —Ä–∞–Ω—ñ—à–µ, –Ω—ñ–∂ —Å—å–æ–≥–æ–¥–Ω—ñ (–ø—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω–∏–π, –∞–ª–µ —â–µ –Ω–µ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π)
               OR TRUNC(tw.ORDERSTART) < TRUNC(SYSDATE)
         )
    THEN 'startshift'
    ELSE NULL
END AS start_consist,
```

üëâ –©–æ —Ü–µ –¥–∞—î:

* `startshift` –±—É–¥–µ –≤–∏—Å—Ç–∞–≤–ª—è—Ç–∏—Å—è **—Ç—ñ–ª—å–∫–∏** –¥–ª—è –Ω–∞—Ä—è–¥—ñ–≤ –∑—ñ —Å—Ç–∞—Ç—É—Å–æ–º **"–î–æ–∑–≤–æ–ª–µ–Ω–∞"** (`ORDER_STATUS_ID = 3`).
* –Ø–∫—â–æ –Ω–∞—Ä—è–¥ **–∑–∞–ø–ª–∞–Ω–æ–≤–∞–Ω–∏–π –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ –≤ –º–µ–∂–∞—Ö –ø–æ—Ç–æ—á–Ω–æ—ó –∑–º—ñ–Ω–∏** ‚Üí –ø–æ–∑–Ω–∞—á–∞—î–º–æ.
* –Ø–∫—â–æ –Ω–∞—Ä—è–¥ **–±—É–≤ –∑–∞–ø–ª–∞–Ω–æ–≤–∞–Ω–∏–π —Ä–∞–Ω—ñ—à–µ, –Ω—ñ–∂ —Å—å–æ–≥–æ–¥–Ω—ñ** (—ñ –¥–æ—Å—ñ "–¥–æ–∑–≤–æ–ª–µ–Ω–∏–π", –∞–ª–µ –Ω–µ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π) ‚Üí —Ç–µ–∂ –ø–æ–∑–Ω–∞—á–∞—î–º–æ –Ω–∞ –∑–º—ñ–Ω—ñ (—â–æ–± –Ω–µ –∑–∞–≥—É–±–∏–≤—Å—è).
* –Ø–∫—â–æ —Å—Ç–∞—Ç—É—Å –≤–∂–µ **"–í—ñ–¥–∫—Ä–∏—Ç–∞" (4)** ‚Äî —É–º–æ–≤–∞ `ORDER_STATUS_ID = 3` –Ω–µ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è, –æ—Ç–∂–µ `startshift` **–Ω–µ –ø—Ä–æ—Å—Ç–∞–≤–∏—Ç—å—Å—è**, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —á–∞—Å –ø–æ–ø–∞–¥–∞—î –≤ –∑–º—ñ–Ω—É.

---

–Ø–∫—â–æ —Ö–æ—á–µ—à, –º–æ–∂–µ–º–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–º –∫—Ä–æ–∫–æ–º –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–æ –¥–æ–æ–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ `end_consist` (–∞–ª–µ —Ç–∏ –ø—Ä–æ –Ω—å–æ–≥–æ –ø–æ–∫–∏ –Ω–µ –ø–∏—Ç–∞–≤, —Ç–æ–∂ –Ω–µ —á—ñ–ø–∞—é üôÇ).
