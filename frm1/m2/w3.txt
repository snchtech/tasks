–Ü–¥–µ–∞–ª—å–Ω–æ ‚úÖ
–¢–≤—ñ–π –∑–∞–ø–∏—Ç –∑–∞—Ä–∞–∑ –ø–æ–∫–∞–∑—É—î –∞–≥—Ä–µ–≥–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ –∫–æ–º–ø–∞–Ω—ñ—è—Ö —ñ –æ–¥–∏–Ω **–∑–∞–≥–∞–ª—å–Ω–∏–π Total**,
–∞ –ø–æ—Ç—Ä—ñ–±–Ω–æ, —â–æ–± **–ø–µ—Ä–µ–¥ –∫–æ–∂–Ω–æ—é –≥—Ä—É–ø–æ—é –∫–æ–º–ø–∞–Ω—ñ–π –∑ –ø–µ–≤–Ω–∏–º `company_type_name` –∑‚Äô—è–≤–ª—è–≤—Å—è —Ä–æ–∑–¥—ñ–ª—é–≤–∞–ª—å–Ω–∏–π —Ä—è–¥–æ–∫** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, ‚Äú–î–µ—Ä–∂–∞–≤–Ω—ñ –∫–æ–º–ø–∞–Ω—ñ—ó‚Äù, ‚Äú–ü—Ä–∏–≤–∞—Ç–Ω—ñ –∫–æ–º–ø–∞–Ω—ñ—ó‚Äù —Ç–æ—â–æ).

---

## üîπ –û–Ω–æ–≤–ª–µ–Ω–∏–π SQL —ñ–∑ —Ä–æ–∑–¥—ñ–ª—é–≤–∞–ª—å–Ω–∏–º–∏ —Ä—è–¥–∫–∞–º–∏ `company_type_name`

```sql
WITH base_data AS (
    SELECT 
        ct.id   AS company_type_id,
        ct.name AS company_type_name,
        c.name  AS company_name,
        SUM(ep.people_count) AS total_people,
        0 AS is_total,
        NULL AS row_class,
        0 AS is_header
    FROM external_personal ep
        JOIN company c       ON c.id = ep.company_id
        JOIN company_type ct ON ct.id = c.company_type_id
    WHERE TRUNC(ep.date_create) = TRUNC(:P_REPORT_DATE)
      AND ep.department_id IN (
          SELECT TO_NUMBER(column_value)
          FROM TABLE(apex_string.split(:P_REPORT_DEPARTMENTS, ':'))
      )
      AND ep.date_end IS NULL
    GROUP BY ct.id, ct.name, c.name
),
headers AS (
    SELECT 
        DISTINCT
        ct.id   AS company_type_id,
        ct.name AS company_type_name,
        ct.name AS company_name,  -- –Ω–∞–∑–≤–∞ –≥—Ä—É–ø–∏
        NULL AS total_people,
        0 AS is_total,
        'row-header' AS row_class,
        1 AS is_header
    FROM company_type ct
    WHERE EXISTS (
        SELECT 1
        FROM external_personal ep
        JOIN company c ON c.id = ep.company_id
        WHERE c.company_type_id = ct.id
          AND TRUNC(ep.date_create) = TRUNC(:P_REPORT_DATE)
          AND ep.department_id IN (
              SELECT TO_NUMBER(column_value)
              FROM TABLE(apex_string.split(:P_REPORT_DEPARTMENTS, ':'))
          )
          AND ep.date_end IS NULL
    )
),
totals AS (
    SELECT 
        NULL AS company_type_id,
        '–£—Å—å–æ–≥–æ' AS company_type_name,
        '–í—Å—å–æ–≥–æ' AS company_name,
        SUM(ep.people_count) AS total_people,
        1 AS is_total,
        'row-total' AS row_class,
        0 AS is_header
    FROM external_personal ep
    WHERE TRUNC(ep.date_create) = TRUNC(:P_REPORT_DATE)
      AND ep.department_id IN (
          SELECT TO_NUMBER(column_value)
          FROM TABLE(apex_string.split(:P_REPORT_DEPARTMENTS, ':'))
      )
      AND ep.date_end IS NULL
)
SELECT *
FROM (
    SELECT * FROM headers
    UNION ALL
    SELECT * FROM base_data
    UNION ALL
    SELECT * FROM totals
)
ORDER BY company_type_id, is_header DESC, company_name;
```

---

## üîπ üß† –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î

| –ß–∞—Å—Ç–∏–Ω–∞     | –©–æ —Ä–æ–±–∏—Ç—å                                                                    |
| ----------- | ---------------------------------------------------------------------------- |
| `base_data` | —Ç–≤–æ—ó –∑–≤–∏—á–∞–π–Ω—ñ —Ä—è–¥–∫–∏: –∫–æ–º–ø–∞–Ω—ñ—è ‚Äî –∫—ñ–ª—å–∫—ñ—Å—Ç—å                                    |
| `headers`   | –¥–æ–¥–∞—î —Ä–æ–∑–¥—ñ–ª—é–≤–∞–ª—å–Ω–∏–π —Ä—è–¥–æ–∫ —ñ–∑ –Ω–∞–∑–≤–æ—é `company_type_name` –ø–µ—Ä–µ–¥ –∫–æ–∂–Ω–æ—é –≥—Ä—É–ø–æ—é |
| `totals`    | —Ñ–æ—Ä–º—É—î –æ–¥–∏–Ω –≥–ª–æ–±–∞–ª—å–Ω–∏–π —Ä—è–¥–æ–∫ ‚Äú–í—Å—å–æ–≥–æ‚Äù –≤ –∫—ñ–Ω—Ü—ñ                                |
| `row_class` | –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è CSS-–æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è                                          |
| `ORDER BY`  | –∑–∞–±–µ–∑–ø–µ—á—É—î: –∑–∞–≥–æ–ª–æ–≤–æ–∫ ‚Üí –∫–æ–º–ø–∞–Ω—ñ—ó ‚Üí Total                                     |

---

## üîπ üîç –ü—Ä–∏–∫–ª–∞–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É

```
–î–µ—Ä–∂–∞–≤–Ω—ñ –∫–æ–º–ø–∞–Ω—ñ—ó
   –£–∫—Ä–ø–æ—à—Ç–∞                12
   –£–∫—Ä–∑–∞–ª—ñ–∑–Ω–∏—Ü—è             8
–ü—Ä–∏–≤–∞—Ç–Ω—ñ –∫–æ–º–ø–∞–Ω—ñ—ó
   SoftServe                6
   –ù–æ–≤–∞ –ø–æ—à—Ç–∞               9
–£—Å—å–æ–≥–æ
   –í—Å—å–æ–≥–æ                  35
```

---

## üîπ üé® –û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ CSS —É APEX

–£ **Page ‚Üí CSS ‚Üí Inline** –¥–æ–¥–∞–π:

```css
/* –†—è–¥–æ–∫-–∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∏–ø—É –∫–æ–º–ø–∞–Ω—ñ—ó */
.row-header td {
  background-color: #f3f4f7 !important;
  color: #003366 !important;
  font-weight: bold;
  border-top: 2px solid #c5cae9;
}

/* –†—è–¥–æ–∫ –í—Å—å–æ–≥–æ */
.row-total td {
  background-color: #d4edda !important;
  color: #155724 !important;
  font-weight: bold;
  border-top: 2px solid #b7e4c7;
}
```

---

## üîπ üîß –£ Interactive Report

–£ **Attributes ‚Üí Advanced ‚Üí Custom Attributes**
–¥–æ–¥–∞–π:

```
class="#ROW_CLASS#"
```

‚Üí —Ç–æ–¥—ñ APEX –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞—Å—Ç–æ—Å—É—î CSS –¥–æ –∫–æ–∂–Ω–æ–≥–æ —Ä—è–¥–∫–∞ –∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–º `ROW_CLASS`.

---

‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

* –†–æ–∑–¥—ñ–ª—é–≤–∞–ª—å–Ω—ñ —Ä—è–¥–∫–∏ –∑ –Ω–∞–∑–≤–∞–º–∏ —Ç–∏–ø—ñ–≤ –∫–æ–º–ø–∞–Ω—ñ–π (‚Äúheaders‚Äù) –∑‚Äô—è–≤–ª—è—é—Ç—å—Å—è —É –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö –º—ñ—Å—Ü—è—Ö.
* –û—Å–Ω–æ–≤–Ω—ñ —Ä—è–¥–∫–∏ –π–¥—É—Ç—å –ø—ñ–¥ –Ω–∏–º–∏.
* –í–Ω–∏–∑—É –æ–¥–∏–Ω –∑–µ–ª–µ–Ω–∏–π —Ä—è–¥–æ–∫ ‚Äú–í—Å—å–æ–≥–æ‚Äù.
* IR –ª–∏—à–∞—î—Ç—å—Å—è –¥–∏–Ω–∞–º—ñ—á–Ω–∏–º, —Ñ—ñ–ª—å—Ç—Ä–∏ –∑–∞ –¥–∞—Ç–æ—é —ñ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞–º–∏ –ø—Ä–∞—Ü—é—é—Ç—å —è–∫ —ñ —Ä–∞–Ω—ñ—à–µ.
