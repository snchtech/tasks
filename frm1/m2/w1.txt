–ß—É–¥–æ–≤–æ üëç
–¢–æ–¥—ñ —É—Ç–æ—á–Ω—é—î–º–æ –º–µ—Ç—É:

* —Ç–∏ —Ö–æ—á–µ—à **–∑–∞–ª–∏—à–∏—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑–≤—ñ—Ç—É**, —è–∫ –∑–∞—Ä–∞–∑ (—É—Å—ñ –∫–æ–º–ø–∞–Ω—ñ—ó + Total —É –∫—ñ–Ω—Ü—ñ, –Ω–µ –ø–æ –≥—Ä—É–ø–∞—Ö);
* –∞–ª–µ **–¥–æ–¥–∞—Ç–∏ –≤–∏–≤—ñ–¥ –Ω–∞–∑–≤ —Ç–∏–ø—ñ–≤ –∫–æ–º–ø–∞–Ω—ñ–π (company_type_name)** —è–∫ –æ–∫—Ä–µ–º—ñ *—Ä—è–¥–∫–∏-–∑–∞–≥–æ–ª–æ–≤–∫–∏* **–ø–µ—Ä–µ–¥ –∫–æ–∂–Ω–æ—é –≥—Ä—É–ø–æ—é –∫–æ–º–ø–∞–Ω—ñ–π**.

–¢–æ–±—Ç–æ —Ñ–æ—Ä–º–∞—Ç –º–∞—î –±—É—Ç–∏ —Ç–∞–∫–∏–π üëá

```
–î–µ—Ä–∂–∞–≤–Ω—ñ –∫–æ–º–ø–∞–Ω—ñ—ó
  –£–∫—Ä–ø–æ—à—Ç–∞ ‚Ä¶  
  –£–∫—Ä–∑–∞–ª—ñ–∑–Ω–∏—Ü—è ‚Ä¶  
–ü—Ä–∏–≤–∞—Ç–Ω—ñ –∫–æ–º–ø–∞–Ω—ñ—ó
  SoftServe ‚Ä¶  
  –ù–æ–≤–∞ –ø–æ—à—Ç–∞ ‚Ä¶  
Total ‚Ä¶ (–∑–∞–≥–∞–ª—å–Ω–∏–π –≤–Ω–∏–∑—É)
```

---

## üîπ –†—ñ—à–µ–Ω–Ω—è

–ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–µ ‚Äî —Å—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ *—Ç—Ä–µ—Ç—ñ–π –±–ª–æ–∫* `headers`, —è–∫–∏–π –≤—Å—Ç–∞–≤–∏—Ç—å ‚Äú—Ä—è–¥–∫–∏-–∑–∞–≥–æ–ª–æ–≤–∫–∏‚Äù –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ `company_type`, –∞ –ø–æ—Ç—ñ–º –≤—Å–µ –æ–±‚Äô—î–¥–Ω–∞—Ç–∏ —É –ø–æ—Ç—Ä—ñ–±–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É.
–¢–≤—ñ–π `Total` –∑–∞–ª–∏—à–∏—Ç—å—Å—è –≥–ª–æ–±–∞–ª—å–Ω–∏–º –≤–Ω–∏–∑—É.

---

### ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–∏–π SQL:

```sql
WITH base_data AS (
    SELECT 
        ct.id          AS company_type_id,
        ct.name        AS company_type_name,
        c.id           AS company_id,
        c.name         AS company_name,
        NVL(wt.name, ep.work_type_text) AS work_type_name,
        u.id           AS unit_id,
        u.name         AS unit_name,
        ep.people_count,
        ep.date_create,
        ep.creator,
        0 AS is_total,
        0 AS is_header
    FROM external_personal ep
        JOIN company c       ON c.id = ep.company_id
        JOIN company_type ct ON ct.id = c.company_type_id
        LEFT JOIN work_type wt ON wt.id = ep.work_type_id
        LEFT JOIN units u      ON u.id = ep.unit_id
    WHERE ep.date_end IS NULL
),
totals AS (
    SELECT 
        NULL AS company_type_id,
        '–£—Å—å–æ–≥–æ' AS company_type_name,
        NULL AS company_id,
        'Total' AS company_name,
        NULL AS work_type_name,
        NULL AS unit_id,
        NULL AS unit_name,
        SUM(ep.people_count) AS people_count,
        NULL AS date_create,
        NULL AS creator,
        1 AS is_total,
        0 AS is_header
    FROM external_personal ep
    WHERE ep.date_end IS NULL
),
headers AS (
    SELECT 
        DISTINCT
        ct.id          AS company_type_id,
        ct.name        AS company_type_name,
        NULL AS company_id,
        ct.name AS company_name, -- –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è —è–∫ –∑–∞–≥–æ–ª–æ–≤–æ–∫
        NULL AS work_type_name,
        NULL AS unit_id,
        NULL AS unit_name,
        NULL AS people_count,
        NULL AS date_create,
        NULL AS creator,
        0 AS is_total,
        1 AS is_header
    FROM external_personal ep
        JOIN company c       ON c.id = ep.company_id
        JOIN company_type ct ON ct.id = c.company_type_id
    WHERE ep.date_end IS NULL
)
SELECT *
FROM (
    SELECT * FROM headers
    UNION ALL
    SELECT * FROM base_data
    UNION ALL
    SELECT * FROM totals
)
ORDER BY 
    company_type_id NULLS LAST, 
    is_header DESC, 
    is_total, 
    company_name;
```

---

## üîπ üß† –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î

| –ß–∞—Å—Ç–∏–Ω–∞     | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è                                                               |
| ----------- | ------------------------------------------------------------------------- |
| `base_data` | —É—Å—ñ —Ä—è–¥–∫–∏ –∫–æ–º–ø–∞–Ω—ñ–π —ñ–∑ –ø–æ–≤–Ω–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é                                  |
| `headers`   | –≤—Å—Ç–∞–≤–ª—è—î —Ä—è–¥–æ–∫ –∑ –Ω–∞–∑–≤–æ—é —Ç–∏–ø—É –∫–æ–º–ø–∞–Ω—ñ—ó –ø–µ—Ä–µ–¥ –∫–æ–∂–Ω–æ—é –≥—Ä—É–ø–æ—é                 |
| `totals`    | —Å—Ç–≤–æ—Ä—é—î —î–¥–∏–Ω–∏–π –∑–∞–≥–∞–ª—å–Ω–∏–π —Ä—è–¥–æ–∫ ‚Äú–£—Å—å–æ–≥–æ‚Äù –≤ –∫—ñ–Ω—Ü—ñ                           |
| `ORDER BY`  | –∑–∞–±–µ–∑–ø–µ—á—É—î –ø—Ä–∞–≤–∏–ª—å–Ω—É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å: —Å–ø–æ—á–∞—Ç–∫—É –∑–∞–≥–æ–ª–æ–≤–æ–∫ ‚Üí –∫–æ–º–ø–∞–Ω—ñ—ó ‚Üí Total |

---

## üîπ üîç –†–µ–∑—É–ª—å—Ç–∞—Ç —É –∑–≤—ñ—Ç—ñ

```
–î–µ—Ä–∂–∞–≤–Ω—ñ –∫–æ–º–ø–∞–Ω—ñ—ó
   –£–∫—Ä–ø–æ—à—Ç–∞                12
   –£–∫—Ä–∑–∞–ª—ñ–∑–Ω–∏—Ü—è             8
–ü—Ä–∏–≤–∞—Ç–Ω—ñ –∫–æ–º–ø–∞–Ω—ñ—ó
   SoftServe                6
   –ù–æ–≤–∞ –ø–æ—à—Ç–∞               9
–£—Å—å–æ–≥–æ
   Total                   35
```

---

## üîπ üé® –í–∏–¥—ñ–ª–µ–Ω–Ω—è —Å—Ç–∏–ª—è–º–∏ –≤ APEX

–£ Interactive Report –¥–æ–¥–∞–π **Highlight Rules**:

| –£–º–æ–≤–∞           | –°—Ç–∏–ª—å                                                        |
| --------------- | ------------------------------------------------------------ |
| `IS_HEADER = 1` | `background-color:#f3f3f3; font-weight:bold; color:#003366;` |
| `IS_TOTAL = 1`  | `background-color:#d4edda; color:#155724; font-weight:bold;` |

---

‚úÖ **–û—Ç—Ä–∏–º–∞—î—à:**

* –ø–æ–≤–Ω—É —Ç–∞–±–ª–∏—Ü—é –∑ —É—Å—ñ–º–∞ —Ä—è–¥–∫–∞–º–∏;
* ‚Äú—Ä–æ–∑–¥—ñ–ª—é–≤–∞—á—ñ‚Äù –∑ –Ω–∞–∑–≤–∞–º–∏ —Ç–∏–ø—ñ–≤ –∫–æ–º–ø–∞–Ω—ñ–π —è–∫ –≥—Ä—É–ø–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏;
* –æ–¥–∏–Ω —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π —Ä—è–¥–æ–∫ ‚ÄúTotal‚Äù —É –∫—ñ–Ω—Ü—ñ;
* –ª–æ–≥—ñ—á–Ω–∏–π –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è —ñ –ø—Ä–æ—Å—Ç–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –≤ IR.
