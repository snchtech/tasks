–ß—É–¥–æ–≤–æ üëå
–¢–∏ –æ–ø–∏—Å—É—î—à **–∞–Ω–∞–ª—ñ—Ç–∏—á–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É –∑–≤—ñ—Ç—ñ–≤**, —è–∫–∞ –¥–æ–∑–≤–æ–ª–∏—Ç—å –≥–Ω—É—á–∫–æ —Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –∑–∞ –¥–∞—Ç–æ—é –π –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª–∞–º–∏, –∞ –ø–µ—Ä—à–∏–π –∑–≤—ñ—Ç ‚Äî –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏–º–µ –∞–≥—Ä–µ–≥–æ–≤–∞–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø–æ –∫–æ–º–ø–∞–Ω—ñ—è—Ö, –∑–≥—Ä—É–ø–æ–≤–∞–Ω—É –∑–∞ —Ç–∏–ø–∞–º–∏ –∫–æ–º–ø–∞–Ω—ñ–π.

---

## üîπ –ö–æ–Ω—Ü–µ–ø—Ç —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∑–≤—ñ—Ç—ñ–≤ (Reports Page)

### **–ï–ª–µ–º–µ–Ω—Ç–∏ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è (—Ñ—ñ–ª—å—Ç—Ä–∏):**

1. **Date picker:**

   * Item: `P_REPORT_DATE`
   * Default value: `SYSDATE`
   * –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó `external_personal.date_create`.

2. **Checkbox Group (Departments):**

   * Item: `P_REPORT_DEPARTMENTS`
   * LOV SQL (–ø–æ–∫–∞–∑—É—î –ª–∏—à–µ —Ç—ñ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∏, —è–∫—ñ –º–∞—é—Ç—å –∑–∞–ø–∏—Å–∏ –Ω–∞ –≤–∏–±—Ä–∞–Ω—É –¥–∞—Ç—É):

     ```sql
     SELECT DISTINCT d.name AS display_value,
                     d.id   AS return_value
     FROM   external_personal ep
     JOIN   departments d ON d.id = ep.department_id
     WHERE  TRUNC(ep.date_create) = TRUNC(:P_REPORT_DATE)
       AND  ep.date_end IS NULL
     ORDER BY d.name
     ```
   * **Default type:** All selected by default.
     (–£ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—è—Ö item ‚Üí Default ‚Üí SQL Query ‚Üí `SELECT id FROM departments WHERE ...`).
   * **Dynamic Action:**
     On Change ‚Üí Refresh all 3 reports.

---

## üîπ –ü–µ—Ä—à–∏–π –∑–≤—ñ—Ç: "–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—É –ø–æ –≤–∏–∫–æ–Ω–∞–≤—Ü—è—Ö"

### **SQL –¥–ª—è Interactive Report –∞–±–æ Classic Report:**

```sql
SELECT 
    ct.name AS company_type_name,      -- –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è –∑–∞ —Ç–∏–ø–æ–º –∫–æ–º–ø–∞–Ω—ñ—ó
    c.name  AS company_name,           -- –ù–∞–∑–≤–∞ –≤–∏–∫–æ–Ω–∞–≤—Ü—è (–∫–æ–º–ø–∞–Ω—ñ—ó)
    SUM(ep.people_count) AS total_people
FROM 
    external_personal ep
JOIN 
    company c ON c.id = ep.company_id
JOIN 
    company_type ct ON ct.id = c.company_type_id
WHERE 
    TRUNC(ep.date_create) = TRUNC(:P_REPORT_DATE)
    AND ep.department_id IN (
        SELECT TO_NUMBER(column_value)
        FROM TABLE(apex_string.split(:P_REPORT_DEPARTMENTS, ':'))
    )
    AND ep.date_end IS NULL
GROUP BY 
    ct.name, c.name
ORDER BY 
    ct.name, c.name;
```

---

### **–û–ø–∏—Å –ª–æ–≥—ñ–∫–∏:**

* –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `:P_REPORT_DATE` ‚Üí –¥–∞—Ç–∞, –∑–∞ —è–∫—É –ø–æ–∫–∞–∑—É—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é.
* Checkbox group `:P_REPORT_DEPARTMENTS` ‚Üí —Å–ø–∏—Å–æ–∫ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ñ–≤, –≤–∏–±—Ä–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º.

  * `apex_string.split` —Ä–æ–∑–±–∏–≤–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è `1:2:3` —É —Å–ø–∏—Å–æ–∫ –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó.
* –î–∞–Ω—ñ –≥—Ä—É–ø—É—é—Ç—å—Å—è –¥–≤–æ–º–∞ —Ä—ñ–≤–Ω—è–º–∏:

  1. `COMPANY_TYPE_NAME` ‚Üí —Ä—ñ–≤–µ–Ω—å –≥—Ä—É–ø–∏ —É –∑–≤—ñ—Ç—ñ.
  2. `COMPANY_NAME` ‚Üí —Ä—ñ–≤–µ–Ω—å –≤–∏–∫–æ–Ω–∞–≤—Ü—è (–∫–æ–º–ø–∞–Ω—ñ—ó).

---

### **–†–µ–∑—É–ª—å—Ç–∞—Ç —É –∑–≤—ñ—Ç—ñ (–ø—Ä–∏–∫–ª–∞–¥):**

```
COMPANY_TYPE: –î–µ—Ä–∂–∞–≤–Ω—ñ –∫–æ–º–ø–∞–Ω—ñ—ó
---------------------------------------
–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å         | –ö-—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—É
---------------------------------------
–£–∫—Ä–∑–∞–ª—ñ–∑–Ω–∏—Ü—è       |  34
–£–∫—Ä–ø–æ—à—Ç–∞           |  22
---------------------------------------
Total              |  56

COMPANY_TYPE: –ü—Ä–∏–≤–∞—Ç–Ω—ñ –∫–æ–º–ø–∞–Ω—ñ—ó
---------------------------------------
SoftServe          |  15
–ù–æ–≤–∞ –ø–æ—à—Ç–∞         |  12
---------------------------------------
Total              |  27
```

---

## üîπ –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —É APEX

### **1Ô∏è‚É£ Region: ‚Äú–§—ñ–ª—å—Ç—Ä–∏‚Äù (–Ω–∞–≥–æ—Ä—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏)**

* –î–æ–¥–∞–π:

  * `P_REPORT_DATE` (Date Picker)
  * `P_REPORT_DEPARTMENTS` (Checkbox Group)
* Dynamic Action:

  * On Change ‚Üí Refresh regions:

    * Report_1
    * Report_2
    * Report_3

---

### **2Ô∏è‚É£ Region: ‚Äú–ó–≤—ñ—Ç 1 ‚Äî –í–∏–∫–æ–Ω–∞–≤—Ü—ñ‚Äù (Interactive Report / Classic Report)**

* Source Type: SQL Query (–≤–∏—â–µ).
* Group by: `COMPANY_TYPE_NAME`.
* Highlight –∞–±–æ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è Total ‚Äî –∑–∞ –ø–æ—Ç—Ä–µ–±–∏ —á–µ—Ä–µ–∑ `ROLLUP` –∞–±–æ –æ–∫—Ä–µ–º–∏–π —Ä—è–¥–æ–∫.

---

### **3Ô∏è‚É£ –û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è**

#### –ü—Ä–∏–∫–ª–∞–¥ –¥–ª—è `ROLLUP`, —è–∫—â–æ —Ö–æ—á–µ—à –¥–æ–¥–∞—Ç–∏ ‚ÄúTotal‚Äù —É —Å–∞–º–æ–º—É SQL:

```sql
SELECT 
    ct.name AS company_type_name,
    CASE WHEN GROUPING(c.name) = 1 THEN 'Total' ELSE c.name END AS company_name,
    SUM(ep.people_count) AS total_people
FROM 
    external_personal ep
JOIN 
    company c ON c.id = ep.company_id
JOIN 
    company_type ct ON ct.id = c.company_type_id
WHERE 
    TRUNC(ep.date_create) = TRUNC(:P_REPORT_DATE)
    AND ep.department_id IN (
        SELECT TO_NUMBER(column_value)
        FROM TABLE(apex_string.split(:P_REPORT_DEPARTMENTS, ':'))
    )
    AND ep.date_end IS NULL
GROUP BY 
    ROLLUP(ct.name, c.name)
ORDER BY 
    ct.name, c.name;
```

üëâ –ü–µ—Ä–µ–≤–∞–≥–∞ `ROLLUP`: —Å—Ç–≤–æ—Ä—é—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ä—è–¥–æ–∫ `Total` –¥–ª—è –∫–æ–∂–Ω–æ—ó –≥—Ä—É–ø–∏ –∫–æ–º–ø–∞–Ω—ñ–π –±–µ–∑ UNION.

---

### **4Ô∏è‚É£ CSS –¥–ª—è Total (—è–∫ —É –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –∑–≤—ñ—Ç—ñ):**

```css
.a-IRR-table tr td:has(span:contains("Total")) {
  background-color: #d4edda !important;
  font-weight: bold;
  color: #155724 !important;
}
```

---

## üîπ –ö–æ—Ä–æ—Ç–∫–æ –ø—Ä–æ –¥–∏–Ω–∞–º—ñ–∫—É

| –ï–ª–µ–º–µ–Ω—Ç                | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è                    | –î—ñ—è –ø—Ä–∏ –∑–º—ñ–Ω—ñ              |
| ---------------------- | ------------------------------ | -------------------------- |
| `P_REPORT_DATE`        | –í–∏–±—ñ—Ä –¥–∞—Ç–∏                     | Refresh —É—Å—ñ—Ö –∑–≤—ñ—Ç—ñ–≤        |
| `P_REPORT_DEPARTMENTS` | –í–∏–±—ñ—Ä –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—ñ–≤              | Refresh —É—Å—ñ—Ö –∑–≤—ñ—Ç—ñ–≤        |
| –ó–≤—ñ—Ç 1                 | –ó–∞–≥–∞–ª—å–Ω—ñ –ø—ñ–¥—Å—É–º–∫–∏ –ø–æ –∫–æ–º–ø–∞–Ω—ñ—è—Ö | –ó–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –æ–±–æ—Ö —Ñ—ñ–ª—å—Ç—Ä—ñ–≤ |

---

–•–æ—á–µ—à, —â–æ–± —è –ø—ñ–¥–≥–æ—Ç—É–≤–∞–≤ –ø–æ–≤–Ω—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å—Ç–æ—Ä—ñ–Ω–∫–∏ (–∑ —Ç—Ä—å–æ–º–∞ –∑–≤—ñ—Ç–∞–º–∏), –≤–∫–ª—é—á–Ω–æ –∑ –¥—Ä—É–≥–∏–º —ñ —Ç—Ä–µ—Ç—ñ–º ‚Äî –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —â–æ–± –¥—Ä—É–≥–∏–π –ø–æ–∫–∞–∑—É–≤–∞–≤ –¥–µ—Ç–∞–ª—ñ–∑–∞—Ü—ñ—é –ø–æ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª–∞—Ö, –∞ —Ç—Ä–µ—Ç—ñ–π ‚Äî –ø–æ —Ç–∏–ø–∞—Ö —Ä–æ–±—ñ—Ç —É –∫–æ–º–ø–∞–Ω—ñ—è—Ö?
