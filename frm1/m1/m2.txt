–°—É–ø–µ—Ä üí™
–û—Å—å –≥–æ—Ç–æ–≤–∏–π **–ø–æ–∫—Ä–æ–∫–æ–≤–∏–π —à–∞–±–ª–æ–Ω —Å—Ç–æ—Ä—ñ–Ω–∫–∏ "Edit External Personal" (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Page 20)** ‚Äî –ø–æ–≤–Ω—ñ—Å—Ç—é —Å—É–º—ñ—Å–Ω–∏–π –∑ —Ç–≤–æ—ó–º Interactive Report, –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é –∞—É–¥–∏—Ç—É (`date_update`, `updator`) —ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è–º –Ω–∞ –æ—Å–Ω–æ–≤–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É –ø—ñ—Å–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è.

---

## üîπ üß± –ó–∞–≥–∞–ª—å–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Å—Ç–æ—Ä—ñ–Ω–∫–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä         | –ó–Ω–∞—á–µ–Ω–Ω—è                       |
| ---------------- | ------------------------------ |
| **Page Type**    | Form                           |
| **Page Name**    | Edit External Personal         |
| **Page Number**  | 20                             |
| **Target Table** | `EXTERNAL_PERSONAL`            |
| **Page Mode**    | Modal Dialog *(—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)* |
| **Source Type**  | SQL Query                      |
| **Primary Key**  | `ID`                           |

---

## üîπ üß© SQL Source –¥–ª—è —Ñ–æ—Ä–º–∏

```sql
SELECT 
    id,
    company_id,
    unit_id,
    work_type_id,
    work_type_text,
    people_count,
    department_id,
    date_create,
    creator,
    date_update,
    updator
FROM external_personal
WHERE id = :P20_ID
```

---

## üîπ üßæ –ï–ª–µ–º–µ–Ω—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫–∏

| Item               | –¢–∏–ø          | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è                  | –ü—Ä–∏–º—ñ—Ç–∫–∞                                                   |
| ------------------ | ------------ | ---------------------------- | ---------------------------------------------------------- |
| `P20_ID`           | Hidden       | –Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –∑–∞–ø–∏—Å—É         | –ü–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –∑ IR                                           |
| `P20_COMPANY_NAME` | Display Only | –ù–∞–∑–≤–∞ –∫–æ–º–ø–∞–Ω—ñ—ó               | LOV: `SELECT name FROM company WHERE id = :P20_COMPANY_ID` |
| `P20_UNIT_NAME`    | Display Only | –ù–∞–∑–≤–∞ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—É             | LOV: `SELECT name FROM units WHERE id = :P20_UNIT_ID`      |
| `P20_WORK_TYPE`    | Display Only | –¢–∏–ø —Ä–æ–±—ñ—Ç                    | `NVL(wt.name, ep.work_type_text)`                          |
| `P20_PEOPLE_COUNT` | Number Field | **–†–µ–¥–∞–≥—É—î—Ç—å—Å—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º** | –î–æ–¥–∞–π Label: ‚Äú–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—É‚Äù                         |
| `P20_CREATOR`      | Display Only | –•—Ç–æ —Å—Ç–≤–æ—Ä–∏–≤                  | Read-only                                                  |
| `P20_DATE_CREATE`  | Display Only | –ö–æ–ª–∏ —Å—Ç–≤–æ—Ä–µ–Ω–æ                | Read-only                                                  |
| `P20_UPDATOR`      | Display Only | –•—Ç–æ –æ–Ω–æ–≤–∏–≤                   | Read-only                                                  |
| `P20_DATE_UPDATE`  | Display Only | –ö–æ–ª–∏ –æ–Ω–æ–≤–ª–µ–Ω–æ                | Read-only                                                  |

---

## üîπ ‚öôÔ∏è Process ‚Üí **Update Record**

**Process Name:** `UPDATE_EP`
**When Button Pressed:** `UPDATE`
**PL/SQL Code:**

```plsql
BEGIN
    UPDATE external_personal
       SET people_count = :P20_PEOPLE_COUNT,
           date_update  = SYSDATE,
           updator      = :APP_USER
     WHERE id = :P20_ID;

    APEX_DEBUG.MESSAGE('Updated record ID=' || :P20_ID || ' by ' || :APP_USER);
END;
```

‚úÖ

* –ü—ñ—Å–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—É.
* –ó–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –¥–∞—Ç–∞ —ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á, —â–æ –∑—Ä–æ–±–∏–≤ –∑–º—ñ–Ω–∏.

---

## üîπ üß† Process ‚Üí ‚ÄúClose Dialog and Refresh Report‚Äù

**Process Type:** *Close Dialog*
**Settings:**

* ‚ÄúAfter Processing‚Äù
* **Dialog Action:** Close Dialog
* **Dialog Return Value:** Success
* **Affecting Regions:** Main IR Region on Page 10

---

## üîπ üß± Button Setup

| Button   | Label     | Position       | Action                                       |
| -------- | --------- | -------------- | -------------------------------------------- |
| `CANCEL` | –°–∫–∞—Å—É–≤–∞—Ç–∏ | Top ‚Üí Right    | *Defined by Dialog framework (Close Dialog)* |
| `UPDATE` | –û–Ω–æ–≤–∏—Ç–∏   | Bottom ‚Üí Right | *Submit Page* (calls `UPDATE_EP`)            |

---

## üîπ üß∞ IR Integration (–æ—Å–Ω–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞)

–£ —Ç–≤–æ—î–º—É IR –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Page 10)
—Å—Ç–≤–æ—Ä–∏ –∫–æ–ª–æ–Ω–∫—É:

```sql
'<a href="javascript:void(0)" 
   onclick="apex.navigation.dialog(' ||
   apex_util.prepare_url('f?p=&APP_ID.:20:&SESSION.::NO::P20_ID:' || id) ||
   ',{title:''–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Å—É'',height:400,width:600,modal:true,dialog:null});"
   class="t-Button t-Button--small t-Button--edit">
   <span class="fa fa-edit"></span></a>' AS edit_link
```

> üîπ –í–æ–Ω–∞ –≤—ñ–¥–∫—Ä–∏—î –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ (Page 20) –∑ —Ñ–æ—Ä–º–æ—é —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è.

---

## üîπ üßæ –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ: –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—Ö

–î–æ–¥–∞–π Dynamic Action –ø—ñ—Å–ª—è –ø—Ä–æ—Ü–µ—Å—É `UPDATE_EP` ‚Üí
Action: ‚ÄúShow Notification‚Äù ‚Üí Message:
`–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—É —É—Å–ø—ñ—à–Ω–æ –æ–Ω–æ–≤–ª–µ–Ω–æ.`

---

## üîπ üîí –ë–µ–∑–ø–µ–∫–∞ —Ç–∞ –∞—É–¥–∏—Ç

–û—Å–∫—ñ–ª—å–∫–∏ –≤ —Ç–µ–±–µ –≤–∂–µ —î —Ç—Ä–∏–≥–µ—Ä `TRG_EP_AUDIT`, –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ —Ü–µ–π –∑–∞–ø–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∫–æ–ø—ñ—é—î—Ç—å—Å—è –≤ `EXTERNAL_PERSONAL_HISTORY`.
–û—Ç–∂–µ, —É—Å—è —ñ—Å—Ç–æ—Ä—ñ—è –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –±–µ–∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –¥—ñ–π –Ω–∞ —Ñ–æ—Ä–º—ñ.

---

## üîπ üîç –†–µ–∑—é–º–µ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏

| –ö—Ä–æ–∫ | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç             | –î—ñ—è                                                    |
| ---- | --------------------- | ------------------------------------------------------ |
| 1    | IR (Page 10)          | –ö–Ω–æ–ø–∫–∞ üñâ –≤—ñ–¥–∫—Ä–∏–≤–∞—î Page 20 (Modal)                    |
| 2    | Page 20 (Form)        | –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –¥–∞–Ω—ñ –∑ `EXTERNAL_PERSONAL`                  |
| 3    | –ö–Ω–æ–ø–∫–∞ –û–Ω–æ–≤–∏—Ç–∏        | –í–∏–∫–æ–Ω—É—î UPDATE + –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î `date_update`, `updator`   |
| 4    | –¢—Ä–∏–≥–µ—Ä `TRG_EP_AUDIT` | –ó–±–µ—Ä—ñ–≥–∞—î —Å—Ç–∞—Ä—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–æ `EXTERNAL_PERSONAL_HISTORY` |
| 5    | Close Dialog          | –ü–æ–≤–µ—Ä—Ç–∞—î `Success`, IR –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è                     |

---

–•–æ—á–µ—à, —â–æ–± —è –ø—ñ–¥–≥–æ—Ç—É–≤–∞–≤ —Ç–∞–∫–æ–∂ –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–∏–π **Ajax Delete —à–∞–±–ª–æ–Ω** —ñ–∑ `confirm()` —ñ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º —ñ—Å—Ç–æ—Ä—ñ—ó —É `EXTERNAL_PERSONAL_HISTORY` (—á–µ—Ä–µ–∑ —Ç–æ–π —Å–∞–º–∏–π —Ç—Ä–∏–≥–µ—Ä)?
