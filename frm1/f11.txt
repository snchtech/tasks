–î—É–∂–µ –¥–æ–±—Ä–µ üëå
–¢–∏ —Ö–æ—á–µ—à —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ **–¥—Ä—É–≥–∏–π –∑–≤—ñ—Ç** ‚Äî –¥–µ—Ç–∞–ª—ñ–∑–∞—Ü—ñ—é –ø–æ **–ø—ñ–¥—Ä–æ–∑–¥—ñ–ª–∞—Ö (units)**, –¥–µ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—É –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è —Å–ø–∏—Å–æ–∫ –≤–∏–∫–æ–Ω–∞–≤—Ü—ñ–≤, –∑–≥—Ä—É–ø–æ–≤–∞–Ω–∏–π –∑–∞ —Ç–∏–ø–∞–º–∏ –∫–æ–º–ø–∞–Ω—ñ–π, —ñ –ø—ñ–¥—Å—É–º–∫–æ–≤–∏–π —Ä—è–¥–æ–∫ **¬´–í—Å—å–æ–≥–æ¬ª** –ø–æ –∫–æ–∂–Ω–æ–º—É –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—É.

---

## üîπ –ö–æ–Ω—Ü–µ–ø—Ü—ñ—è –∑–≤—ñ—Ç—É ‚Ññ2 ‚Äî ‚Äú–°—É–º–∞—Ä–Ω–æ –ø–æ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª–∞—Ö‚Äù

### üéØ –¶—ñ–ª—å:

–î–ª—è –≤–∏–±—Ä–∞–Ω–æ—ó –¥–∞—Ç–∏ (`P_REPORT_DATE`) —ñ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ñ–≤ (`P_REPORT_DEPARTMENTS`) –ø–æ–∫–∞–∑–∞—Ç–∏:

* —É –∫–æ–∂–Ω–æ–º—É **–ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—ñ** (`UNIT`) ‚Üí —Å–ø–∏—Å–æ–∫ –∫–æ–º–ø–∞–Ω—ñ–π (–≤–∏–∫–æ–Ω–∞–≤—Ü—ñ–≤),
* –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è –∫–æ–º–ø–∞–Ω—ñ–π –∑–∞ **COMPANY_TYPE**,
* –ø—ñ–¥—Å—É–º–æ–∫ (‚Äú–í—Å—å–æ–≥–æ‚Äù) –ø–æ –∫–æ–∂–Ω–æ–º—É –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—É.

---

## üîπ SQL (–≥–æ—Ç–æ–≤–∏–π –¥–ª—è Interactive Report –∞–±–æ Classic Report)

### ‚úÖ –í–∞—Ä—ñ–∞–Ω—Ç —ñ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º `ROLLUP` (—Å–ø—Ä–æ—â–µ–Ω–∏–π —ñ —à–≤–∏–¥–∫–∏–π)

```sql
SELECT 
    u.name AS unit_name,
    ct.name AS company_type_name,
    CASE 
        WHEN GROUPING(c.name) = 1 THEN '–í—Å—å–æ–≥–æ'
        ELSE c.name
    END AS company_name,
    SUM(ep.people_count) AS total_people
FROM 
    external_personal ep
JOIN company c       ON c.id = ep.company_id
JOIN company_type ct ON ct.id = c.company_type_id
JOIN units u         ON u.id = ep.unit_id
WHERE 
    TRUNC(ep.date_create) = TRUNC(:P_REPORT_DATE)
    AND ep.department_id IN (
        SELECT TO_NUMBER(column_value)
        FROM TABLE(apex_string.split(:P_REPORT_DEPARTMENTS, ':'))
    )
    AND ep.date_end IS NULL
GROUP BY 
    ROLLUP(u.name, ct.name, c.name)
HAVING 
    -- –≤—ñ–¥–∫–∏–¥–∞—î–º–æ "Total" —É—Å—å–æ–≥–æ –ø–æ –≤—Å—ñ–π —Ç–∞–±–ª–∏—Ü—ñ
    NOT (GROUPING(u.name) = 1 AND GROUPING(ct.name) = 1)
ORDER BY 
    u.name,
    ct.name,
    company_name;
```

---

### üß† –ü–æ—è—Å–Ω–µ–Ω–Ω—è:

* `ROLLUP(u.name, ct.name, c.name)` –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä—é—î:

  * –∑–≤–∏—á–∞–π–Ω—ñ —Ä—è–¥–∫–∏ (unit ‚Üí company type ‚Üí company),
  * –ø—ñ–¥—Å—É–º–æ–∫ ‚Äú–í—Å—å–æ–≥–æ‚Äù –ø–æ –∫–æ–∂–Ω–æ–º—É **–ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—É** (`GROUPING(c.name)=1`),
  * –∞–ª–µ –º–∏ **—Ñ—ñ–ª—å—Ç—Ä—É—î–º–æ** –∑–∞–≥–∞–ª—å–Ω–∏–π –ø—ñ–¥—Å—É–º–æ–∫ –ø–æ –≤—Å—ñ—Ö –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª–∞—Ö (`HAVING`).

* `CASE WHEN GROUPING(c.name)=1 THEN '–í—Å—å–æ–≥–æ'` ‚Äî –∑–∞–º—ñ–Ω—é—î NULL –Ω–∞ —Å–ª–æ–≤–æ "–í—Å—å–æ–≥–æ".

---

### üìä –†–µ–∑—É–ª—å—Ç–∞—Ç —É –∑–≤—ñ—Ç—ñ

```
–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª: –ö–∏—ó–≤—Å—å–∫–∏–π –æ—Ñ—ñ—Å
-----------------------------------------------------
–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å          | –ü—ñ–¥—Ä–æ–∑–¥—ñ–ª       | –ö-—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—É
-----------------------------------------------------
[–î–µ—Ä–∂. –∫–æ–º–ø–∞–Ω—ñ—ó]
   –£–∫—Ä–ø–æ—à—Ç–∞         | –ö–∏—ó–≤—Å—å–∫–∏–π –æ—Ñ—ñ—Å  |  12
   –£–∫—Ä–∑–∞–ª—ñ–∑–Ω–∏—Ü—è     | –ö–∏—ó–≤—Å—å–∫–∏–π –æ—Ñ—ñ—Å  |  8
[–ü—Ä–∏–≤–∞—Ç–Ω—ñ –∫–æ–º–ø–∞–Ω—ñ—ó]
   –ù–æ–≤–∞ –ø–æ—à—Ç–∞       | –ö–∏—ó–≤—Å—å–∫–∏–π –æ—Ñ—ñ—Å  |  10
   SoftServe        | –ö–∏—ó–≤—Å—å–∫–∏–π –æ—Ñ—ñ—Å  |  5
-----------------------------------------------------
–í—Å—å–æ–≥–æ              | –ö–∏—ó–≤—Å—å–∫–∏–π –æ—Ñ—ñ—Å  |  35

–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª: –õ—å–≤—ñ–≤—Å—å–∫–∏–π –æ—Ñ—ñ—Å
-----------------------------------------------------
[–î–µ—Ä–∂. –∫–æ–º–ø–∞–Ω—ñ—ó]
   –£–∫—Ä–ø–æ—à—Ç–∞         | –õ—å–≤—ñ–≤—Å—å–∫–∏–π –æ—Ñ—ñ—Å |  9
   –£–∫—Ä–∑–∞–ª—ñ–∑–Ω–∏—Ü—è     | –õ—å–≤—ñ–≤—Å—å–∫–∏–π –æ—Ñ—ñ—Å |  6
[–ü—Ä–∏–≤–∞—Ç–Ω—ñ –∫–æ–º–ø–∞–Ω—ñ—ó]
   –ù–æ–≤–∞ –ø–æ—à—Ç–∞       | –õ—å–≤—ñ–≤—Å—å–∫–∏–π –æ—Ñ—ñ—Å |  7
   SoftServe        | –õ—å–≤—ñ–≤—Å—å–∫–∏–π –æ—Ñ—ñ—Å |  4
-----------------------------------------------------
–í—Å—å–æ–≥–æ              | –õ—å–≤—ñ–≤—Å—å–∫–∏–π –æ—Ñ—ñ—Å |  26
```

---

## üîπ –Ø–∫ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –≤ Oracle APEX

### **1Ô∏è‚É£ Region: ‚Äú–ó–≤—ñ—Ç 2 ‚Äî –ø–æ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª–∞—Ö‚Äù**

* –¢–∏–ø: **Interactive Report** (–∞–±–æ Classic Report, —è–∫—â–æ —Ö–æ—á–µ—à –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è–º).
* SQL Source: –∫–æ–¥ –≤–∏—â–µ.
* –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è:

  * Primary Group ‚Üí `UNIT_NAME`
  * Secondary Group ‚Üí `COMPANY_TYPE_NAME`

---

### **2Ô∏è‚É£ –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø—ñ–¥—Å—É–º–∫–æ–≤–æ–≥–æ —Ä—è–¥–∫–∞ ‚Äú–í—Å—å–æ–≥–æ‚Äù**

–©–æ–± —Ä—è–¥–æ–∫ –≤–∏–≥–ª—è–¥–∞–≤ —è–∫ –ø—ñ–¥—Å—É–º–∫–æ–≤–∏–π:

* –£ `Interactive Report` ‚Üí **Highlight ‚Üí Condition**
  Condition:

  ```sql
  COMPANY_NAME = '–í—Å—å–æ–≥–æ'
  ```

  Style:

  ```css
  background-color: #d4edda !important;
  font-weight: bold;
  color: #155724 !important;
  ```

---

### **3Ô∏è‚É£ –î–∏–Ω–∞–º—ñ—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è**

–¢–æ–π —Å–∞–º–∏–π Dynamic Action, —â–æ —ñ –¥–ª—è –ø–µ—Ä—à–æ–≥–æ –∑–≤—ñ—Ç—É:

* On Change ‚Üí `P_REPORT_DATE` –∞–±–æ `P_REPORT_DEPARTMENTS`
  ‚Üí Action: **Refresh Region [Report_2]**

---

## üîπ –Ø–∫—â–æ —Ö–æ—á–µ—à —â–µ –∫—Ä–∞—â—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É

–î–ª—è –ø—ñ–¥—Å—É–º–∫–æ–≤–æ–≥–æ —Ä—è–¥–∫–∞ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ UNION (—è–∫ —É –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É VIEW), —â–æ–± —á—ñ—Ç–∫–æ –≤—ñ–¥–æ–∫—Ä–µ–º–∏—Ç–∏ ‚Äú–í—Å—å–æ–≥–æ‚Äù –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ `unit_name` ‚Äî —Ü–µ –¥–∞—î –±—ñ–ª—å—à–µ –≥–Ω—É—á–∫–æ—Å—Ç—ñ –≤ —Å—Ç–∏–ª—è—Ö, –∞–ª–µ ROLLUP –∑—Ä—É—á–Ω—ñ—à–∏–π —ñ –ø—Ä–æ—Å—Ç—ñ—à–∏–π.

---

–•–æ—á–µ—à, —è –ø—ñ–¥–≥–æ—Ç—É—é **–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π SQL** —ñ–∑ `UNION ALL` ‚Äî –¥–µ ‚Äú–í—Å—å–æ–≥–æ‚Äù –±—É–¥–µ —Å—Ç–≤–æ—Ä–µ–Ω–æ —è–≤–Ω–æ, —â–æ –¥–æ–∑–≤–æ–ª–∏—Ç—å –ª–µ–≥–∫–æ —Ä–æ–∑—Ñ–∞—Ä–±–æ–≤—É–≤–∞—Ç–∏ –π –∫–µ—Ä—É–≤–∞—Ç–∏ –ø–æ—Ä—è–¥–∫–æ–º —É Classic Report (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —á–µ—Ä–µ–∑ IS_TOTAL)?
