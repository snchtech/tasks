–î—É–∂–µ —á—ñ—Ç–∫–æ —Å—Ñ–æ—Ä–º—É–ª—å–æ–≤–∞–Ω–æ üí™
–û—Ç–∂–µ, –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ **–¥–≤–∞ SQL-–∑–∞–ø–∏—Ç–∏** –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ç–∞–±–ª–∏—Ü—ñ `EXTERNAL_PERSONAL`:

1Ô∏è‚É£ ‚Äî —Ä–∞—Ö—É—î **–∫—ñ–ª—å–∫—ñ—Å—Ç—å —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –∫–æ–º–ø–∞–Ω—ñ–π** –Ω–∞ –ø–æ—Ç–æ—á–Ω–∏–π –¥–µ–Ω—å.
2Ô∏è‚É£ ‚Äî —Ä–∞—Ö—É—î **–∑–∞–≥–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—É** (—Å—É–º—É `PEOPLE_COUNT`) –Ω–∞ –ø–æ—Ç–æ—á–Ω–∏–π –¥–µ–Ω—å.

–Ü –æ–±–∏–¥–≤–∞ –ø–æ–≤–∏–Ω–Ω—ñ –≤—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ —É–º–æ–≤–∏ –Ω–∞ `P_CUR_DEPARTMENTS` —Ç–∞ `P_CUR_UNIT`:

* —è–∫—â–æ `P_CUR_DEPARTMENTS` –∞–±–æ `P_CUR_UNIT` = NULL ‚Üí –Ω–µ —Ñ—ñ–ª—å—Ç—Ä—É—î–º–æ;
* —è–∫—â–æ –≤–æ–Ω–∏ –º–∞—é—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è ‚Üí –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —è–∫ —Ñ—ñ–ª—å—Ç—Ä.

---

## üîπ 1Ô∏è‚É£ –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ–º–ø–∞–Ω—ñ–π –Ω–∞ –ø–æ—Ç–æ—á–Ω–∏–π –¥–µ–Ω—å

```sql
SELECT COUNT(DISTINCT ep.company_id) AS company_count
FROM external_personal ep
WHERE TRUNC(ep.date_create) = TRUNC(SYSDATE)
  AND ep.date_end IS NULL
  AND (
        :P_CUR_DEPARTMENTS IS NULL 
        OR ep.department_id IN (
            SELECT TO_NUMBER(column_value)
            FROM TABLE(apex_string.split(:P_CUR_DEPARTMENTS, ':'))
        )
      )
  AND (
        :P_CUR_UNIT IS NULL
        OR ep.unit_id IN (
            SELECT TO_NUMBER(column_value)
            FROM TABLE(apex_string.split(:P_CUR_UNIT, ':'))
        )
      );
```

---

## üîπ 2Ô∏è‚É£ –ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—É –Ω–∞ –ø–æ—Ç–æ—á–Ω–∏–π –¥–µ–Ω—å

```sql
SELECT NVL(SUM(ep.people_count), 0) AS total_people
FROM external_personal ep
WHERE TRUNC(ep.date_create) = TRUNC(SYSDATE)
  AND ep.date_end IS NULL
  AND (
        :P_CUR_DEPARTMENTS IS NULL 
        OR ep.department_id IN (
            SELECT TO_NUMBER(column_value)
            FROM TABLE(apex_string.split(:P_CUR_DEPARTMENTS, ':'))
        )
      )
  AND (
        :P_CUR_UNIT IS NULL
        OR ep.unit_id IN (
            SELECT TO_NUMBER(column_value)
            FROM TABLE(apex_string.split(:P_CUR_UNIT, ':'))
        )
      );
```

---

## üîπ üß† –ü–æ—è—Å–Ω–µ–Ω–Ω—è –ª–æ–≥—ñ–∫–∏

| –£–º–æ–≤–∞                                    | –î—ñ—è                                              |
| ---------------------------------------- | ------------------------------------------------ |
| `TRUNC(ep.date_create) = TRUNC(SYSDATE)` | –ª–∏—à–µ –∑–∞–ø–∏—Å–∏ –∑–∞ —Å—å–æ–≥–æ–¥–Ω—ñ                          |
| `ep.date_end IS NULL`                    | –∞–∫—Ç–∏–≤–Ω—ñ –∑–∞–ø–∏—Å–∏                                   |
| `:P_CUR_DEPARTMENTS IS NULL OR ...`      | —è–∫—â–æ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∏ –Ω–µ –≤–∏–±—Ä–∞–Ω—ñ ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ —É–º–æ–≤—É |
| `:P_CUR_UNIT IS NULL OR ...`             | —è–∫—â–æ unit –Ω–µ –≤–∏–±—Ä–∞–Ω–∏–π ‚Üí –Ω–µ —Ñ—ñ–ª—å—Ç—Ä—É—î–º–æ            |

---

## üîπ üîç –ü—Ä–∏–∫–ª–∞–¥–∏ —Ä–æ–±–æ—Ç–∏

| –í—Ö—ñ–¥–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏                                | –†–µ–∑—É–ª—å—Ç–∞—Ç                                            |
| ----------------------------------------------- | ---------------------------------------------------- |
| `P_CUR_DEPARTMENTS = NULL`, `P_CUR_UNIT = NULL` | –ü—ñ–¥—Ä–∞—Ö–æ–≤—É—é—Ç—å—Å—è **–≤—Å—ñ –∫–æ–º–ø–∞–Ω—ñ—ó** —Ç–∞ **–≤–µ—Å—å –ø–µ—Ä—Å–æ–Ω–∞–ª** |
| `P_CUR_DEPARTMENTS = 3:5`                       | –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –ª–∏—à–µ –ø–æ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞—Ö 3 —ñ 5               |
| `P_CUR_UNIT = 2`                                | –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –ª–∏—à–µ –ø–æ Unit = 2                          |
| `P_CUR_DEPARTMENTS = 3:5`, `P_CUR_UNIT = 2:4`   | –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –ø–æ –ø–µ—Ä–µ—Ç–∏–Ω—É —Ñ—ñ–ª—å—Ç—Ä—ñ–≤                      |

---

## üîπ üîß –Ø–∫ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤ APEX

* **–ü–µ—Ä—à–∏–π SQL** ‚Äî –¥–ª—è –∫–∞—Ä—Ç–∫–∏ ‚Äú–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ–º–ø–∞–Ω—ñ–π —Å—å–æ–≥–æ–¥–Ω—ñ‚Äù.
* **–î—Ä—É–≥–∏–π SQL** ‚Äî –¥–ª—è –∫–∞—Ä—Ç–∫–∏ ‚Äú–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—É —Å—å–æ–≥–æ–¥–Ω—ñ‚Äù.

–í –æ–±–æ—Ö **Source Type = SQL Query (returning single value)**,
—ñ —è–∫—â–æ —Ö–æ—á–µ—à —Ä–æ–±–∏—Ç–∏ –¥–∏–Ω–∞–º—ñ—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Ñ—ñ–ª—å—Ç—Ä—ñ–≤ ‚Äî –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–≤‚Äô—è–∂–∏ `P_CUR_DEPARTMENTS` —Ç–∞ `P_CUR_UNIT` —É –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ Region Source.

---

–•–æ—á–µ—à, —â–æ–± —è –ø–æ–∫–∞–∑–∞–≤, —è–∫ –∑—Ä–æ–±–∏—Ç–∏ —Ü—ñ –¥–≤–∞ SQL —è–∫ **—ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ñ –∫–∞—Ä—Ç–∫–∏** (Information Cards) —É –≤–∏–≥–ª—è–¥—ñ KPI-–≤—ñ–¥–∂–µ—Ç—ñ–≤ –Ω–∞ –ø–∞–Ω–µ–ª—ñ –∑–≤—ñ—Ç—É –≤ APEX?
