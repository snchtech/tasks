–î–æ–±—Ä–µ üëç, –æ—Å—å –≥–æ—Ç–æ–≤–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç, —è–∫–∏–π –∑–∞–≤–∂–¥–∏ –ø–æ–≤–µ—Ä—Ç–∞—î `DATE` —É `v_shift_start` —Ç–∞ `v_shift_end` ‚Äî –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–æ–≥–æ, –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–±—Ä–∞–≤ **–Ω–æ–º–µ—Ä –∑–º—ñ–Ω–∏** —á–∏ –≤–≤—ñ–≤ —á–∞—Å –≤—Ä—É—á–Ω—É:

```plsql
DECLARE
    v_shift_start DATE;
    v_shift_end   DATE;
BEGIN
    IF :P1_SHIFT_NUMBER IS NOT NULL THEN
        -- üîπ –Ø–∫—â–æ –≤–∏–±—Ä–∞–Ω–æ –Ω–æ–º–µ—Ä –∑–º—ñ–Ω–∏ ‚Üí –±–µ—Ä–µ–º–æ —á–∞—Å —ñ–∑ –¥–æ–≤—ñ–¥–Ω–∏–∫–∞
        SELECT TRUNC(SYSDATE) + (TIME_START - TRUNC(TIME_START)),
               CASE 
                   WHEN TIME_END < TIME_START 
                   THEN TRUNC(SYSDATE+1) + (TIME_END - TRUNC(TIME_END))
                   ELSE TRUNC(SYSDATE)   + (TIME_END - TRUNC(TIME_END))
               END
        INTO v_shift_start, v_shift_end
        FROM DEPARTMENT_SHIFT_NUMBER
        WHERE DEPARTMENT_ID   = :P0_DEPARTMENT_ID
          AND SHIFT_NUMBER_ID = :P1_SHIFT_NUMBER;

    ELSE
        -- üîπ –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∫–∞–∑–∞–≤ —á–∞—Å –≤—Ä—É—á–Ω—É (—Ñ–æ—Ä–º–∞—Ç hh24:mi)
        v_shift_start := TRUNC(SYSDATE) 
                         + (TO_DATE(:P1_SHIFT_START, 'HH24:MI') - TRUNC(TO_DATE(:P1_SHIFT_START, 'HH24:MI')));

        v_shift_end   := TRUNC(SYSDATE) 
                         + (TO_DATE(:P1_SHIFT_END, 'HH24:MI') - TRUNC(TO_DATE(:P1_SHIFT_END, 'HH24:MI')));
    END IF;

    -- –ø—Ä–∏–∫–ª–∞–¥ –≤—Å—Ç–∞–≤–∫–∏ —É –ª–æ–≥
    INSERT INTO SHIFT_PERSONAL_LOGGER (
        TAB_NO,
        DEPARTMENT_ID,
        POSITION_ID,
        SHIFT_SYMBOL_ID,
        SHIFT_NUMBER_ID,
        TIME_START,
        TIME_END,
        SOURCE_APP,
        CREATED_BY
    ) VALUES (
        :P0_CUR_USER_TABNO,
        :P0_CUR_USER_DEPARTMENT,
        :P0_CUR_USER_POSITION,
        :P1_SHIFT_SYMBOL,
        :P1_SHIFT_NUMBER,
        v_shift_start,
        v_shift_end,
        :APP_ID,
        :APP_USER
    );
END;
```

---

## üîπ –©–æ —Ç—É—Ç –≤–∞–∂–ª–∏–≤–æ

1. **–Ø–∫—â–æ –≤–∏–±—Ä–∞–Ω–æ –Ω–æ–º–µ—Ä –∑–º—ñ–Ω–∏** ‚Üí —á–∞—Å–∏ –±–µ—Ä—É—Ç—å—Å—è –∑ –¥–æ–≤—ñ–¥–Ω–∏–∫–∞ `DEPARTMENT_SHIFT_NUMBER`, —ñ –≤—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è –∫–µ–π—Å, –∫–æ–ª–∏ –∑–º—ñ–Ω–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ –ø—ñ–≤–Ω—ñ—á.
2. **–Ø–∫—â–æ —á–∞—Å –≤–≤–µ–¥–µ–Ω–æ –≤—Ä—É—á–Ω—É** ‚Üí —á–∞—Å–∏ –∫–æ–Ω–≤–µ—Ä—Ç—É—é—Ç—å—Å—è —É —Ñ–æ—Ä–º–∞—Ç `DATE` –ø–æ—Ç–æ—á–Ω–æ–≥–æ –¥–Ω—è.
3. –ù–∞ –≤–∏—Ö–æ–¥—ñ –∑–∞–≤–∂–¥–∏ –º–∞—î–º–æ –≥–æ—Ç–æ–≤—ñ `DATE` ‚Üí —ó—Ö –º–æ–∂–Ω–∞ –ø—Ä—è–º–æ –≤—Å—Ç–∞–≤–ª—è—Ç–∏ —É `SHIFT_PERSONAL_LOGGER`.

---

–•–æ—á–µ—Ç–µ, —è —â–µ –ø—ñ–¥–∫–∞–∂—É, —è–∫ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ —É —Ü—å–æ–º—É –∫–æ–¥—ñ, —â–æ `P1_SHIFT_START < P1_SHIFT_END`, —ñ–Ω–∞–∫—à–µ –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É –ø–æ–º–∏–ª–∫—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–æ–ª–∏ –≤—ñ–Ω –≤–∏–ø–∞–¥–∫–æ–≤–æ –≤–∏–±—Ä–∞–≤ "23:00 ‚Äì 08:00")?
