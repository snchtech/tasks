–î—É–∂–µ –ø—Ä–æ—Å—Ç–æ ‚úÖ ‚Äî –¥–æ—Å—Ç–∞—Ç–Ω—å–æ **–¥–æ–¥–∞—Ç–∏ —É–º–æ–≤—É —É WHERE-–±–ª–æ–∫** –≤–∞—à–æ–≥–æ SQL-–∑–∞–ø–∏—Ç—É.
–û—Å—å –æ–Ω–æ–≤–ª–µ–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç:

```sql
SELECT 
    t.id,
    t.user_id,
    u.user_name,
    u.department_name,
    tt.code AS tag_type_name,
    t.tag_code,
    t.created_at
FROM user_tag t
JOIN users u 
    ON u.user_id = t.user_id
JOIN tag_type_lu tt 
    ON tt.id = t.tag_type_id
WHERE t.date_end IS NULL
  AND u.department_id = 11   -- ‚úÖ –≤–∏–±—ñ—Ä–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ü–µ—Ö—É
ORDER BY t.created_at DESC;
```

---

## üîπ –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ —Ü—é —É–º–æ–≤—É –¥–∏–Ω–∞–º—ñ—á–Ω–æ—é

–¢–æ–±—Ç–æ, —â–æ–± –º–æ–∂–Ω–∞ –±—É–ª–æ **—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –∑–∞ —Ü–µ—Ö–æ–º (department)** –∑ –µ–ª–µ–º–µ–Ω—Ç–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `PXX_DEPARTMENT_ID`):

```sql
WHERE t.date_end IS NULL
  AND ( :PXX_DEPARTMENT_ID IS NULL OR u.department_id = :PXX_DEPARTMENT_ID )
ORDER BY t.created_at DESC;
```

–¢–æ–¥—ñ:

* —Å—Ç–≤–æ—Ä—ñ—Ç—å –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ **Select List** `PXX_DEPARTMENT_ID`
  (LOV: `SELECT department_name d, department_id r FROM departments ORDER BY department_name`)
* –¥–æ–¥–∞–π—Ç–µ **Dynamic Action**:

  * **Event:** Change
  * **Action:** Refresh Region (IR region)

–¶–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å –∑–º—ñ–Ω—é–≤–∞—Ç–∏ —Ü–µ—Ö —ñ –º–∏—Ç—Ç—î–≤–æ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –∑–≤—ñ—Ç –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏.

---

üîπ –û—Ç–∂–µ, –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –∑–∞–¥–∞—á—ñ:

* –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ **—Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ** –ø–æ–∫–∞–∑–∞—Ç–∏ –ª–∏—à–µ —Ü–µ—Ö ‚Ññ11 ‚Üí –¥–æ–¥–∞—î–º–æ `AND u.department_id = 11`
* –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ **–¥–∏–Ω–∞–º—ñ—á–Ω–æ** —Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ ‚Üí –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ `:PXX_DEPARTMENT_ID` —ñ Refresh Region

–•–æ—á–µ—Ç–µ, —è –ø–æ–∫–∞–∂—É, —è–∫ —Å–∞–º–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä-select –¥–ª—è —Ü–µ—Ö—ñ–≤ —ñ–∑ –∞–≤—Ç–æ–ø—ñ–¥—Å—Ç–∞–Ω–æ–≤–∫–æ—é —É –≤–∞—à IR?


‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî

–û–∫–µ–π, —Ü–µ —è–∫—Ä–∞–∑ —Ç–æ–π –≤–∏–ø–∞–¥–æ–∫, –¥–µ –≤–∞—Ä—Ç–æ ‚Äú–Ω–æ—Ä–º–∞–ª—ñ–∑—É–≤–∞—Ç–∏‚Äù –≤—Å–µ –≤ –æ–¥–Ω–æ–º—É –º—ñ—Å—Ü—ñ üí≥

–¢–≤–æ—ó –≤–∏–º–æ–≥–∏:

* —É –ë–î **–∑–±–µ—Ä—ñ–≥–∞—î–º–æ —Ç—ñ–ª—å–∫–∏ –¥–µ—Å—è—Ç–∫–æ–≤–∏–π –∫–æ–¥**;
* –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ –≤—Å—Ç–∞–≤–∏—Ç–∏:

  * –≤–∂–µ **–¥–µ—Å—è—Ç–∫–æ–≤–∏–π** –∫–æ–¥;
  * –∞–±–æ **HEX** (–∑ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ Android: `04:A3:BC:1F:2D:90:80` —Ç–æ—â–æ);
* —Å–∏—Å—Ç–µ–º–∞ —Å–∞–º–∞:

  * –ø—Ä–∏–±–∏—Ä–∞—î —Ä–æ–∑–¥—ñ–ª—å–Ω–∏–∫–∏ (`:`, `-`, –ø—Ä–æ–±—ñ–ª–∏);
  * –≤–∏–∑–Ω–∞—á–∞—î, —Ü–µ **–¥–µ—Å—è—Ç–∫–æ–≤–µ** —á–∏ **—à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–µ**;
  * –ø—Ä–∏ –ø–æ—Ç—Ä–µ–±—ñ ‚Äî **–∫–æ–Ω–≤–µ—Ä—Ç—É—î HEX ‚Üí DEC**;
  * —É —Ä–∞–∑—ñ –ø–æ–º–∏–ª–∫–∏ ‚Äî –¥–∞—î –∑—Ä–æ–∑—É–º—ñ–ª–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.

---

## 1. PL/SQL-—Ñ—É–Ω–∫—Ü—ñ—è –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—ó (HEX ‚Üí DEC –∞–±–æ –≤–∂–µ DEC)

–ü—Ä–æ–ø–æ–Ω—É—é –∑—Ä–æ–±–∏—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é –≤ –ø–∞–∫–µ—Ç—ñ (–∞–±–æ –æ–∫—Ä–µ–º—É):

```plsql
CREATE OR REPLACE FUNCTION normalize_tag_code (p_raw IN VARCHAR2)
  RETURN VARCHAR2
IS
  v_clean VARCHAR2(128);
  v_num   NUMBER;
BEGIN
  IF p_raw IS NULL THEN
    RETURN NULL;
  END IF;

  -- 1. –ü—Ä–∏–±–∏—Ä–∞—î–º–æ –∑–∞–π–≤—ñ —Å–∏–º–≤–æ–ª–∏: –ø—Ä–æ–±—ñ–ª–∏, –¥–≤–æ–∫—Ä–∞–ø–∫–∏, –¥–µ—Ñ—ñ—Å–∏ —Ç–æ—â–æ
  v_clean := REGEXP_REPLACE(UPPER(TRIM(p_raw)), '[^0-9A-F]', '');

  IF v_clean IS NULL THEN
    RAISE_APPLICATION_ERROR(-20001, '–ö–æ–¥ –º—ñ—Ç–∫–∏ –ø–æ—Ä–æ–∂–Ω—ñ–π –∞–±–æ –º—ñ—Å—Ç–∏—Ç—å –ª–∏—à–µ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω—ñ —Å–∏–º–≤–æ–ª–∏.');
  END IF;

  -- 2. –Ø–∫—â–æ —Ç—ñ–ª—å–∫–∏ —Ü–∏—Ñ—Ä–∏ -> –≤–≤–∞–∂–∞—î–º–æ, —â–æ —Ü–µ –≤–∂–µ –¥–µ—Å—è—Ç–∫–æ–≤–∏–π –∫–æ–¥
  IF REGEXP_LIKE(v_clean, '^[0-9]+$') THEN
    -- –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∫–æ–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥—ñ–∞–ø–∞–∑–æ–Ω, —è–∫—â–æ —Ç—Ä–µ–±–∞
    RETURN TO_CHAR(TO_NUMBER(v_clean));
  
  -- 3. –Ø–∫—â–æ —Ü–∏—Ñ—Ä–∏ + A‚ÄìF -> —Ü–µ HEX, –∫–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ –≤ DEC
  ELSIF REGEXP_LIKE(v_clean, '^[0-9A-F]+$') THEN
    v_num := TO_NUMBER(v_clean, 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');
    RETURN TO_CHAR(v_num);
  
  -- 4. –Ø–∫—â–æ –∑–º—ñ—à–∞–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç ‚Äî –ø–æ–º–∏–ª–∫–∞
  ELSE
    RAISE_APPLICATION_ERROR(-20002, '–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –∫–æ–¥—É –º—ñ—Ç–∫–∏ (–¥–æ–∑–≤–æ–ª–µ–Ω—ñ —Ç—ñ–ª—å–∫–∏ —Ü–∏—Ñ—Ä–∏ –∞–±–æ HEX-—Å–∏–º–≤–æ–ª–∏ 0‚Äì9, A‚ÄìF).');
  END IF;
END normalize_tag_code;
/
```

–ü–æ—è—Å–Ω–µ–Ω–Ω—è –ª–æ–≥—ñ–∫–∏:

* `REGEXP_REPLACE(..., '[^0-9A-F]', '')` ‚Äî –ø—Ä–∏–±–∏—Ä–∞—î–º–æ **–≤—Å–µ, –∫—Ä—ñ–º 0‚Äì9 —Ç–∞ A‚ÄìF**, —Ç–æ–±—Ç–æ:

  * `04:A3:BC:1F` ‚Üí `04A3BC1F`
  * `04-A3-BC-1F` ‚Üí `04A3BC1F`
* `^[0-9]+$` ‚Üí —á–∏—Å—Ç–æ –¥–µ—Å—è—Ç–∫–æ–≤—ñ —Ü–∏—Ñ—Ä–∏.
* `^[0-9A-F]+$` ‚Üí HEX (—è–∫—â–æ —î –ª—ñ—Ç–µ—Ä–∏ A‚ÄìF).
* `TO_NUMBER(v_clean, 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX')` ‚Äî –±–µ–∑–ø–µ—á–Ω–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è HEX ‚Üí NUMBER (–¥–æ 32 –Ω—ñ–±–ª—ñ–≤, —Ç–æ–±—Ç–æ –¥–æ–≤–æ–ª—ñ –≤–µ–ª–∏–∫–∏–π –∫–æ–¥; –¥–ª—è NFC UID/ID –∑ –≥–æ–ª–æ–≤–æ—é –≤–∏—Å—Ç–∞—á–∞—î).

---

## 2. –Ø–∫ –æ—Ä–≥–∞–Ω—ñ–∑—É–≤–∞—Ç–∏ —Ä–æ–±–æ—Ç—É –Ω–∞ —Ñ–æ—Ä–º—ñ –≤ APEX

### –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –Ω–∞ —Ñ–æ—Ä–º—ñ

–ù–∞ –º–æ–¥–∞–ª—å–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∑–≤‚Äô—è–∑–∫—É –ø—Ä–æ–ø–æ–Ω—É—é —Ç–∞–∫—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

1. `PYY_USER_ID` ‚Äì Popup LOV (—è–∫ —Ç–∏ –ø–ª–∞–Ω—É–≤–∞–ª–∞).
2. `PYY_TAG_CODE_INPUT` ‚Äì —Ç–µ–∫—Å—Ç–æ–≤–µ –ø–æ–ª–µ, **–∫—É–¥–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –≤—Å—Ç–∞–≤–ª—è—î –±—É–¥—å-—è–∫–∏–π —Ñ–æ—Ä–º–∞—Ç** (–¥–µ—Üimal / hex / –∑ –¥–≤–æ–∫—Ä–∞–ø–∫–∞–º–∏).
3. `PYY_TAG_CODE` ‚Äì **–ø—Ä–∏—Ö–æ–≤–∞–Ω–µ** –∞–±–æ **Display Only** –ø–æ–ª–µ, —è–∫–µ –≤–∂–µ –º—ñ—Å—Ç–∏—Ç–∏–º–µ **—á–∏—Å—Ç–∏–π –¥–µ—Å—è—Ç–∫–æ–≤–∏–π –∫–æ–¥** –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ `USER_TAG.TAG_CODE`.
4. `PYY_TAG_TYPE_ID` ‚Äì Select List —ñ–∑ `TAG_TYPE_LU`.

---

### –í–∞—Ä—ñ–∞–Ω—Ç –ê: –ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è ‚Äú–Ω–∞ –ª—å–æ—Ç—É‚Äù (–ø—Ä–∏ –∑–º—ñ–Ω—ñ –ø–æ–ª—è)

UX-–≤–∞—Ä—ñ–∞–Ω—Ç –¥–ª—è –∞–¥–º—ñ–Ω–∞ –Ω–∞–π–∑—Ä—É—á–Ω—ñ—à–∏–π:
–≤—ñ–Ω —â–æ—Å—å –≤—Å—Ç–∞–≤–∏–≤ ‚Üí –æ–¥—Ä–∞–∑—É –±–∞—á–∏—Ç—å, —è–∫–∏–π –¥–µ—Å—è—Ç–∫–æ–≤–∏–π –∫–æ–¥ –≤–∏–π—à–æ–≤.

#### –ö—Ä–æ–∫–∏:

1. **Item** `PYY_TAG_CODE_INPUT`

   * Label: ‚Äú–ö–æ–¥ –º—ñ—Ç–∫–∏ (–º–æ–∂–Ω–∞ –≤—Å—Ç–∞–≤–ª—è—Ç–∏ HEX / Android-—Ñ–æ—Ä–º–∞—Ç)‚Äù

2. **Item** `PYY_TAG_CODE`

   * Type: Display Only (–∞–±–æ Text Field Read Only)
   * Label: ‚Äú–î–µ—Å—è—Ç–∫–æ–≤–∏–π –∫–æ–¥ –º—ñ—Ç–∫–∏‚Äù

3. –î–æ–¥–∞—î–º–æ **Dynamic Action**:

   * **Event:** Change
   * **Selection Type:** Item(s)
   * **Item:** `PYY_TAG_CODE_INPUT`

#### True Action 1: Execute PL/SQL Code (Set Value)

* **Action:** Set Value
* **Set Type:** PL/SQL Function Body
* **PL/SQL Function Body:**

  ```plsql
  RETURN normalize_tag_code(:PYY_TAG_CODE_INPUT);
  ```
* **Affected Items:** `PYY_TAG_CODE`
* **Items to Submit:** `PYY_TAG_CODE_INPUT`
* **Fire on Initialization:** No

–Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î:

* –∞–¥–º—ñ–Ω –≤—Å—Ç–∞–≤–∏–≤ `04:A3:BC:1F:2D:90:80`
* DA –≤–∏–∫–ª–∏–∫–∞—î `normalize_tag_code`
* —É `PYY_TAG_CODE` –∑‚Äô—è–≤–ª—è—î—Ç—å—Å—è, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `132456789012345`
* –¥–∞–ª—ñ —Å–∞–º–µ `PYY_TAG_CODE` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –≤ INSERT.

#### True Action 2 (–æ–ø—Ü—ñ–π–Ω–æ): Show Message –ø—Ä–∏ –ø–æ–º–∏–ª—Ü—ñ

–Ø–∫—â–æ —Ñ—É–Ω–∫—Ü—ñ—è –∫–∏–Ω–µ `RAISE_APPLICATION_ERROR`, APEX —Å–∞–º –ø–æ–∫–∞–∂–µ –ø–æ–º–∏–ª–∫—É.
–ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∫–æ–≤–æ –∑—Ä–æ–±–∏—Ç–∏ **Validation** –Ω–∞ Submit, —â–æ–± –Ω–µ –ø—Ä–æ–π—Ç–∏ –¥–∞–ª—ñ –±–µ–∑ –∫–æ—Ä–µ–∫—Ç–Ω–æ–≥–æ –∫–æ–¥—É.

---

### –í–∞—Ä—ñ–∞–Ω—Ç B: –ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç—ñ–ª—å–∫–∏ –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ ‚Äú–î–æ–¥–∞—Ç–∏ –∑–≤‚Äô—è–∑–æ–∫‚Äù

–Ø–∫—â–æ —Ö–æ—á–µ—à –º—ñ–Ω—ñ–º–∞–ª—ñ–∑–º: –æ–¥–∏–Ω item `PYY_TAG_CODE_INPUT`, –∞ –≤–∂–µ **–ø—Ä–æ—Ü–µ—Å** –ø–µ—Ä–µ–¥ INSERT:

#### Process ‚Äú–ü–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ—é‚Äù

```plsql
DECLARE
  v_dec_code VARCHAR2(128);
BEGIN
  v_dec_code := normalize_tag_code(:PYY_TAG_CODE_INPUT);

  INSERT INTO user_tag (user_id, tag_type_id, tag_code, created_at)
  VALUES (:PYY_USER_ID, :PYY_TAG_TYPE_ID, v_dec_code, SYSTIMESTAMP);
END;
```

* –í–∞–ª—ñ–¥–∞—Ü—ñ—è –Ω–∞ —Ç–µ, —â–æ `PYY_TAG_CODE_INPUT` –Ω–µ –ø–æ—Ä–æ–∂–Ω—î.

–ú—ñ–Ω—É—Å ‚Äî –∞–¥–º—ñ–Ω –Ω–µ –±–∞—á–∏—Ç—å, —É —â–æ —Ü–µ –∫–æ–Ω–≤–µ—Ä—Ç—É–≤–∞–ª–æ—Å—å, –∞–ª–µ –¥–ª—è –ø—Ä–æ—Å—Ç–∏—Ö –∫–µ–π—Å—ñ–≤ —Ü–µ –Ω–æ—Ä–º.

---

## 3. UX-–ø—ñ–¥–∫–∞–∑–∫–∏ –¥–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

–©–æ–± –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—É –±—É–ª–æ —Ä–µ–∞–ª—å–Ω–æ –∑—Ä—É—á–Ω–æ:

* –í –æ–ø–∏—Å—ñ –¥–æ `PYY_TAG_CODE_INPUT` –Ω–∞–ø–∏—Å–∞—Ç–∏:

  > –ú–æ–∂–Ω–∞ –≤—Å—Ç–∞–≤–ª—è—Ç–∏:
  >
  > * –∞–±–æ –≤–∂–µ –¥–µ—Å—è—Ç–∫–æ–≤–∏–π –∫–æ–¥ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `123456789`),
  > * –∞–±–æ HEX/Android —Ñ–æ—Ä–º–∞—Ç (`04:A3:BC:1F:2D:90:80` / `04A3BC1F2D9080`).
  >   –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç—å —É –¥–µ—Å—è—Ç–∫–æ–≤–∏–π —Ñ–æ—Ä–º–∞—Ç.

* –Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—à **–í–∞—Ä—ñ–∞–Ω—Ç –ê**:

  * –ø—ñ–¥ `PYY_TAG_CODE` –º–æ–∂–Ω–∞ –Ω–∞–ø–∏—Å–∞—Ç–∏ —Ç–µ–∫—Å—Ç:

    > –ó–±–µ—Ä–µ–∂–µ—Ç—å—Å—è —è–∫ –¥–µ—Å—è—Ç–∫–æ–≤–∏–π –∫–æ–¥: &PYY_TAG_CODE.

---

## 4. –í—Å—Ç–∞–≤–∫–∞ –≤ USER_TAG

–£ —Ñ—ñ–Ω–∞–ª—å–Ω–æ–º—É INSERT –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **–¥–µ—Å—è—Ç–∫–æ–≤–µ –ø–æ–ª–µ**:

```plsql
INSERT INTO user_tag (user_id, tag_type_id, tag_code, created_at)
VALUES (:PYY_USER_ID, :PYY_TAG_TYPE_ID, :PYY_TAG_CODE, SYSTIMESTAMP);
```

(–£ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ B ‚Äî –±–µ—Ä–µ—à `v_dec_code` —è–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤–∏—â–µ).

---

–Ø–∫—â–æ —Ö–æ—á–µ—à, –Ω–∞—Å—Ç—É–ø–Ω–∏–º –∫—Ä–æ–∫–æ–º –º–æ–∂—É:

* –ø—ñ–¥—ñ–≥–Ω–∞—Ç–∏ —Ü–µ–π –∫–æ–¥ –ø—ñ–¥ —Ç–≤—ñ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π `PYY`-–Ω–æ–º–µ—Ä —Å—Ç–æ—Ä—ñ–Ω–∫–∏,
* –¥–æ–¥–∞—Ç–∏ —Ç–µ–∫—Å—Ç –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó/–ø–æ–º–∏–ª–æ–∫ ‚Äú–ø–æ-–ª—é–¥—Å—å–∫–∏‚Äù (—Ç–∏–ø—É: ‚Äú–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, –±—É–¥—å –ª–∞—Å–∫–∞, —Ñ–æ—Ä–º–∞—Ç –∫–æ–¥—É –º—ñ—Ç–∫–∏. –î–æ–∑–≤–æ–ª–µ–Ω—ñ –¥–µ—Å—è—Ç–∫–æ–≤—ñ —á–∏—Å–ª–∞ –∞–±–æ HEX-—Ñ–æ—Ä–º–∞—Ç, —è–∫ —É Android-–∑—á–∏—Ç—É–≤–∞—á–∞—Ö‚Äù).


‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî

–û–∫–µ–π, —Ç–æ–¥—ñ –∑—Ä–æ–±–∏–º–æ —Ü–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ ‚Äú–ø—ñ–¥ –∫–ª—é—á‚Äù üëá

–Ø —É–º–æ–≤–Ω–æ –≤—ñ–∑—å–º—É **modal-—Å—Ç–æ—Ä—ñ–Ω–∫—É ‚Ññ210** –∑ —Ç–∞–∫–∏–º–∏ item‚Äô–∞–º–∏:

* `P210_USER_ID`
* `P210_TAG_CODE_INPUT`
* `P210_TAG_CODE`
* `P210_TAG_TYPE_ID`

–Ø–∫—â–æ –≤ —Ç–µ–±–µ —ñ–Ω—à—ñ –Ω–æ–º–µ—Ä–∏ —Å—Ç–æ—Ä—ñ–Ω–æ–∫ –∞–±–æ –Ω–∞–∑–≤–∏ item‚Äô—ñ–≤ ‚Äî –ø—Ä–æ—Å—Ç–æ –∑–∞–º—ñ–Ω–∏—à —ó—Ö 1:1.

---

## 1Ô∏è‚É£ –§—É–Ω–∫—Ü—ñ—è `normalize_tag_code` —É –ë–î

–°—Ç–≤–æ—Ä–∏ (–∞–±–æ –≤ –ø–∞–∫–µ—Ç—ñ, –∞–±–æ —è–∫ standalone-—Ñ—É–Ω–∫—Ü—ñ—é –≤ —Å—Ö–µ–º—ñ, –¥–µ –∂–∏–≤–µ APEX app):

```plsql
CREATE OR REPLACE FUNCTION normalize_tag_code (p_raw IN VARCHAR2)
  RETURN VARCHAR2
IS
  v_clean VARCHAR2(128);
  v_num   NUMBER;
BEGIN
  IF p_raw IS NULL THEN
    RETURN NULL;
  END IF;

  -- 1. –ü—Ä–∏–±–∏—Ä–∞—î–º–æ –ø—Ä–æ–±—ñ–ª–∏, –¥–≤–æ–∫—Ä–∞–ø–∫–∏, –¥–µ—Ñ—ñ—Å–∏ –π —É—Å–µ, —â–æ –Ω–µ 0-9/A-F
  v_clean := REGEXP_REPLACE(UPPER(TRIM(p_raw)), '[^0-9A-F]', '');

  IF v_clean IS NULL THEN
    RAISE_APPLICATION_ERROR(
      -20001, 
      '–ö–æ–¥ –º—ñ—Ç–∫–∏ –ø–æ—Ä–æ–∂–Ω—ñ–π –∞–±–æ –º—ñ—Å—Ç–∏—Ç—å –ª–∏—à–µ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω—ñ —Å–∏–º–≤–æ–ª–∏.'
    );
  END IF;

  -- 2. –Ø–∫—â–æ –ª–∏—à–µ —Ü–∏—Ñ—Ä–∏ -> —Ü–µ –≤–∂–µ –¥–µ—Å—è—Ç–∫–æ–≤–∏–π –∫–æ–¥
  IF REGEXP_LIKE(v_clean, '^[0-9]+$') THEN
    RETURN TO_CHAR(TO_NUMBER(v_clean));

  -- 3. –Ø–∫—â–æ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ HEX-—Å–∏–º–≤–æ–ª–∏ 0-9, A-F -> —Ü–µ HEX, –∫–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ –≤ DEC
  ELSIF REGEXP_LIKE(v_clean, '^[0-9A-F]+$') THEN
    v_num := TO_NUMBER(v_clean, 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');
    RETURN TO_CHAR(v_num);

  -- 4. –Ü–Ω–∞–∫—à–µ —Ñ–æ—Ä–º–∞—Ç –ø–æ–≥–∞–Ω–∏–π
  ELSE
    RAISE_APPLICATION_ERROR(
      -20002, 
      '–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –∫–æ–¥—É –º—ñ—Ç–∫–∏. –î–æ–∑–≤–æ–ª–µ–Ω—ñ –ª–∏—à–µ —Ü–∏—Ñ—Ä–∏ –∞–±–æ HEX (0‚Äì9, A‚ÄìF).'
    );
  END IF;
END normalize_tag_code;
/
```

üëâ –í–æ–Ω–∞:

* –ø—Ä–∏–π–º–∞—î –±—É–¥—å-—â–æ: `123456`, `04:A3:BC:1F`, `04-a3-bc-1f`;
* —á–∏—Å—Ç–∏—Ç—å –¥–æ `04A3BC1F`;
* —è–∫—â–æ —Ü–µ **digits only** ‚Üí –∑–∞–ª–∏—à–∞—î —è–∫ DEC;
* —è–∫—â–æ **HEX** ‚Üí —Ä–æ–±–∏—Ç—å `HEX ‚Üí NUMBER ‚Üí VARCHAR2`;
* –ø—Ä–∏ –ø–æ–º–∏–ª—Ü—ñ –¥–∞—î –Ω–æ—Ä–º–∞–ª—å–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ `RAISE_APPLICATION_ERROR`.

---

## 2Ô∏è‚É£ –ü–æ–ª—è –Ω–∞ modal-—Å—Ç–æ—Ä—ñ–Ω—Ü—ñ (‚Ññ210)

–ù–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ, –¥–µ –¥–æ–¥–∞—î—Ç—å—Å—è –∑–≤‚Äô—è–∑–æ–∫:

1. **`P210_USER_ID`**

   * Type: Popup LOV
   * LOV:

     ```sql
     SELECT user_name d, user_id r
     FROM users
     ORDER BY user_name
     ```

2. **`P210_TAG_TYPE_ID`**

   * Type: Select List
   * LOV:

     ```sql
     SELECT code d, id r
     FROM tag_type_lu
     ORDER BY code
     ```

3. **`P210_TAG_CODE_INPUT`**

   * Type: Text Field
   * Label: –Ω–∞–ø—Ä–∏–∫–ª–∞–¥,

     > –ö–æ–¥ –º—ñ—Ç–∫–∏ (–¥–µ—Å—è—Ç–∫–æ–≤–∏–π –∞–±–æ HEX / Android-—Ñ–æ—Ä–º–∞—Ç)
   * Help / Tooltip:

     > –ú–æ–∂–Ω–∞ –≤–≤–æ–¥–∏—Ç–∏:
     >
     > * –¥–µ—Å—è—Ç–∫–æ–≤–∏–π –∫–æ–¥ (–Ω–∞–ø—Ä.: `123456789`);
     > * –∞–±–æ HEX / Android —Ñ–æ—Ä–º–∞—Ç (`04:A3:BC:1F:2D:90:80`, `04A3BC1F2D9080`).
     >   –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç—å —É –¥–µ—Å—è—Ç–∫–æ–≤–∏–π —Ñ–æ—Ä–º–∞—Ç.

4. **`P210_TAG_CODE`**

   * Type: Display Only (–∞–±–æ Text Field, Read Only)
   * Label:

     > –î–µ—Å—è—Ç–∫–æ–≤–∏–π –∫–æ–¥ –º—ñ—Ç–∫–∏
   * –¶–µ —Ç–µ –∑–Ω–∞—á–µ–Ω–Ω—è, —è–∫–µ –ø—ñ–¥–µ–º–æ –≤—Å—Ç–∞–≤–ª—è—Ç–∏ –≤ `USER_TAG.TAG_CODE`.

---

## 3Ô∏è‚É£ Dynamic Action: –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–¥—É

–©–æ–± –∞–¥–º—ñ–Ω –æ–¥—Ä–∞–∑—É –±–∞—á–∏–≤, —É —â–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏–≤—Å—è –∫–æ–¥.

### DA: `DA_CONVERT_TAG_CODE`

* **Event:** Change
* **Selection Type:** Item(s)
* **Item(s):** `P210_TAG_CODE_INPUT`

#### True Action 1: Set Value

* **Action:** Set Value
* **Set Type:** PL/SQL Function Body
* **PL/SQL Function Body:**

  ```plsql
  RETURN normalize_tag_code(:P210_TAG_CODE_INPUT);
  ```
* **Affected Items:** `P210_TAG_CODE`
* **Items to Submit:** `P210_TAG_CODE_INPUT`
* **Fire on Initialization:** No

üëâ –†–µ–∑—É–ª—å—Ç–∞—Ç:

* –∞–¥–º—ñ–Ω –≤—Å—Ç–∞–≤–∏–≤ `04:A3:BC:1F` ‚Üí –ø—ñ—Å–ª—è –≤—Ç—Ä–∞—Ç–∏ —Ñ–æ–∫—É—Å—É `P210_TAG_CODE_INPUT`
* `P210_TAG_CODE` –∑–∞–ø–æ–≤–Ω—é—î—Ç—å—Å—è —á–∏–º–æ—Å—å —Ç–∏–ø—É `781273423` (–¥–µ—Å—è—Ç–∫–æ–≤–µ).

–Ø–∫—â–æ —Ñ–æ—Ä–º–∞—Ç –ø–æ–≥–∞–Ω–∏–π ‚Äî APEX –ø–æ–∫–∞–∂–µ –ø–æ–º–∏–ª–∫—É, —è–∫—É –º–∏ –∑–∞–¥–∞–ª–∏ –≤ `RAISE_APPLICATION_ERROR`.

---

## 4Ô∏è‚É£ –í–∞–ª—ñ–¥–∞—Ü—ñ—è –Ω–∞ —Ñ–æ—Ä–º—ñ

–©–æ–± –Ω–µ –∑–±–µ—Ä—ñ–≥—Ç–∏ –ø—É—Å—Ç–µ/–Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–µ:

### Validation 1: `VAL_TAG_CODE_NOT_NULL`

* **Type:** Item is NOT NULL
* **Item:** `P210_TAG_CODE_INPUT`
* **Associated Button:** `–î–æ–¥–∞—Ç–∏ –∑–≤‚Äô—è–∑–æ–∫` (–∫–Ω–æ–ø–∫–∞ submit)
* **Error Message:**

  > –í–∫–∞–∂—ñ—Ç—å, –±—É–¥—å –ª–∞—Å–∫–∞, –∫–æ–¥ –º—ñ—Ç–∫–∏.

–û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ ‚Äî –º–æ–∂–Ω–∞ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ `P210_TAG_CODE_INPUT`, –∞ —Å–∞–º–µ `P210_TAG_CODE`, –∞–ª–µ —Ç–æ–¥—ñ —Ç—Ä–µ–±–∞ —Å–ª—ñ–¥–∫—É–≤–∞—Ç–∏, —â–æ–± DA –≤—ñ–¥–ø—Ä–∞—Ü—é–≤–∞–≤.

---

## 5Ô∏è‚É£ –ü—Ä–æ—Ü–µ—Å –≤—Å—Ç–∞–≤–∫–∏ –≤ `USER_TAG`

–ù–∞–∑–≤–∞ –ø—Ä–æ—Ü–µ—Å—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `PRC_CREATE_USER_TAG`.

* **Process Point:** After Submit
* **Condition:** When Button Pressed = `–î–û–î–ê–¢–ò_–ó–í–Ø–ó–û–ö` (—Ç–≤–æ—è –Ω–∞–∑–≤–∞ –∫–Ω–æ–ø–∫–∏)
* **PL/SQL Code:**

```plsql
DECLARE
  v_dec_code VARCHAR2(128);
BEGIN
  -- –ù–∞ –≤—Å—è–∫ –≤–∏–ø–∞–¥–æ–∫ —â–µ —Ä–∞–∑ –Ω–æ—Ä–º–∞–ª—ñ–∑—É—î–º–æ,
  -- —â–æ–± –±—É—Ç–∏ –Ω–µ–∑–∞–ª–µ–∂–Ω–∏–º–∏ –≤—ñ–¥ DA (JS –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–º–∫–Ω–µ–Ω–∏–π)
  v_dec_code := normalize_tag_code(:P210_TAG_CODE_INPUT);

  INSERT INTO user_tag (user_id, tag_type_id, tag_code, created_at)
  VALUES (:P210_USER_ID, :P210_TAG_TYPE_ID, v_dec_code, SYSTIMESTAMP);

  -- –©–æ–± –ø–æ—Ç—ñ–º –ø–æ–∫–∞–∑–∞—Ç–∏ success message (—è–∫—â–æ —Ç—Ä–µ–±–∞ —á–µ—Ä–µ–∑ —Å—Ç–æ—Ä—ñ–Ω–∫—É)
  :P210_TAG_CODE := v_dec_code;
END;
```

> –¢—É—Ç —è —â–µ —Ä–∞–∑ –≤–∏–∫–ª–∏–∫–∞—é `normalize_tag_code` **–Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ**,
> –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ DA —É–∂–µ –∑—Ä–æ–±–∏–≤ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—é.
> –¶–µ ‚Äú—Å—Ç—Ä–∞—Ö–æ–≤–∫–∞‚Äù, —è–∫—â–æ –≤ –∫–æ–≥–æ—Å—å –±—É–¥–µ –≤–∏–º–∫–Ω–µ–Ω–∏–π JS.

---

## 6Ô∏è‚É£ –ü–æ–∫–∞–∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è + –∑–∞–∫—Ä–∏—Ç—Ç—è –¥—ñ–∞–ª–æ–≥—É

### Success Message

–£ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—è—Ö —Å—Ç–æ—Ä—ñ–Ω–∫–∏ (Processing ‚Üí Messages) –º–æ–∂–Ω–∞ –∑–∞–¥–∞—Ç–∏:

* **Success Message:**

  > –ó–≤‚Äô—è–∑–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á ‚Äì –º—ñ—Ç–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–æ.

–∞–±–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —á–µ—Ä–µ–∑:

```plsql
apex_application.g_print_success_message :=
    '–ó–≤‚Äô—è–∑–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á ‚Äì –º—ñ—Ç–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–æ.';
```

(–≤ –∫—ñ–Ω—Ü—ñ –ø—Ä–æ—Ü–µ—Å—É, —è–∫—â–æ —Ö–æ—á–µ—à —É—Å–µ —Å–∞–º–µ —Ç–∞–º —Ç—Ä–∏–º–∞—Ç–∏).

### –ó–∞–∫—Ä–∏—Ç—Ç—è –¥—ñ–∞–ª–æ–≥—É

–Ø–∫—â–æ —Ü–µ modal dialog-—Å—Ç–æ—Ä—ñ–Ω–∫–∞:

* Button ‚Äú–î–æ–¥–∞—Ç–∏ –∑–≤‚Äô—è–∑–æ–∫‚Äù –º–∞—î:

  * **Action:** Submit Page
* –ù–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ:

  * **Dialog ‚Üí Close Dialog** —É–≤—ñ–º–∫–Ω–µ–Ω–æ (APEX —Å–∞–º –∑–∞–∫—Ä–∏—î –¥—ñ–∞–ª–æ–≥ –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É).

–ù–∞ **–≥–æ–ª–æ–≤–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ** (–¥–µ Interactive Report):

* –î–æ–¥–∞–π **Dynamic Action**:

  * **Event:** Dialog Closed
  * **Selection Type:** Region
  * **Region:** —Ç–≤—ñ–π IR `User Tag List`
  * **True Action:** Refresh

–¢–∞–∫ IR –æ–Ω–æ–≤–∏—Ç—å—Å—è –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è –∑–∞–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª–∫–∏ –π —Ç–∏ –ø–æ–±–∞—á–∏—à –Ω–æ–≤–∏–π –∑–≤‚Äô—è–∑–æ–∫.

---

## 7Ô∏è‚É£ –ü—ñ–¥—Å—É–º–æ–∫, —â–æ –æ—Ç—Ä–∏–º–∞—î –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä UX-–æ–º

* –í—Å—Ç–∞–≤–ª—è—î:

  * `123456789` ‚Üí –æ–¥—Ä–∞–∑—É –∑–±–µ—Ä—ñ–≥–∞—î–º–æ —è–∫ `123456789`;
  * –∞–±–æ `04:A3:BC:1F:2D:90:80` ‚Üí –±–∞—á–∏—Ç—å –≤ –ø–æ–ª—ñ –Ω–∏–∂—á–µ –≤–∂–µ –¥–µ—Å—è—Ç–∫–æ–≤–∏–π –∫–æ–¥;
* –ü—Ä–∏ –ø–æ–º–∏–ª—Ü—ñ —Ñ–æ—Ä–º–∞—Ç—É –æ—Ç—Ä–∏–º—É—î –∑—Ä–æ–∑—É–º—ñ–ª–∏–π –º–µ—Å–µ–¥–∂:

  * *‚Äú–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –∫–æ–¥—É –º—ñ—Ç–∫–∏. –î–æ–∑–≤–æ–ª–µ–Ω—ñ –ª–∏—à–µ —Ü–∏—Ñ—Ä–∏ –∞–±–æ HEX (0‚Äì9, A‚ÄìF).‚Äù*
* –ù–∞—Ç–∏—Å–∫–∞—î **‚Äú–î–æ–¥–∞—Ç–∏ –∑–≤‚Äô—è–∑–æ–∫‚Äù** ‚Üí
  –∑–∞–ø–∏—Å –ª–µ—Ç–∏—Ç—å –≤ `USER_TAG` —É **–Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–æ–º—É –¥–µ—Å—è—Ç–∫–æ–≤–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ**,
  –¥—ñ–∞–ª–æ–≥ –∑–∞–∫—Ä–∏–≤–∞—î—Ç—å—Å—è, –∑–≤—ñ—Ç –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è, –≤–≥–æ—Ä—ñ ‚Äî –∑–µ–ª–µ–Ω–∏–π –º–µ—Å–µ–¥–∂:

> ‚úÖ –ó–≤‚Äô—è–∑–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á ‚Äì –º—ñ—Ç–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–æ.

---

–Ø–∫—â–æ —Ö–æ—á–µ—à, –Ω–∞—Å—Ç—É–ø–Ω–∏–º –∫—Ä–æ–∫–æ–º –º–æ–∂–µ–º–æ:

* –¥–æ–¥–∞—Ç–∏ **–ø–µ—Ä–µ–≤—ñ—Ä–∫—É –Ω–∞ –¥—É–±–ª—ñ–∫–∞—Ç–∏** (—â–æ–± –Ω–µ –ø—Ä–∏–≤‚Äô—è–∑–∞—Ç–∏ –æ–¥–∏–Ω —ñ —Ç–æ–π —Å–∞–º–∏–π DEC-–∫–æ–¥ –¥–≤—ñ—á—ñ),
* –∞–±–æ –∑—Ä–æ–±–∏—Ç–∏ ‚Äú—Ä–æ–∑—É–º–Ω–µ‚Äù –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç–∏–ø—É *‚Äú–¶—è –º—ñ—Ç–∫–∞ –≤–∂–µ –ø—Ä–∏–≤‚Äô—è–∑–∞–Ω–∞ –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ X‚Äù*.


‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî

–ö–ª–∞—Å, —Ç–æ–¥—ñ –¥–∞–≤–∞–π –æ–¥—Ä–∞–∑—É –∑—Ä–æ–±–∏–º–æ **–Ω–æ—Ä–º–∞–ª—å–Ω—É –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –Ω–∞ –¥—É–±–ª—ñ–∫–∞—Ç–∏** + –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—é –≤ –æ–¥–Ω–æ–º—É –º—ñ—Å—Ü—ñ, —â–æ–± –∞–¥–º—ñ–Ω –Ω–µ –º—É—á–∏–≤—Å—è.

–Ø –∑–∞–ø—Ä–æ–ø–æ–Ω—É—é —Ç–∞–∫–∏–π –ø—ñ–¥—Ö—ñ–¥:

* **normalize_tag_code** –º–∏ –≤–∂–µ —Å—Ç–≤–æ—Ä–∏–ª–∏ ‚Äì –≤–æ–Ω–∞:

  * —á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç;
  * –∫–æ–Ω–≤–µ—Ä—Ç—É—î HEX ‚Üí DEC;
  * –∫–∏–¥–∞—î –ø–æ–º–∏–ª–∫—É, —è–∫—â–æ —Ñ–æ—Ä–º–∞—Ç –∫—Ä–∏–≤–∏–π.
* –í APEX:

  * **Validation** –Ω–∞ –∫–Ω–æ–ø—Ü—ñ ‚Äú–î–æ–¥–∞—Ç–∏ –∑–≤‚Äô—è–∑–æ–∫‚Äù:

    * –Ω–æ—Ä–º–∞–ª—ñ–∑—É—î –∫–æ–¥;
    * –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ **–Ω–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∑–≤‚Äô—è–∑–∫—É –∑ —Ü—ñ—î—é –º—ñ—Ç–∫–æ—é**;
    * –ø–æ–≤–µ—Ä—Ç–∞—î –ª—é–¥–∏–Ω–æ–∑—Ä–æ–∑—É–º—ñ–ª–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —è–∫—â–æ –º—ñ—Ç–∫–∞ –≤–∂–µ –∑–∞–π–Ω—è—Ç–∞;
    * —è–∫—â–æ –≤—Å–µ –æ–∫ ‚Üí –ø–∏—à–µ –Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –∫–æ–¥ —É `P210_TAG_CODE`.
  * –ü—Ä–æ—Ü–µ—Å –≤—Å—Ç–∞–≤–∫–∏ –ø—Ä–æ—Å—Ç–æ –±–µ—Ä–µ `P210_TAG_CODE` —ñ –≤—Å—Ç–∞–≤–ª—è—î –≤ `USER_TAG`.

---

## 1Ô∏è‚É£ Validation: –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥—É–±–ª—ñ–∫–∞—Ç–∞ + –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è

**–¢–∏–ø –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó:**

* *PL/SQL Function (returning error text)*
  **–ù–∞–∑–≤–∞:** `VAL_TAG_CODE_UNIQUE`

**–ü—Ä–∏–≤‚Äô—è–∑–∫–∞ –¥–æ –∫–Ω–æ–ø–∫–∏:** `–î–æ–¥–∞—Ç–∏ –∑–≤'—è–∑–æ–∫`

**PL/SQL —Ç—ñ–ª–æ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó:**

```plsql
DECLARE
  v_dec_code        VARCHAR2(128);
  v_exist_user_id   users.user_id%TYPE;
  v_exist_user_name users.user_name%TYPE;
  v_exist_dept_name users.department_name%TYPE;
BEGIN
  -- 1. –ù–æ—Ä–º–∞–ª—ñ–∑—É—î–º–æ –∫–æ–¥ (–º–æ–∂–µ –∫–∏–Ω—É—Ç–∏ –ø–æ–º–∏–ª–∫—É, —è–∫—â–æ —Ñ–æ—Ä–º–∞—Ç –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π)
  v_dec_code := normalize_tag_code(:P210_TAG_CODE_INPUT);

  -- 2. –ó–∞–ø–∏—à–µ–º–æ –Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –∫–æ–¥ —É item, —â–æ–± –¥–∞–ª—ñ –Ω–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—å
  :P210_TAG_CODE := v_dec_code;

  -- 3. –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –≤–∂–µ —î –∞–∫—Ç–∏–≤–Ω–∏–π –∑–≤‚Äô—è–∑–æ–∫ –∑ —Ü—ñ—î—é –º—ñ—Ç–∫–æ—é
  BEGIN
    SELECT x.user_id,
           x.user_name,
           x.department_name
      INTO v_exist_user_id,
           v_exist_user_name,
           v_exist_dept_name
      FROM (
        SELECT ut.user_id,
               u.user_name,
               u.department_name
          FROM user_tag ut
          JOIN users u
            ON u.user_id = ut.user_id
         WHERE ut.tag_type_id = :P210_TAG_TYPE_ID
           AND ut.tag_code    = v_dec_code
           AND ut.date_end IS NULL
         ORDER BY ut.id
      ) x
     WHERE ROWNUM = 1;
  EXCEPTION
    WHEN NO_DATA_FOUND THEN
      -- –î—É–±–ª—ñ–∫–∞—Ç—ñ–≤ –Ω–µ–º–∞—î ‚Äî —É—Å–µ –æ–∫
      RETURN NULL;
  END;

  -- 4. –Ø–∫—â–æ –º–∏ —Å—é–¥–∏ –¥—ñ–π—à–ª–∏ ‚Äî –∑–Ω–∞—á–∏—Ç—å –º—ñ—Ç–∫–∞ –≤–∂–µ –¥–µ—Å—å –ø—Ä–∏–≤‚Äô—è–∑–∞–Ω–∞
  IF v_exist_user_id = :P210_USER_ID THEN
    RETURN '–£ —Ü—å–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤–∂–µ —î –∞–∫—Ç–∏–≤–Ω–∏–π –∑–≤‚Äô—è–∑–æ–∫ —ñ–∑ —Ü—ñ—î—é –º—ñ—Ç–∫–æ—é.';
  ELSE
    RETURN '–¶—è –º—ñ—Ç–∫–∞ –≤–∂–µ –ø—Ä–∏–≤‚Äô—è–∑–∞–Ω–∞ –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ ' ||
           v_exist_user_name || ' (–ø—ñ–¥—Ä–æ–∑–¥—ñ–ª: ' || v_exist_dept_name || ').';
  END IF;
END;
```

üîç –©–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è:

* `normalize_tag_code(:P210_TAG_CODE_INPUT)`:

  * –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î `04:A3:BC:1F` ‚Üí `–¥–µ—Å—è—Ç–∫–æ–≤–µ —á–∏—Å–ª–æ`;
  * —è–∫—â–æ –≤–≤–µ–ª–∏ —â–æ—Å—å —Ç–∏–ø—É `GZ12`, –¥–∞—Å—Ç—å –∑—Ä–æ–∑—É–º—ñ–ª—É –ø–æ–º–∏–ª–∫—É –∑ `RAISE_APPLICATION_ERROR`.
* –Ø–∫—â–æ –º—ñ—Ç–∫–∞ **–Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞** —Å–µ—Ä–µ–¥ –∞–∫—Ç–∏–≤–Ω–∏—Ö (`date_end IS NULL`) ‚Üí `NO_DATA_FOUND` ‚Üí `RETURN NULL;` ‚Üí –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –ø—Ä–æ–π–¥–µ–Ω–∞.
* –Ø–∫—â–æ **–∑–Ω–∞–π–¥–µ–Ω–∞**:

  * —è–∫—â–æ —Ü–µ **—Ç–æ–π –∂–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á** ‚Üí ‚Äú–£ —Ü—å–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤–∂–µ —î –∞–∫—Ç–∏–≤–Ω–∏–π –∑–≤‚Äô—è–∑–æ–∫‚Ä¶‚Äù
  * —è–∫—â–æ **—ñ–Ω—à–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á** ‚Üí —Ç–µ–∫—Å—Ç –∑ —ñ–º‚Äô—è–º —Ç–∞ –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª–æ–º.

> –í–∞–∂–ª–∏–≤–æ: —Ü—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—è **—ñ –Ω–æ—Ä–º–∞–ª—ñ–∑—É—î**, —ñ –ø–µ—Ä–µ–≤—ñ—Ä—è—î –¥—É–±–ª—ñ–∫–∞—Ç–∏.
> –¢–µ–ø–µ—Ä –Ω–µ —Å—Ç—Ä–∞—à–Ω–æ –Ω–∞–≤—ñ—Ç—å –±–µ–∑ Dynamic Action ‚Äî –ª–æ–≥—ñ–∫–∞ –≤—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ.

---

## 2Ô∏è‚É£ –ü—Ä–æ—Ü–µ—Å –≤—Å—Ç–∞–≤–∫–∏ `PRC_CREATE_USER_TAG`

–¢–µ–ø–µ—Ä –π–æ–≥–æ –º–æ–∂–Ω–∞ —Å–ø—Ä–æ—Å—Ç–∏—Ç–∏, –±–æ:

* `P210_TAG_CODE` –≤–∂–µ –º—ñ—Å—Ç–∏—Ç—å –Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π —Ä—è–¥–æ–∫;
* —Ñ–æ—Ä–º–∞—Ç –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ;
* –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤ –Ω–µ–º–∞—î (–≤–∞–ª—ñ–¥–∞—Ü—ñ—è –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å).

**Process (After Submit, when button = ‚Äú–î–æ–¥–∞—Ç–∏ –∑–≤‚Äô—è–∑–æ–∫‚Äù):**

```plsql
BEGIN
  INSERT INTO user_tag (user_id, tag_type_id, tag_code, created_at)
  VALUES (:P210_USER_ID,
          :P210_TAG_TYPE_ID,
          :P210_TAG_CODE,
          SYSTIMESTAMP);

  apex_application.g_print_success_message :=
    '–ó–≤‚Äô—è–∑–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á ‚Äì –º—ñ—Ç–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–æ.';
END;
```

---

## 3Ô∏è‚É£ –ü—Ä–æ Dynamic Action (–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è ‚Äú–Ω–∞ –ª—å–æ—Ç—É‚Äù) ‚Äî –æ–ø—Ü—ñ–π–Ω–æ

–¢–µ, —â–æ –º–∏ –≤–∂–µ —Ä–æ–±–∏–ª–∏:

* **Event:** Change ‚Üí `P210_TAG_CODE_INPUT`
* **Action:** Set Value ‚Üí PL/SQL Function Body:

  ```plsql
  RETURN normalize_tag_code(:P210_TAG_CODE_INPUT);
  ```
* **Affected Item:** `P210_TAG_CODE`

–¶–µ —á–∏—Å—Ç–æ –¥–ª—è –∑—Ä—É—á–Ω–æ—Å—Ç—ñ: –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä **–æ–¥—Ä–∞–∑—É –±–∞—á–∏—Ç—å**, —É —â–æ –∫–æ–Ω–≤–µ—Ä—Ç—É—î—Ç—å—Å—è –∫–æ–¥.
–ê –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Å–µ –æ–¥–Ω–æ –∑—Ä–æ–±–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∏–π –¥—É–±–ª—å –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—ó/–ø–µ—Ä–µ–≤—ñ—Ä–∫–∏.

---

## 4Ô∏è‚É£ –©–æ –æ—Ç—Ä–∏–º–∞—î –∞–¥–º—ñ–Ω

1. –í—Å—Ç–∞–≤–ª—è—î:

   * –∞–±–æ `123456789`,
   * –∞–±–æ `04:A3:BC:1F:2D:90:80`,
   * –∞–±–æ `04A3BC1F2D9080`.
2. APEX:

   * —á–∏—Å—Ç–∏—Ç—å/–∫–æ–Ω–≤–µ—Ä—Ç—É—î –≤ –¥–µ—Å—è—Ç–∫–æ–≤–µ;
   * —è–∫—â–æ —Ñ–æ—Ä–º–∞—Ç –∫—Ä–∏–≤–∏–π ‚Üí –∑—Ä–æ–∑—É–º—ñ–ª–∏–π error;
   * —è–∫—â–æ –º—ñ—Ç–∫–∞ –≤–∂–µ –∞–∫—Ç–∏–≤–Ω–∞ –≤ —ñ–Ω—à–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ ‚Üí
     **‚Äú–¶—è –º—ñ—Ç–∫–∞ –≤–∂–µ –ø—Ä–∏–≤‚Äô—è–∑–∞–Ω–∞ –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ü–≤–∞–Ω–µ–Ω–∫–æ –Ü.–Ü. (–ø—ñ–¥—Ä–æ–∑–¥—ñ–ª: –¶–µ—Ö 1).‚Äù**
   * —è–∫—â–æ —Ç–∞ –∂ –º—ñ—Ç–∫–∞ –≤–∂–µ —î –≤ —Ü—å–æ–≥–æ –∂ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ ‚Üí
     **‚Äú–£ —Ü—å–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤–∂–µ —î –∞–∫—Ç–∏–≤–Ω–∏–π –∑–≤‚Äô—è–∑–æ–∫ —ñ–∑ —Ü—ñ—î—é –º—ñ—Ç–∫–æ—é.‚Äù**
3. –Ø–∫—â–æ –≤—Å–µ –æ–∫ ‚Üí

   * –∑–∞–ø–∏—Å —É `USER_TAG`,
   * –¥—ñ–∞–ª–æ–≥ –∑–∞–∫—Ä–∏–≤–∞—î—Ç—å—Å—è,
   * –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ IR –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è,
   * –∑–≤–µ—Ä—Ö—É –∑–µ–ª–µ–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è ‚Äú–ó–≤‚Äô—è–∑–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á ‚Äì –º—ñ—Ç–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–æ.‚Äù

---

–Ø–∫—â–æ —Ö–æ—á–µ—à, –Ω–∞—Å—Ç—É–ø–Ω–∏–º –∫—Ä–æ–∫–æ–º –º–æ–∂–µ–º–æ —Ç–∞–∫ —Å–∞–º–æ –∞–∫—É—Ä–∞—Ç–Ω–æ –æ—Ñ–æ—Ä–º–∏—Ç–∏ **‚Äú–¥–µ–∞–∫—Ç–∏–≤–∞—Ü—ñ—é‚Äù –º—ñ—Ç–∫–∏** (—Å—Ç–∞–≤–∏—Ç–∏ `DATE_END`, –Ω–µ –¥–∞—é—á–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –¥–æ–¥–∞—Ç–∏ —Ç–æ–π —Å–∞–º–∏–π –∫–æ–¥ –±–µ–∑ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑–≤‚Äô—è–∑–∫—É).


‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî

–ß—É–¥–æ–≤–µ –∑–∞–≤–¥–∞–Ω–Ω—è ‚Äî –¥–∞–≤–∞–π –∑—Ä–æ–±–∏–º–æ –¥–µ–∞–∫—Ç–∏–≤–∞—Ü—ñ—é –º—ñ—Ç–∫–∏ ‚Äú–ø–æ-–¥–æ—Ä–æ—Å–ª–æ–º—É‚Äù: –∑ confirm, soft-delete —á–µ—Ä–µ–∑ `DATE_END` —ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º refresh –∑–≤—ñ—Ç—É üí≥

–ù–∏–∂—á–µ ‚Äî –≥–æ—Ç–æ–≤–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –ø—ñ–¥ **Interactive Report**.

---

## 1. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞: SQL –∑–≤—ñ—Ç—É

–£ —Ç–≤–æ—î–º—É IR —É–∂–µ —î –∑–∞–ø–∏—Ç (–∑ —Ñ—ñ–ª—å—Ç—Ä–æ–º –ø–æ –∞–∫—Ç–∏–≤–Ω–∏—Ö –º—ñ—Ç–∫–∞—Ö):

```sql
SELECT 
    t.id,
    t.user_id,
    u.user_name,
    u.department_name,
    tt.code AS tag_type_name,
    t.tag_code,
    t.created_at
FROM user_tag t
JOIN users u 
    ON u.user_id = t.user_id
JOIN tag_type_lu tt 
    ON tt.id = t.tag_type_id
WHERE t.date_end IS NULL
ORDER BY t.created_at DESC;
```

–ì–æ–ª–æ–≤–Ω–µ ‚Äî —â–æ–± **–∫–æ–ª–æ–Ω–∫–∞ `ID` –±—É–ª–∞ –≤ –∑–≤—ñ—Ç—ñ** (–º–æ–∂–µ –±—É—Ç–∏ –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ—é).

---

## 2. –î–æ–¥–∞—î–º–æ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π item –¥–ª—è ID –º—ñ—Ç–∫–∏

–ù–∞ —Ü—ñ–π –∂–µ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ (–≥–æ–ª–æ–≤–Ω–∞ –∑ IR):

1. –°—Ç–≤–æ—Ä–∏ item: **`PXX_TAG_ID`**
   (–¥–µ `XX` ‚Äî –Ω–æ–º–µ—Ä —Å—Ç–æ—Ä—ñ–Ω–∫–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ 200 ‚Üí `P200_TAG_ID`)

* **Type:** Hidden
* **Value Protected:** Yes
* **Session State Protection:** Unrestricted (–¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç–∏ —Ç—É—Ç –æ–∫)

---

## 3. –ö–æ–ª–æ–Ω–∫–∞ –∑ —ñ–∫–æ–Ω–∫–æ—é ‚Äú–¥–µ–∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏‚Äù

–£ Interactive Report –¥–æ–¥–∞–π **–Ω–æ–≤—É –∫–æ–ª–æ–Ω–∫—É**:

1. –£–∫–ª–∞–¥–∫–∞ Columns ‚Üí Create ‚Üí Column.
2. –ù–∞–∑–≤–∞ –∫–æ–ª–æ–Ω–∫–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `DELETE_LINK`.
3. –¢–∏–ø –∫–æ–ª–æ–Ω–∫–∏: **Link**.

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Link Column

* **Link Text:**

```html
<span class="fa fa-trash-o" title="–î–µ–∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏" style="cursor:pointer;"></span>
```

(–∞–±–æ —ñ–Ω—à–∞ —ñ–∫–æ–Ω–∫–∞ / SVG, —è–∫ —Ç–æ–±—ñ –ø–æ–¥–æ–±–∞—î—Ç—å—Å—è)

* **Target:** `Url` ‚Üí `javascript:void(0);`
* **Link Attributes:**

```html
data-id="#ID#" class="tag-delete-link"
```

> –¢—É—Ç `#ID#` ‚Äî —Ü–µ –ø—ñ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–Ω—è –∫–æ–ª–æ–Ω–∫–∏ `ID` –∑ —Ç–≤–æ–≥–æ –∑–∞–ø–∏—Ç—É.
> `class="tag-delete-link"` –ø–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ –≤ Dynamic Action.

–ö–æ–ª–æ–Ω–∫—É `ID` —Å–∞–º—É –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ **Hidden**, –∞ `DELETE_LINK` –±—É–¥–µ –≤–∏–¥–∏–º–æ—é.

---

## 4. Dynamic Action: –∫–ª—ñ–∫ –ø–æ —ñ–∫–æ–Ω—Ü—ñ ‚Üí confirm ‚Üí UPDATE ‚Üí refresh

### 4.1. –°—Ç–≤–æ—Ä—é—î–º–æ Dynamic Action

* **Name:** `DA_DEACTIVATE_TAG`
* **Event:** Click
* **Selection Type:** jQuery Selector
* **jQuery Selector:** `.tag-delete-link`

–¶–µ –æ–∑–Ω–∞—á–∞—î: –±—É–¥—å-—è–∫–∏–π –∫–ª—ñ–∫ –ø–æ –µ–ª–µ–º–µ–Ω—Ç—É –∑ –∫–ª–∞—Å–æ–º `tag-delete-link` –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏.

---

### 4.2. True Action 1 ‚Äî JavaScript: –∑–∞–ø–∏—Å–∞—Ç–∏ ID —É item

**Action:** Execute JavaScript Code

**Code:**

```js
var id = $(this.triggeringElement).data("id");
$s("PXX_TAG_ID", id); // –∑–∞–º—ñ–Ω–∏ PXX_TAG_ID –Ω–∞ —Å–≤—ñ–π item, –Ω–∞–ø—Ä. P200_TAG_ID
```

–¶–∏–º –º–∏ –±–µ—Ä–µ–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è `data-id="#ID#"` –∑ —ñ–∫–æ–Ω–∫–∏ —ñ –∑–∞–ø–∏—Å—É—î–º–æ –π–æ–≥–æ –≤ `PXX_TAG_ID`.

---

### 4.3. True Action 2 ‚Äî Confirm

**Action:** Confirm

* **Message:**

```text
–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –¥–µ–∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ —Ü—é –º—ñ—Ç–∫—É?
```

* **OK Button Label:** –¢–∞–∫
* **Cancel Button Label:** –ù—ñ

---

### 4.4. True Action 3 ‚Äî Execute Server-side Code

**Action:** Execute Server-side Code

* **PL/SQL Code:**

```plsql
UPDATE user_tag
   SET date_end = SYSTIMESTAMP
 WHERE id = :PXX_TAG_ID;
```

(–∑–∞–º—ñ–Ω–∏ `PXX_TAG_ID` –Ω–∞ —Å–≤—ñ–π item, –Ω–∞–ø—Ä. `P200_TAG_ID`)

* **Items to Submit:**
  `PXX_TAG_ID`

* **Fire on Initialization:** No

> –¶–∏–º –º–∏ —Ä–æ–±–∏–º–æ **soft-delete**: –∑–∞–ø–∏—Å –Ω–µ –≤–∏–¥–∞–ª—è—î—Ç—å—Å—è —Ñ—ñ–∑–∏—á–Ω–æ, –∞ —Ç—ñ–ª—å–∫–∏ –æ—Ç—Ä–∏–º—É—î `DATE_END`.
> –û—Å–∫—ñ–ª—å–∫–∏ –≤ IR —É —Ç–µ–±–µ `WHERE t.date_end IS NULL` ‚Äî –ø—ñ—Å–ª—è refresh —Ü–µ–π —Ä—è–¥–æ–∫ –∑–Ω–∏–∫–Ω–µ.

---

### 4.5. True Action 4 ‚Äî Refresh Region

**Action:** Refresh

* **Selection Type:** Region
* **Region:** —Ç–≤—ñ–π IR –∑ user_tag (–æ–±–µ—Ä–∏ –π–æ–≥–æ –∑—ñ —Å–ø–∏—Å–∫—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `User Tag List`)

---

### 4.6. (–û–ø—Ü—ñ–π–Ω–æ) True Action 5 ‚Äî –ü–æ–∫–∞–∑–∞—Ç–∏ success message

–ú–æ–∂–µ—à –¥–æ–¥–∞—Ç–∏ —â–µ –æ–¥–Ω—É –¥—ñ—é:

* **Action:** Execute JavaScript Code

```js
apex.message.showPageSuccess("–ú—ñ—Ç–∫—É –¥–µ–∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ.");
```

(–∞–±–æ –∑—Ä–æ–±–∏—Ç–∏ —Ü–µ —á–µ—Ä–µ–∑ PL/SQL + `apex_application.g_print_success_message` –≤ –ø—Ä–æ—Ü–µ—Å—ñ ‚Äî –æ–±–∏–¥–≤–∞ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –æ–∫)

---

## 5. –Ø–∫ —Ü–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏–º–µ –¥–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

1. –í IR –≤—ñ–Ω –±–∞—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω–∏—Ö –º—ñ—Ç–æ–∫.
2. –ü—Ä–∞–≤–æ—Ä—É—á/—É –∫–æ–ª–æ–Ω—Ü—ñ ‚Äî —ñ–∫–æ–Ω–∫–∞ ‚Äú—Å–º—ñ—Ç–Ω–∏–∫–∞‚Äù (–∞–±–æ —ñ–Ω—à–∞).
3. –ù–∞—Ç–∏—Å–∫–∞—î ‚Äî –∑‚Äô—è–≤–ª—è—î—Ç—å—Å—è:

> **‚Äú–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –¥–µ–∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ —Ü—é –º—ñ—Ç–∫—É?‚Äù**
> [–¢–∞–∫] [–ù—ñ]

4. –ü—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ **–¢–∞–∫**:

   * –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è `UPDATE user_tag SET date_end = SYSTIMESTAMP WHERE id = ...`;
   * IR –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è;
   * (–æ–ø—Ü—ñ–π–Ω–æ) –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è –∑–µ–ª–µ–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è ‚Äú–ú—ñ—Ç–∫—É –¥–µ–∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ.‚Äù

---

–Ø–∫—â–æ —Ö–æ—á–µ—à, –Ω–∞—Å—Ç—É–ø–Ω–∏–º –∫—Ä–æ–∫–æ–º –º–æ–∂–µ–º–æ:

* –¥–æ–¥–∞—Ç–∏ –ª–æ–≥ (—Ö—Ç–æ –¥–µ–∞–∫—Ç–∏–≤—É–≤–∞–≤, –∫–æ–ª–∏ —ñ –∑ —è–∫–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏),
* –∞–±–æ –∑—Ä–æ–±–∏—Ç–∏ —ñ—Å—Ç–æ—Ä–∏—á–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É/–∑–≤—ñ—Ç –ø–æ **–≤—Å—ñ—Ö** –º—ñ—Ç–∫–∞—Ö (–∞–∫—Ç–∏–≤–Ω—ñ + –∞—Ä—Ö—ñ–≤).



‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî


