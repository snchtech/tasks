–û–∫–µ–π, —Ç–æ–¥—ñ –∑—Ä–æ–±–∏–º–æ —Ü–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ ‚Äú–ø—ñ–¥ –∫–ª—é—á‚Äù üëá

–Ø —É–º–æ–≤–Ω–æ –≤—ñ–∑—å–º—É **modal-—Å—Ç–æ—Ä—ñ–Ω–∫—É ‚Ññ210** –∑ —Ç–∞–∫–∏–º–∏ item‚Äô–∞–º–∏:

* `P210_USER_ID`
* `P210_TAG_CODE_INPUT`
* `P210_TAG_CODE`
* `P210_TAG_TYPE_ID`

–Ø–∫—â–æ –≤ —Ç–µ–±–µ —ñ–Ω—à—ñ –Ω–æ–º–µ—Ä–∏ —Å—Ç–æ—Ä—ñ–Ω–æ–∫ –∞–±–æ –Ω–∞–∑–≤–∏ item‚Äô—ñ–≤ ‚Äî –ø—Ä–æ—Å—Ç–æ –∑–∞–º—ñ–Ω–∏—à —ó—Ö 1:1.

---

## 1Ô∏è‚É£ –§—É–Ω–∫—Ü—ñ—è `normalize_tag_code` —É –ë–î

–°—Ç–≤–æ—Ä–∏ (–∞–±–æ –≤ –ø–∞–∫–µ—Ç—ñ, –∞–±–æ —è–∫ standalone-—Ñ—É–Ω–∫—Ü—ñ—é –≤ —Å—Ö–µ–º—ñ, –¥–µ –∂–∏–≤–µ APEX app):

```plsql
CREATE OR REPLACE FUNCTION normalize_tag_code (p_raw IN VARCHAR2)
  RETURN VARCHAR2
IS
  v_clean VARCHAR2(128);
  v_num   NUMBER;
BEGIN
  IF p_raw IS NULL THEN
    RETURN NULL;
  END IF;

  -- 1. –ü—Ä–∏–±–∏—Ä–∞—î–º–æ –ø—Ä–æ–±—ñ–ª–∏, –¥–≤–æ–∫—Ä–∞–ø–∫–∏, –¥–µ—Ñ—ñ—Å–∏ –π —É—Å–µ, —â–æ –Ω–µ 0-9/A-F
  v_clean := REGEXP_REPLACE(UPPER(TRIM(p_raw)), '[^0-9A-F]', '');

  IF v_clean IS NULL THEN
    RAISE_APPLICATION_ERROR(
      -20001, 
      '–ö–æ–¥ –º—ñ—Ç–∫–∏ –ø–æ—Ä–æ–∂–Ω—ñ–π –∞–±–æ –º—ñ—Å—Ç–∏—Ç—å –ª–∏—à–µ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω—ñ —Å–∏–º–≤–æ–ª–∏.'
    );
  END IF;

  -- 2. –Ø–∫—â–æ –ª–∏—à–µ —Ü–∏—Ñ—Ä–∏ -> —Ü–µ –≤–∂–µ –¥–µ—Å—è—Ç–∫–æ–≤–∏–π –∫–æ–¥
  IF REGEXP_LIKE(v_clean, '^[0-9]+$') THEN
    RETURN TO_CHAR(TO_NUMBER(v_clean));

  -- 3. –Ø–∫—â–æ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ HEX-—Å–∏–º–≤–æ–ª–∏ 0-9, A-F -> —Ü–µ HEX, –∫–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ –≤ DEC
  ELSIF REGEXP_LIKE(v_clean, '^[0-9A-F]+$') THEN
    v_num := TO_NUMBER(v_clean, 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX');
    RETURN TO_CHAR(v_num);

  -- 4. –Ü–Ω–∞–∫—à–µ —Ñ–æ—Ä–º–∞—Ç –ø–æ–≥–∞–Ω–∏–π
  ELSE
    RAISE_APPLICATION_ERROR(
      -20002, 
      '–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –∫–æ–¥—É –º—ñ—Ç–∫–∏. –î–æ–∑–≤–æ–ª–µ–Ω—ñ –ª–∏—à–µ —Ü–∏—Ñ—Ä–∏ –∞–±–æ HEX (0‚Äì9, A‚ÄìF).'
    );
  END IF;
END normalize_tag_code;
/
```

üëâ –í–æ–Ω–∞:

* –ø—Ä–∏–π–º–∞—î –±—É–¥—å-—â–æ: `123456`, `04:A3:BC:1F`, `04-a3-bc-1f`;
* —á–∏—Å—Ç–∏—Ç—å –¥–æ `04A3BC1F`;
* —è–∫—â–æ —Ü–µ **digits only** ‚Üí –∑–∞–ª–∏—à–∞—î —è–∫ DEC;
* —è–∫—â–æ **HEX** ‚Üí —Ä–æ–±–∏—Ç—å `HEX ‚Üí NUMBER ‚Üí VARCHAR2`;
* –ø—Ä–∏ –ø–æ–º–∏–ª—Ü—ñ –¥–∞—î –Ω–æ—Ä–º–∞–ª—å–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ `RAISE_APPLICATION_ERROR`.

---

## 2Ô∏è‚É£ –ü–æ–ª—è –Ω–∞ modal-—Å—Ç–æ—Ä—ñ–Ω—Ü—ñ (‚Ññ210)

–ù–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ, –¥–µ –¥–æ–¥–∞—î—Ç—å—Å—è –∑–≤‚Äô—è–∑–æ–∫:

1. **`P210_USER_ID`**

   * Type: Popup LOV
   * LOV:

     ```sql
     SELECT user_name d, user_id r
     FROM users
     ORDER BY user_name
     ```

2. **`P210_TAG_TYPE_ID`**

   * Type: Select List
   * LOV:

     ```sql
     SELECT code d, id r
     FROM tag_type_lu
     ORDER BY code
     ```

3. **`P210_TAG_CODE_INPUT`**

   * Type: Text Field
   * Label: –Ω–∞–ø—Ä–∏–∫–ª–∞–¥,

     > –ö–æ–¥ –º—ñ—Ç–∫–∏ (–¥–µ—Å—è—Ç–∫–æ–≤–∏–π –∞–±–æ HEX / Android-—Ñ–æ—Ä–º–∞—Ç)
   * Help / Tooltip:

     > –ú–æ–∂–Ω–∞ –≤–≤–æ–¥–∏—Ç–∏:
     >
     > * –¥–µ—Å—è—Ç–∫–æ–≤–∏–π –∫–æ–¥ (–Ω–∞–ø—Ä.: `123456789`);
     > * –∞–±–æ HEX / Android —Ñ–æ—Ä–º–∞—Ç (`04:A3:BC:1F:2D:90:80`, `04A3BC1F2D9080`).
     >   –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç—å —É –¥–µ—Å—è—Ç–∫–æ–≤–∏–π —Ñ–æ—Ä–º–∞—Ç.

4. **`P210_TAG_CODE`**

   * Type: Display Only (–∞–±–æ Text Field, Read Only)
   * Label:

     > –î–µ—Å—è—Ç–∫–æ–≤–∏–π –∫–æ–¥ –º—ñ—Ç–∫–∏
   * –¶–µ —Ç–µ –∑–Ω–∞—á–µ–Ω–Ω—è, —è–∫–µ –ø—ñ–¥–µ–º–æ –≤—Å—Ç–∞–≤–ª—è—Ç–∏ –≤ `USER_TAG.TAG_CODE`.

---

## 3Ô∏è‚É£ Dynamic Action: –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–¥—É

–©–æ–± –∞–¥–º—ñ–Ω –æ–¥—Ä–∞–∑—É –±–∞—á–∏–≤, —É —â–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏–≤—Å—è –∫–æ–¥.

### DA: `DA_CONVERT_TAG_CODE`

* **Event:** Change
* **Selection Type:** Item(s)
* **Item(s):** `P210_TAG_CODE_INPUT`

#### True Action 1: Set Value

* **Action:** Set Value
* **Set Type:** PL/SQL Function Body
* **PL/SQL Function Body:**

  ```plsql
  RETURN normalize_tag_code(:P210_TAG_CODE_INPUT);
  ```
* **Affected Items:** `P210_TAG_CODE`
* **Items to Submit:** `P210_TAG_CODE_INPUT`
* **Fire on Initialization:** No

üëâ –†–µ–∑—É–ª—å—Ç–∞—Ç:

* –∞–¥–º—ñ–Ω –≤—Å—Ç–∞–≤–∏–≤ `04:A3:BC:1F` ‚Üí –ø—ñ—Å–ª—è –≤—Ç—Ä–∞—Ç–∏ —Ñ–æ–∫—É—Å—É `P210_TAG_CODE_INPUT`
* `P210_TAG_CODE` –∑–∞–ø–æ–≤–Ω—é—î—Ç—å—Å—è —á–∏–º–æ—Å—å —Ç–∏–ø—É `781273423` (–¥–µ—Å—è—Ç–∫–æ–≤–µ).

–Ø–∫—â–æ —Ñ–æ—Ä–º–∞—Ç –ø–æ–≥–∞–Ω–∏–π ‚Äî APEX –ø–æ–∫–∞–∂–µ –ø–æ–º–∏–ª–∫—É, —è–∫—É –º–∏ –∑–∞–¥–∞–ª–∏ –≤ `RAISE_APPLICATION_ERROR`.

---

## 4Ô∏è‚É£ –í–∞–ª—ñ–¥–∞—Ü—ñ—è –Ω–∞ —Ñ–æ—Ä–º—ñ

–©–æ–± –Ω–µ –∑–±–µ—Ä—ñ–≥—Ç–∏ –ø—É—Å—Ç–µ/–Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–µ:

### Validation 1: `VAL_TAG_CODE_NOT_NULL`

* **Type:** Item is NOT NULL
* **Item:** `P210_TAG_CODE_INPUT`
* **Associated Button:** `–î–æ–¥–∞—Ç–∏ –∑–≤‚Äô—è–∑–æ–∫` (–∫–Ω–æ–ø–∫–∞ submit)
* **Error Message:**

  > –í–∫–∞–∂—ñ—Ç—å, –±—É–¥—å –ª–∞—Å–∫–∞, –∫–æ–¥ –º—ñ—Ç–∫–∏.

–û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ ‚Äî –º–æ–∂–Ω–∞ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ `P210_TAG_CODE_INPUT`, –∞ —Å–∞–º–µ `P210_TAG_CODE`, –∞–ª–µ —Ç–æ–¥—ñ —Ç—Ä–µ–±–∞ —Å–ª—ñ–¥–∫—É–≤–∞—Ç–∏, —â–æ–± DA –≤—ñ–¥–ø—Ä–∞—Ü—é–≤–∞–≤.

---

## 5Ô∏è‚É£ –ü—Ä–æ—Ü–µ—Å –≤—Å—Ç–∞–≤–∫–∏ –≤ `USER_TAG`

–ù–∞–∑–≤–∞ –ø—Ä–æ—Ü–µ—Å—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `PRC_CREATE_USER_TAG`.

* **Process Point:** After Submit
* **Condition:** When Button Pressed = `–î–û–î–ê–¢–ò_–ó–í–Ø–ó–û–ö` (—Ç–≤–æ—è –Ω–∞–∑–≤–∞ –∫–Ω–æ–ø–∫–∏)
* **PL/SQL Code:**

```plsql
DECLARE
  v_dec_code VARCHAR2(128);
BEGIN
  -- –ù–∞ –≤—Å—è–∫ –≤–∏–ø–∞–¥–æ–∫ —â–µ —Ä–∞–∑ –Ω–æ—Ä–º–∞–ª—ñ–∑—É—î–º–æ,
  -- —â–æ–± –±—É—Ç–∏ –Ω–µ–∑–∞–ª–µ–∂–Ω–∏–º–∏ –≤—ñ–¥ DA (JS –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–º–∫–Ω–µ–Ω–∏–π)
  v_dec_code := normalize_tag_code(:P210_TAG_CODE_INPUT);

  INSERT INTO user_tag (user_id, tag_type_id, tag_code, created_at)
  VALUES (:P210_USER_ID, :P210_TAG_TYPE_ID, v_dec_code, SYSTIMESTAMP);

  -- –©–æ–± –ø–æ—Ç—ñ–º –ø–æ–∫–∞–∑–∞—Ç–∏ success message (—è–∫—â–æ —Ç—Ä–µ–±–∞ —á–µ—Ä–µ–∑ —Å—Ç–æ—Ä—ñ–Ω–∫—É)
  :P210_TAG_CODE := v_dec_code;
END;
```

> –¢—É—Ç —è —â–µ —Ä–∞–∑ –≤–∏–∫–ª–∏–∫–∞—é `normalize_tag_code` **–Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ**,
> –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ DA —É–∂–µ –∑—Ä–æ–±–∏–≤ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—é.
> –¶–µ ‚Äú—Å—Ç—Ä–∞—Ö–æ–≤–∫–∞‚Äù, —è–∫—â–æ –≤ –∫–æ–≥–æ—Å—å –±—É–¥–µ –≤–∏–º–∫–Ω–µ–Ω–∏–π JS.

---

## 6Ô∏è‚É£ –ü–æ–∫–∞–∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è + –∑–∞–∫—Ä–∏—Ç—Ç—è –¥—ñ–∞–ª–æ–≥—É

### Success Message

–£ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—è—Ö —Å—Ç–æ—Ä—ñ–Ω–∫–∏ (Processing ‚Üí Messages) –º–æ–∂–Ω–∞ –∑–∞–¥–∞—Ç–∏:

* **Success Message:**

  > –ó–≤‚Äô—è–∑–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á ‚Äì –º—ñ—Ç–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–æ.

–∞–±–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —á–µ—Ä–µ–∑:

```plsql
apex_application.g_print_success_message :=
    '–ó–≤‚Äô—è–∑–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á ‚Äì –º—ñ—Ç–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–æ.';
```

(–≤ –∫—ñ–Ω—Ü—ñ –ø—Ä–æ—Ü–µ—Å—É, —è–∫—â–æ —Ö–æ—á–µ—à —É—Å–µ —Å–∞–º–µ —Ç–∞–º —Ç—Ä–∏–º–∞—Ç–∏).

### –ó–∞–∫—Ä–∏—Ç—Ç—è –¥—ñ–∞–ª–æ–≥—É

–Ø–∫—â–æ —Ü–µ modal dialog-—Å—Ç–æ—Ä—ñ–Ω–∫–∞:

* Button ‚Äú–î–æ–¥–∞—Ç–∏ –∑–≤‚Äô—è–∑–æ–∫‚Äù –º–∞—î:

  * **Action:** Submit Page
* –ù–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ:

  * **Dialog ‚Üí Close Dialog** —É–≤—ñ–º–∫–Ω–µ–Ω–æ (APEX —Å–∞–º –∑–∞–∫—Ä–∏—î –¥—ñ–∞–ª–æ–≥ –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É).

–ù–∞ **–≥–æ–ª–æ–≤–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ** (–¥–µ Interactive Report):

* –î–æ–¥–∞–π **Dynamic Action**:

  * **Event:** Dialog Closed
  * **Selection Type:** Region
  * **Region:** —Ç–≤—ñ–π IR `User Tag List`
  * **True Action:** Refresh

–¢–∞–∫ IR –æ–Ω–æ–≤–∏—Ç—å—Å—è –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è –∑–∞–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª–∫–∏ –π —Ç–∏ –ø–æ–±–∞—á–∏—à –Ω–æ–≤–∏–π –∑–≤‚Äô—è–∑–æ–∫.

---

## 7Ô∏è‚É£ –ü—ñ–¥—Å—É–º–æ–∫, —â–æ –æ—Ç—Ä–∏–º–∞—î –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä UX-–æ–º

* –í—Å—Ç–∞–≤–ª—è—î:

  * `123456789` ‚Üí –æ–¥—Ä–∞–∑—É –∑–±–µ—Ä—ñ–≥–∞—î–º–æ —è–∫ `123456789`;
  * –∞–±–æ `04:A3:BC:1F:2D:90:80` ‚Üí –±–∞—á–∏—Ç—å –≤ –ø–æ–ª—ñ –Ω–∏–∂—á–µ –≤–∂–µ –¥–µ—Å—è—Ç–∫–æ–≤–∏–π –∫–æ–¥;
* –ü—Ä–∏ –ø–æ–º–∏–ª—Ü—ñ —Ñ–æ—Ä–º–∞—Ç—É –æ—Ç—Ä–∏–º—É—î –∑—Ä–æ–∑—É–º—ñ–ª–∏–π –º–µ—Å–µ–¥–∂:

  * *‚Äú–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –∫–æ–¥—É –º—ñ—Ç–∫–∏. –î–æ–∑–≤–æ–ª–µ–Ω—ñ –ª–∏—à–µ —Ü–∏—Ñ—Ä–∏ –∞–±–æ HEX (0‚Äì9, A‚ÄìF).‚Äù*
* –ù–∞—Ç–∏—Å–∫–∞—î **‚Äú–î–æ–¥–∞—Ç–∏ –∑–≤‚Äô—è–∑–æ–∫‚Äù** ‚Üí
  –∑–∞–ø–∏—Å –ª–µ—Ç–∏—Ç—å –≤ `USER_TAG` —É **–Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–æ–º—É –¥–µ—Å—è—Ç–∫–æ–≤–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ**,
  –¥—ñ–∞–ª–æ–≥ –∑–∞–∫—Ä–∏–≤–∞—î—Ç—å—Å—è, –∑–≤—ñ—Ç –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è, –≤–≥–æ—Ä—ñ ‚Äî –∑–µ–ª–µ–Ω–∏–π –º–µ—Å–µ–¥–∂:

> ‚úÖ –ó–≤‚Äô—è–∑–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á ‚Äì –º—ñ—Ç–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–æ.

---

–Ø–∫—â–æ —Ö–æ—á–µ—à, –Ω–∞—Å—Ç—É–ø–Ω–∏–º –∫—Ä–æ–∫–æ–º –º–æ–∂–µ–º–æ:

* –¥–æ–¥–∞—Ç–∏ **–ø–µ—Ä–µ–≤—ñ—Ä–∫—É –Ω–∞ –¥—É–±–ª—ñ–∫–∞—Ç–∏** (—â–æ–± –Ω–µ –ø—Ä–∏–≤‚Äô—è–∑–∞—Ç–∏ –æ–¥–∏–Ω —ñ —Ç–æ–π —Å–∞–º–∏–π DEC-–∫–æ–¥ –¥–≤—ñ—á—ñ),
* –∞–±–æ –∑—Ä–æ–±–∏—Ç–∏ ‚Äú—Ä–æ–∑—É–º–Ω–µ‚Äù –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç–∏–ø—É *‚Äú–¶—è –º—ñ—Ç–∫–∞ –≤–∂–µ –ø—Ä–∏–≤‚Äô—è–∑–∞–Ω–∞ –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ X‚Äù*.
