–ß—É–¥–æ–≤–µ –∑–∞–≤–¥–∞–Ω–Ω—è ‚Äî –¥–∞–≤–∞–π –∑—Ä–æ–±–∏–º–æ –¥–µ–∞–∫—Ç–∏–≤–∞—Ü—ñ—é –º—ñ—Ç–∫–∏ ‚Äú–ø–æ-–¥–æ—Ä–æ—Å–ª–æ–º—É‚Äù: –∑ confirm, soft-delete —á–µ—Ä–µ–∑ `DATE_END` —ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º refresh –∑–≤—ñ—Ç—É üí≥

–ù–∏–∂—á–µ ‚Äî –≥–æ—Ç–æ–≤–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –ø—ñ–¥ **Interactive Report**.

---

## 1. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞: SQL –∑–≤—ñ—Ç—É

–£ —Ç–≤–æ—î–º—É IR —É–∂–µ —î –∑–∞–ø–∏—Ç (–∑ —Ñ—ñ–ª—å—Ç—Ä–æ–º –ø–æ –∞–∫—Ç–∏–≤–Ω–∏—Ö –º—ñ—Ç–∫–∞—Ö):

```sql
SELECT 
    t.id,
    t.user_id,
    u.user_name,
    u.department_name,
    tt.code AS tag_type_name,
    t.tag_code,
    t.created_at
FROM user_tag t
JOIN users u 
    ON u.user_id = t.user_id
JOIN tag_type_lu tt 
    ON tt.id = t.tag_type_id
WHERE t.date_end IS NULL
ORDER BY t.created_at DESC;
```

–ì–æ–ª–æ–≤–Ω–µ ‚Äî —â–æ–± **–∫–æ–ª–æ–Ω–∫–∞ `ID` –±—É–ª–∞ –≤ –∑–≤—ñ—Ç—ñ** (–º–æ–∂–µ –±—É—Ç–∏ –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ—é).

---

## 2. –î–æ–¥–∞—î–º–æ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π item –¥–ª—è ID –º—ñ—Ç–∫–∏

–ù–∞ —Ü—ñ–π –∂–µ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ (–≥–æ–ª–æ–≤–Ω–∞ –∑ IR):

1. –°—Ç–≤–æ—Ä–∏ item: **`PXX_TAG_ID`**
   (–¥–µ `XX` ‚Äî –Ω–æ–º–µ—Ä —Å—Ç–æ—Ä—ñ–Ω–∫–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ 200 ‚Üí `P200_TAG_ID`)

* **Type:** Hidden
* **Value Protected:** Yes
* **Session State Protection:** Unrestricted (–¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç–∏ —Ç—É—Ç –æ–∫)

---

## 3. –ö–æ–ª–æ–Ω–∫–∞ –∑ —ñ–∫–æ–Ω–∫–æ—é ‚Äú–¥–µ–∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏‚Äù

–£ Interactive Report –¥–æ–¥–∞–π **–Ω–æ–≤—É –∫–æ–ª–æ–Ω–∫—É**:

1. –£–∫–ª–∞–¥–∫–∞ Columns ‚Üí Create ‚Üí Column.
2. –ù–∞–∑–≤–∞ –∫–æ–ª–æ–Ω–∫–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `DELETE_LINK`.
3. –¢–∏–ø –∫–æ–ª–æ–Ω–∫–∏: **Link**.

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Link Column

* **Link Text:**

```html
<span class="fa fa-trash-o" title="–î–µ–∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏" style="cursor:pointer;"></span>
```

(–∞–±–æ —ñ–Ω—à–∞ —ñ–∫–æ–Ω–∫–∞ / SVG, —è–∫ —Ç–æ–±—ñ –ø–æ–¥–æ–±–∞—î—Ç—å—Å—è)

* **Target:** `Url` ‚Üí `javascript:void(0);`
* **Link Attributes:**

```html
data-id="#ID#" class="tag-delete-link"
```

> –¢—É—Ç `#ID#` ‚Äî —Ü–µ –ø—ñ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–Ω—è –∫–æ–ª–æ–Ω–∫–∏ `ID` –∑ —Ç–≤–æ–≥–æ –∑–∞–ø–∏—Ç—É.
> `class="tag-delete-link"` –ø–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ –≤ Dynamic Action.

–ö–æ–ª–æ–Ω–∫—É `ID` —Å–∞–º—É –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ **Hidden**, –∞ `DELETE_LINK` –±—É–¥–µ –≤–∏–¥–∏–º–æ—é.

---

## 4. Dynamic Action: –∫–ª—ñ–∫ –ø–æ —ñ–∫–æ–Ω—Ü—ñ ‚Üí confirm ‚Üí UPDATE ‚Üí refresh

### 4.1. –°—Ç–≤–æ—Ä—é—î–º–æ Dynamic Action

* **Name:** `DA_DEACTIVATE_TAG`
* **Event:** Click
* **Selection Type:** jQuery Selector
* **jQuery Selector:** `.tag-delete-link`

–¶–µ –æ–∑–Ω–∞—á–∞—î: –±—É–¥—å-—è–∫–∏–π –∫–ª—ñ–∫ –ø–æ –µ–ª–µ–º–µ–Ω—Ç—É –∑ –∫–ª–∞—Å–æ–º `tag-delete-link` –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏.

---

### 4.2. True Action 1 ‚Äî JavaScript: –∑–∞–ø–∏—Å–∞—Ç–∏ ID —É item

**Action:** Execute JavaScript Code

**Code:**

```js
var id = $(this.triggeringElement).data("id");
$s("PXX_TAG_ID", id); // –∑–∞–º—ñ–Ω–∏ PXX_TAG_ID –Ω–∞ —Å–≤—ñ–π item, –Ω–∞–ø—Ä. P200_TAG_ID
```

–¶–∏–º –º–∏ –±–µ—Ä–µ–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è `data-id="#ID#"` –∑ —ñ–∫–æ–Ω–∫–∏ —ñ –∑–∞–ø–∏—Å—É—î–º–æ –π–æ–≥–æ –≤ `PXX_TAG_ID`.

---

### 4.3. True Action 2 ‚Äî Confirm

**Action:** Confirm

* **Message:**

```text
–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –¥–µ–∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ —Ü—é –º—ñ—Ç–∫—É?
```

* **OK Button Label:** –¢–∞–∫
* **Cancel Button Label:** –ù—ñ

---

### 4.4. True Action 3 ‚Äî Execute Server-side Code

**Action:** Execute Server-side Code

* **PL/SQL Code:**

```plsql
UPDATE user_tag
   SET date_end = SYSTIMESTAMP
 WHERE id = :PXX_TAG_ID;
```

(–∑–∞–º—ñ–Ω–∏ `PXX_TAG_ID` –Ω–∞ —Å–≤—ñ–π item, –Ω–∞–ø—Ä. `P200_TAG_ID`)

* **Items to Submit:**
  `PXX_TAG_ID`

* **Fire on Initialization:** No

> –¶–∏–º –º–∏ —Ä–æ–±–∏–º–æ **soft-delete**: –∑–∞–ø–∏—Å –Ω–µ –≤–∏–¥–∞–ª—è—î—Ç—å—Å—è —Ñ—ñ–∑–∏—á–Ω–æ, –∞ —Ç—ñ–ª—å–∫–∏ –æ—Ç—Ä–∏–º—É—î `DATE_END`.
> –û—Å–∫—ñ–ª—å–∫–∏ –≤ IR —É —Ç–µ–±–µ `WHERE t.date_end IS NULL` ‚Äî –ø—ñ—Å–ª—è refresh —Ü–µ–π —Ä—è–¥–æ–∫ –∑–Ω–∏–∫–Ω–µ.

---

### 4.5. True Action 4 ‚Äî Refresh Region

**Action:** Refresh

* **Selection Type:** Region
* **Region:** —Ç–≤—ñ–π IR –∑ user_tag (–æ–±–µ—Ä–∏ –π–æ–≥–æ –∑—ñ —Å–ø–∏—Å–∫—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `User Tag List`)

---

### 4.6. (–û–ø—Ü—ñ–π–Ω–æ) True Action 5 ‚Äî –ü–æ–∫–∞–∑–∞—Ç–∏ success message

–ú–æ–∂–µ—à –¥–æ–¥–∞—Ç–∏ —â–µ –æ–¥–Ω—É –¥—ñ—é:

* **Action:** Execute JavaScript Code

```js
apex.message.showPageSuccess("–ú—ñ—Ç–∫—É –¥–µ–∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ.");
```

(–∞–±–æ –∑—Ä–æ–±–∏—Ç–∏ —Ü–µ —á–µ—Ä–µ–∑ PL/SQL + `apex_application.g_print_success_message` –≤ –ø—Ä–æ—Ü–µ—Å—ñ ‚Äî –æ–±–∏–¥–≤–∞ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –æ–∫)

---

## 5. –Ø–∫ —Ü–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏–º–µ –¥–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

1. –í IR –≤—ñ–Ω –±–∞—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω–∏—Ö –º—ñ—Ç–æ–∫.
2. –ü—Ä–∞–≤–æ—Ä—É—á/—É –∫–æ–ª–æ–Ω—Ü—ñ ‚Äî —ñ–∫–æ–Ω–∫–∞ ‚Äú—Å–º—ñ—Ç–Ω–∏–∫–∞‚Äù (–∞–±–æ —ñ–Ω—à–∞).
3. –ù–∞—Ç–∏—Å–∫–∞—î ‚Äî –∑‚Äô—è–≤–ª—è—î—Ç—å—Å—è:

> **‚Äú–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –¥–µ–∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ —Ü—é –º—ñ—Ç–∫—É?‚Äù**
> [–¢–∞–∫] [–ù—ñ]

4. –ü—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ **–¢–∞–∫**:

   * –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è `UPDATE user_tag SET date_end = SYSTIMESTAMP WHERE id = ...`;
   * IR –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è;
   * (–æ–ø—Ü—ñ–π–Ω–æ) –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è –∑–µ–ª–µ–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è ‚Äú–ú—ñ—Ç–∫—É –¥–µ–∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ.‚Äù

---

–Ø–∫—â–æ —Ö–æ—á–µ—à, –Ω–∞—Å—Ç—É–ø–Ω–∏–º –∫—Ä–æ–∫–æ–º –º–æ–∂–µ–º–æ:

* –¥–æ–¥–∞—Ç–∏ –ª–æ–≥ (—Ö—Ç–æ –¥–µ–∞–∫—Ç–∏–≤—É–≤–∞–≤, –∫–æ–ª–∏ —ñ –∑ —è–∫–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏),
* –∞–±–æ –∑—Ä–æ–±–∏—Ç–∏ —ñ—Å—Ç–æ—Ä–∏—á–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É/–∑–≤—ñ—Ç –ø–æ **–≤—Å—ñ—Ö** –º—ñ—Ç–∫–∞—Ö (–∞–∫—Ç–∏–≤–Ω—ñ + –∞—Ä—Ö—ñ–≤).
