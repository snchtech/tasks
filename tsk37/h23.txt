‚úÖ –î–ª—è —Ç–æ–≥–æ, —â–æ–± **–∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ—Å—Ç—å –∑–≤‚Äô—è–∑–∫–∏** `USER_ID + POSITION_ID + DEPARTMENT_ID + UNIT_ID` —É —Ç–∞–±–ª–∏—Ü—ñ `TASK_ACCESS_CONTROL`, –¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ **—É–Ω–∏–∫–∞–ª—å–Ω–∏–π —ñ–Ω–¥–µ–∫—Å –∞–±–æ constraint**.

–ù–∞–π–Ω–∞–¥—ñ–π–Ω—ñ—à–µ ‚Äî **constraint (—É–Ω—ñ–∫–∞–ª—å–Ω–µ –æ–±–º–µ–∂–µ–Ω–Ω—è)**, –±–æ Oracle –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª—é—î –π–æ–≥–æ –ø—Ä–∏ –≤—Å—Ç–∞–≤—Ü—ñ/–æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ.

---

## üîπ –í–∞—Ä—ñ–∞–Ω—Ç 1. –ß–µ—Ä–µ–∑ `ALTER TABLE`

(—è–∫—â–æ —Ç–∞–±–ª–∏—Ü—è –≤–∂–µ —ñ—Å–Ω—É—î)

```sql
ALTER TABLE TASK_ACCESS_CONTROL
ADD CONSTRAINT task_acc_ctrl_uq UNIQUE (USER_ID, POSITION_ID, DEPARTMENT_ID, UNIT_ID);
```

‚úÖ Oracle —Å—Ç–≤–æ—Ä–∏—Ç—å –ø—ñ–¥ —Ü–∏–º constraint –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–Ω–¥–µ–∫—Å.

---

## üîπ –í–∞—Ä—ñ–∞–Ω—Ç 2. –Ø–∫—â–æ –ø–æ–ª—è –º–æ–∂—É—Ç—å –±—É—Ç–∏ `NULL`

> –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º Oracle –¥–æ–∑–≤–æ–ª—è—î –∫—ñ–ª—å–∫–∞ —Ä—è–¥–∫—ñ–≤ –∑ NULL —É —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –ø–æ–ª—è—Ö.
> –Ø–∫—â–æ —Ç–∏ —Ö–æ—á–µ—à, —â–æ–± **–Ω–∞–≤—ñ—Ç—å –ø—Ä–∏ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ NULL** –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—è –≤–≤–∞–∂–∞–ª–∞—Å—è —É–Ω—ñ–∫–∞–ª—å–Ω–æ—é ‚Äî —Ç—Ä–µ–±–∞ –∑—Ä–æ–±–∏—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π —ñ–Ω–¥–µ–∫—Å.

```sql
CREATE UNIQUE INDEX task_acc_ctrl_uq_idx ON TASK_ACCESS_CONTROL (
  NVL(USER_ID, -1),
  NVL(POSITION_ID, -1),
  NVL(DEPARTMENT_ID, -1),
  NVL(UNIT_ID, -1)
);
```

> –¢–∞–∫–∏–π —ñ–Ω–¥–µ–∫—Å –≤–≤–∞–∂–∞—Ç–∏–º–µ `NULL` —è–∫ `-1`, —Ç–æ–º—É –¥—É–±–ª—å –Ω–∞–≤—ñ—Ç—å —ñ–∑ NULL –±—É–¥–µ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ.

---

## üîπ –í–∞—Ä—ñ–∞–Ω—Ç 3. –î–æ–¥–∞—Ç–∏ constraint –ø—ñ–¥ —á–∞—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ

(–¥–ª—è –ø–æ–≤–Ω–æ—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥—É)

```sql
CREATE TABLE TASK_ACCESS_CONTROL (
  ID               NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  USER_ID          NUMBER NOT NULL,
  POSITION_ID      NUMBER,
  DEPARTMENT_ID    NUMBER,
  UNIT_ID          NUMBER,
  ACCESS_LEVEL_ID  NUMBER,
  DATE_CREATE      DATE DEFAULT SYSDATE,
  CREATED_BY       VARCHAR2(100),
  NOTE             VARCHAR2(4000),
  UCHASTOK         NUMBER,
  CONSTRAINT task_acc_ctrl_uq UNIQUE (USER_ID, POSITION_ID, DEPARTMENT_ID, UNIT_ID)
);
```

---

## üîπ (–û–ø—Ü—ñ–π–Ω–æ) –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø–æ—Ç–æ—á–Ω—ñ –¥—É–±–ª—ñ–∫–∞—Ç–∏

–ü–µ—Ä–µ–¥ —Ç–∏–º —è–∫ –¥–æ–¥–∞—Ç–∏ constraint, –≤–∞—Ä—Ç–æ –≤–ø–µ–≤–Ω–∏—Ç–∏—Å—å, —â–æ –≤ —Ç–∞–±–ª–∏—Ü—ñ –Ω–µ–º–∞—î –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤:

```sql
SELECT USER_ID, POSITION_ID, DEPARTMENT_ID, UNIT_ID, COUNT(*)
FROM TASK_ACCESS_CONTROL
GROUP BY USER_ID, POSITION_ID, DEPARTMENT_ID, UNIT_ID
HAVING COUNT(*) > 1;
```

–Ø–∫—â–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –ø–æ—Ä–æ–∂–Ω—ñ–π ‚Äî —Å–ø–æ—á–∞—Ç–∫—É –≤–∏–¥–∞–ª–∏/–≤–∏–ø—Ä–∞–≤ —Ü—ñ –¥—É–±–ª—ñ–∫–∞—Ç–∏.

---

–•–æ—á–µ—à, —è –ø–æ–∫–∞–∂—É —è–∫ –∑—Ä–æ–±–∏—Ç–∏, —â–æ–± Oracle **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —ñ–≥–Ω–æ—Ä—É–≤–∞–≤ –¥—É–±–ª—ñ–∫–∞—Ç–∏ –ø—Ä–∏ –≤—Å—Ç–∞–≤—Ü—ñ** (—á–µ—Ä–µ–∑ `MERGE` –∞–±–æ `IGNORE_ROW_ON_DUPKEY_INDEX`)?
