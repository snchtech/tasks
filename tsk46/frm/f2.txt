–¢–∞–∫, —è —Ä–æ–∑–≥–ª—è–Ω—É–≤ —É–≤–µ—Å—å –∫–æ–¥ —ñ–∑ —Ç–≤–æ—ó—Ö —Ñ–æ—Ç–æ ‚Äî —ñ **—Ç–∞–∫**, —Ü–µ–π SQL-–∑–∞–ø–∏—Ç –ø–æ–±—É–¥–æ–≤–∞–Ω–∏–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è —Ç–æ–≥–æ, —â–æ–±:

‚úÖ **–∑–±–∏—Ä–∞—Ç–∏ –∑–∞–ø–∏—Å–∏ –≤—ñ–¥ –∫—ñ–ª—å–∫–æ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤** (—á–µ—Ä–µ–∑ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å —Ñ—ñ–ª—å—Ç—Ä–∞ `creator` —É –≥–æ–ª–æ–≤–Ω—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ),
‚úÖ **–≥—Ä—É–ø—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –ø–æ —Ç–∏–ø–∞—Ö –∫–æ–º–ø–∞–Ω—ñ–π (`company_type`)**,
‚úÖ **–≤–∏–≤–æ–¥–∏—Ç–∏ –≤—ñ—Ä–Ω—É —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—É —ñ—î—Ä–∞—Ä—Ö—ñ—é —É –∑–≤—ñ—Ç—ñ**, –¥–µ:

1. —Å–ø–æ—á–∞—Ç–∫—É –π–¥—É—Ç—å **–∑–∞–≥–æ–ª–æ–≤–∫–∏-—Ä–æ–∑–¥—ñ–ª—å–Ω–∏–∫–∏** (`headers`) ‚Äî –∫–æ–∂–µ–Ω —Ç–∏–ø –∫–æ–º–ø–∞–Ω—ñ—ó –∑ –Ω–∞–∑–≤–æ—é (`ct.name`),
2. –ø–æ—Ç—ñ–º ‚Äî **—Ä—è–¥–∫–∏ –∑ –¥–∞–Ω–∏–º–∏ (`base_data`)**: –∫–æ–º–ø–∞–Ω—ñ—è, –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ª—é–¥–µ–π, –∞–≤—Ç–æ—Ä, –¥–∞—Ç–∞, —é–Ω—ñ—Ç —Ç–æ—â–æ,
3. –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ—ó –≥—Ä—É–ø–∏ ‚Äî **–ø—ñ–¥—Å—É–º–∫–æ–≤–∏–π —Ä—è–¥–æ–∫ (`totals`)**, —è–∫–∏–π —Ä–∞—Ö—É—î —Å—É–º—É `people_count` –ø–æ —Ü—å–æ–º—É —Ç–∏–ø—É –∫–æ–º–ø–∞–Ω—ñ—ó.

---

### üîπ –©–æ –≤ –∫–æ–¥—ñ –∑–∞–±–µ–∑–ø–µ—á—É—î –ø—Ä–∞–≤–∏–ª—å–Ω—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É

* `headers` ‚Üí —Å—Ç–≤–æ—Ä—é—î —Ä–æ–∑–¥—ñ–ª—å–Ω—ñ —Ä—è–¥–∫–∏ –¥–ª—è `company_type`, —è–∫—ñ –ø–æ—Ç—ñ–º –æ–±‚Äô—î–¥–Ω—É—é—Ç—å—Å—è —á–µ—Ä–µ–∑ `UNION ALL`;
* `base_data` ‚Üí —Ç—è–≥–Ω–µ –≤—Å—ñ —Ä–µ–∞–ª—å–Ω—ñ –∑–∞–ø–∏—Å–∏ –∑ `external_personal`, –≤–∫–ª—é—á–Ω–æ –∑ –∫—ñ–ª—å–∫–æ–º–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ –æ–¥–Ω–æ–≥–æ —Ü–µ—Ö—É;
* `totals` ‚Üí —Ä–æ–±–∏—Ç—å –ø—ñ–¥—Å—É–º–∫–æ–≤–µ `SUM(people_count)` –ø–æ `company_type_id`;
* `ORDER BY company_type_id, is_header DESC, is_total, company_name` ‚Üí —Ñ–æ—Ä–º—É—î –≤—ñ—Ä–Ω—É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å:
  **–∑–∞–≥–æ–ª–æ–≤–æ–∫ ‚Üí –∑–∞–ø–∏—Å–∏ ‚Üí –ø—ñ–¥—Å—É–º–æ–∫**.

---

### üîπ –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ —É –∑–≤—ñ—Ç—ñ —Ç–∏ –æ—Ç—Ä–∏–º–∞—î—à:

```
–¢–∏–ø –∫–æ–º–ø–∞–Ω—ñ—ó: –ü—Ä–æ–º–∏—Å–ª–æ–≤—ñ
---------------------------------------------------
Company A      10   –Ü–≤–∞–Ω–µ–Ω–∫–æ –Ü.–Ü.   Unit 1
Company B       7   –ü–µ—Ç—Ä–µ–Ω–∫–æ –û.–û.   Unit 2
–í—Å—å–æ–≥–æ –ø–æ —Ç–∏–ø—É:       17

–¢–∏–ø –∫–æ–º–ø–∞–Ω—ñ—ó: –ë—É–¥—ñ–≤–µ–ª—å–Ω—ñ
---------------------------------------------------
Company C      12   –®–µ–≤—á–µ–Ω–∫–æ –í.–í.   Unit 1
Company D       4   –ë–æ–Ω–¥–∞—Ä –ú.–ú.     Unit 3
–í—Å—å–æ–≥–æ –ø–æ —Ç–∏–ø—É:       16
```

üü© –Ü —Ç–∞–∫ ‚Äî **—Ä—ñ–∑–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ** –º–æ–∂—É—Ç—å –¥–æ–¥–∞–≤–∞—Ç–∏ —Å–≤–æ—ó –∑–∞–ø–∏—Å–∏, –≤–æ–Ω–∏ –≤—Å—ñ –ø–æ—Ç—Ä–∞–ø–ª—è—Ç—å —É —Ü—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –æ—Å–∫—ñ–ª—å–∫–∏ –≤ –∑–∞–ø–∏—Ç—ñ **–Ω–µ–º–∞ —Ñ—ñ–ª—å—Ç—Ä–∞ –Ω–∞ `creator`**.

---

### üîß –Ñ–¥–∏–Ω–µ, —â–æ –º–æ–∂–µ—à —É–¥–æ—Å–∫–æ–Ω–∞–ª–∏—Ç–∏:

—â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –¥—É–±–ª—é–≤–∞–Ω–Ω—è –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω—ñ, –≤ –ø—ñ–¥–∑–∞–ø–∏—Ç–∞—Ö `totals` —ñ `headers` –∫—Ä–∞—â–µ –¥–æ–¥–∞—Ç–∏ `DISTINCT c.company_type_id`,
–∞–ª–µ –ª–æ–≥—ñ—á–Ω–æ –∑–∞–ø–∏—Ç —É–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –¥–ª—è –±–∞–≥–∞—Ç–æ–∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–æ–≥–æ —Ä–µ–∂–∏–º—É.

---

–û—Ç–∂–µ, ‚úÖ —Ç–≤—ñ–π IR-–∑–≤—ñ—Ç:

* –ø—Ä–∞—Ü—é—î **–ø–æ –≤—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞—Ö**,
* –≥—Ä—É–ø—É—î –∑–∞–ø–∏—Å–∏ **–ø–æ —Ç–∏–ø—É –∫–æ–º–ø–∞–Ω—ñ—ó**,
* –ø–æ–∫–∞–∑—É—î **–∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞ –ø—ñ–¥—Å—É–º–∫–æ–≤—ñ —Ä—è–¥–∫–∏** —É –≤—ñ—Ä–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É.

–•–æ—á–µ—à, —è –ø–æ–∫–∞–∂—É, —è–∫ –∑—Ä–æ–±–∏—Ç–∏ CSS-–≤–∏–¥—ñ–ª–µ–Ω–Ω—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–µ–ª–µ–Ω–∏–π —Ñ–æ–Ω –¥–ª—è —Ä—è–¥–∫–∞ ‚Äú–í—Å—å–æ–≥–æ‚Äù) —ñ –∂–∏—Ä–Ω–∏–π —Å—Ç–∏–ª—å –¥–ª—è `headers` –ø—Ä—è–º–æ –≤ IR?
